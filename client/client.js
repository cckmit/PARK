/*
 * client.js - v0.3.0
 * Compiled Tue Oct 30 2018 15:18:25 GMT+0800 (中国标准时间)
 * Copyright (c) 2018 www.hightopo.com
 */

!function(S,P){"object"==typeof exports&&"undefined"!=typeof module?module.exports=P():"function"==typeof define&&define.amd?define(P):S.hteditor=P()}(this,function(){"use strict";function S(S,P,E){E.style.cursor="ew-resize";var p=E.innerHTML.charAt(0),l=P.querySelector("input.color_"+p),_=function(P){P.preventDefault();var E=("A"===p?parseFloat(l.value):parseInt(l.value))||0,_=ht.Default.getClientPoint(P).x,m=function(P){P.preventDefault();var m=ht.Default.getClientPoint(P).x-_,u=void 0;"A"===p?(u=E+.01*m,u>1&&(u=1),u<0&&(u=0),l.value=u.toFixed(2)):(u=E+1*m,u>255&&(u=255),u<0&&(u=0),l.value=u),S.updateInputChange()};window.addEventListener("mousemove",m,!1),window.addEventListener("touchmove",m,!1);var u=function(S){S.preventDefault(),window.removeEventListener("mousemove",m,!1),window.removeEventListener("touchmove",m,!1),window.removeEventListener("mouseup",u,!1),window.removeEventListener("touchend",u,!1)};window.addEventListener("mouseup",u,!1),window.addEventListener("touchend",u,!1)};E.addEventListener("mousedown",_,!1),E.addEventListener("touchstart",_,!1)}function P(S){var P=new RegExp("(^|&)"+S+"=([^&]*)(&|$)"),E=window.location.search.substr(1).match(P);return null!=E?decodeURIComponent(E[2]):null}function E(S){return ht.Default.clone(S)}function p(S){return parseFloat(S.toFixed(ht.Default.numberDigits))}function l(S,P){if(null!=S)return P||!rP.config.traceMissingI18n||rP.customStrings[S]||rP.strings[S]||console.log("i18n missing:["+S+"]"),P?rP.customStrings[S]||rP.strings[S]:rP.customStrings[S]||rP.strings[S]||S}function _(S,P){var E=S.indexOf(P);E>=0&&S.splice(E,1)}function m(S){return ht.Default.isEmptyObject(S)}function u(S){return S?fS(S)?S:S.__ht__||S.toString():""}function F(S){var P=u(S),E=P.indexOf("{")+1,p=P.lastIndexOf("}");for(P=P.substring(E,p);P.startsWith("\n");)P=P.substr(1);for(;P.endsWith("\n");)P=P.substring(0,P.length-1);return P}function f(S){var P=S.indexOf("function");if(S&&!(P<0)){var E=void 0,p=S.indexOf("{")+1,l=S.lastIndexOf("}"),_=S.indexOf("(")+1,m=S.indexOf(")");return p&&l&&_&&m&&(E=new Function(S.substring(_,m),S.substring(p,l)),E.__ht__=S.substr(P)),E}}function H(S,P){if("s"===S)return function(S){return S.s(P)};if("a"===S)return function(S){return S.a(P)};if("p"===S){var E=ht.Default.getter(P);return function(S){if(S[E])return S[E]()}}}function T(S,P){if("s"===S)return function(S,E){return S.s(P,E)};if("a"===S)return function(S,E){return S.a(P,E)};if("p"===S){var E=ht.Default.setter(P);return function(S,P){if(S[E])return S[E](P)}}}function X(S){return 37===S.keyCode}function W(S){return 38===S.keyCode}function h(S){return 39===S.keyCode}function Q(S){return 40===S.keyCode}function i(S){return 13===S.keyCode}function a(S){return 27===S.keyCode}function s(S){return ht.Default.isDelete(S)}function k(S){return ht.Default.isLeftButton(S)}function Y(S){return ht.Default.isDoubleClick(S)}function x(S,P){ht.Default.startDragging(S,P)}function M(S){return ht.Default.getClientPoint(S)}function b(S){return ht.Default.getTargetElement(S)}function j(S){return ht.Default.getPagePoint(S)}function z(){return ht.Default.getWindowInfo()}function c(S,P){return ht.Default.getDistance(S,P)}function V(){return ht.Default.unionPoint.apply(this,arguments)}function g(S){return ht.Default.getImageMap()[S]?(delete ht.Default.getImageMap()[S],!0):!!ht.Default.getCompTypeMap()[S]&&(delete ht.Default.getCompTypeMap()[S],!0)}function R(S,P,E){return ht.Default.getPosition(S,P,E)}function G(S,P){return ht.Default.stringify(S,P)}function J(S){return ht.Default.parse(S)}function v(S){if(!S)return"";var P=S.lastIndexOf(".");return-1===P?S:S.substr(0,P)}function B(S){return S=S.replace(/^.*[\\\/]/,""),v(S)}function K(S,P,E,p,l){ht.Default.layout(S,P,E,p,l)}function L(S,P,E,p){ht.Default.setCanvas(S,P,E,p)}function e(S){ht.Default.removeHTML(S)}function r(S,P,E){ht.Default.xhrLoad(S,P,E)}function q(S){return ht.Default.isShiftDown(S)}function O(S){return ht.Default.isCtrlDown(S)}function d(S,P){return ht.Default.createView(S,P)}function A(S){return ht.Default.createCanvas(S)}function N(S,P){return ht.Default.createDiv(P,S)}function Z(S,P){return ht.Default.unionRect(S,P)}function C(S,P,E,p,l,_,m,u,F,f){return ht.Default.drawText(S,P,E,p,l,_,m,u,F,f)}function o(S,P,E,p,l,_,m,u,F,f){ht.Default.drawStretchImage(S,P,E,p,l,_,m,u,F,f)}function D(S,P,E,p,l,_,m){ht.Default.drawBorder(S,P,E,p,l,_,m)}function y(S,P,E,p,l,_){var m=S.getContext("2d");return m.save(),P=P||0,E=E||0,p=p||1,_=_||ht.Default.devicePixelRatio,m.translate(P*_,E*_),p*=_,1!==p&&m.scale(p,p),l&&(m.beginPath(),m.rect(l.x,l.y,l.width,l.height),m.clip(),m.clearRect(l.x,l.y,l.width,l.height)),m}function I(S,P){var E=S.prototype,p=ht.Default.getMSMap();for(var l in P)p[l]&&p.hasOwnProperty(l)?p[l](E,P):E[l]=P[l]}function n(S,P){P[S._id]=S,S.eachChild(function(S){P[S._id]=S,n(S,P)})}function U(S){ht.Default.preventDefault(S)}function t(S){return/^displays/.test(S)}function w(S){return/^symbols/.test(S)}function SS(S){return/^assets/.test(S)}function PS(S){return/^components/.test(S)}function ES(S){return/\.(png|jpg|gif|jpeg|bmp|svg|dxf|mp4|mp3)$/i.test(S)}function pS(S){return/\.json$/i.test(S)}function lS(S){return/\.mp3$/i.test(S)}function _S(S){return/\.mp4$/i.test(S)}function mS(S){return/\.svg$/i.test(S)}function uS(S){return/\.dxf$/i.test(S)}function FS(S){return S.substring(0,S.length-5)+".png"}function fS(S){return"string"==typeof S||S instanceof String}function HS(S){return S&&"object"==typeof S}function TS(S){return"function"==typeof S}function XS(S){return S instanceof Array}function WS(S,P){var E=S.getPosition().x,p=S.getPosition().y,l=S.getWidth(),_=S.getHeight(),m=[E-l*S.getAnchor().x,p-_*S.getAnchor().y,l,_];xS(P,"rect",S.a("rect"),m,void 0)}function hS(S,P){var E=S.getRotation();xS(P,"rotation",S.a("rotation"),E,0)}function QS(S,P){var E=S.getAnchor().x,p=S.a("anchorX");xS(P,"anchorX",p,E,.5),E=S.getAnchor().y,p=S.a("anchorY"),xS(P,"anchorY",p,E,.5)}function iS(S,P){var E=S.getScale().x,p=S.a("scaleX");xS(P,"scaleX",p,E,1),E=S.getScale().y,p=S.a("scaleY"),xS(P,"scaleY",p,E,1)}function aS(S,P){var E=S.isClosePath();xS(P,"closePath",S.a("closePath"),E,!1)}function sS(S,P,p,l,_){4===arguments.length&&(_=ht.Style[p]);var m=E(S.s(p));xS(P,l,S.a(p),m,_)}function kS(S,P){var E=S.getDisplayName();xS(P,"displayName",S.a("displayName"),E,void 0)}function YS(S,P){if(XS(S)&&XS(P)){if(S.length===P.length){for(var E=0;E<S.length;E++)if(!YS(S[E],P[E]))return!1;return!0}return!1}if(HS(S)&&HS(P)){var p=Object.keys(S);if(p.length===Object.keys(P).length){for(var l=0;l<p.length;l++){var _=p[l];if(!YS(S[_],P[_]))return!1}return!0}return!1}return S===P}function xS(S,P,E,p,l){E?S[P]={func:E,value:p}:YS(p,l)||void 0===p||(S[P]=p)}function MS(S,P,E,p){jS(S,"2d.visible",P.visible),jS(S,"2d.selectable",P.selectable),jS(S,"2d.movable",P.movable),jS(S,"2d.editable",P.editable),jS(S,"comp.pixelPerfect",P.pixelPerfect,!1),jS(S,"opacity",P.opacity,1),jS(S,"clip.percentage",P.clipPercentage,1),jS(S,"clip.direction",P.clipDirection,"top"),S instanceof ht.Text||(jS(S,"shadow",P.shadow,!1),jS(S,"select.color",P.shadowColor,ht.Color.highlight),jS(S,"shadow.blur",P.shadowBlur,6),jS(S,"shadow.offset.x",P.shadowOffsetX,3),jS(S,"shadow.offset.y",P.shadowOffsetY,3)),zS(S,P),VS(S,P),gS(S,P),cS(S,P),S instanceof ht.Shape&&!P.rect||GS(S,P,E,p);var l=jP.customProperties.comp;l&&l.length&&l.forEach(function(E){jS(S,E.property,P[E.property],E.defaultValue)}),qP.forEach(function(E){S.a(E,P[E])}),S.a("renderHTML",P.renderHTML)}function bS(S,P){sS(S,P,"2d.visible","visible"),sS(S,P,"2d.selectable","selectable"),sS(S,P,"2d.movable","movable"),sS(S,P,"2d.editable","editable"),sS(S,P,"comp.pixelPerfect","pixelPerfect",!1),sS(S,P,"opacity","opacity",1),sS(S,P,"clip.percentage","clipPercentage",1),sS(S,P,"clip.direction","clipDirection","top"),S instanceof ht.Text||(sS(S,P,"shadow","shadow",!1),sS(S,P,"select.color","shadowColor",ht.Color.highlight),sS(S,P,"shadow.blur","shadowBlur",6),sS(S,P,"shadow.offset.x","shadowOffsetX",3),sS(S,P,"shadow.offset.y","shadowOffsetY",3)),kS(S,P),QS(S,P),iS(S,P),hS(S,P),S instanceof ht.Shape&&!S.a("rect")||WS(S,P);var E=jP.customProperties.comp;E&&E.length&&E.forEach(function(E){sS(S,P,E.property,E.property,E.defaultValue)}),qP.forEach(function(E){S.a(E)&&(P[E]=S.a(E))}),S.a("renderHTML")&&(P.renderHTML=S.a("renderHTML"))}function jS(S,P,p,l){3===arguments.length&&(l=ht.Style[P]);var _=JS(p);void 0===_&&(_=l),S.s(P,E(_)),S.a(P,$S(p))}function zS(S,P){S.setDisplayName(JS(P.displayName),void 0),S.a("displayName",$S(P.displayName))}function cS(S,P){S.setRotation(JS(P.rotation,0)),S.a("rotation",$S(P.rotation))}function VS(S,P){var E=JS(P.anchorX,.5),p=JS(P.anchorY,.5);.5===E&&.5===p||S.setAnchor(E,p),S.a("anchorX",$S(P.anchorX)),S.a("anchorY",$S(P.anchorY))}function gS(S,P){var E=JS(P.scaleX,1),p=JS(P.scaleY,1);S.setScale(E,p),S.a("scaleX",$S(P.scaleX)),S.a("scaleY",$S(P.scaleY))}function RS(S,P){S.setClosePath(JS(P.closePath,!1)),S.a("closePath",$S(P.closePath))}function GS(S,P,E,p){var l=JS(P.rect),_=JS(P.relative);l||(l=[0,0,E,p],_=!1);var m=l.length;if(4===m)l={x:l[0],y:l[1],width:l[2],height:l[3]},_&&(l.x*=E,l.y*=p,l.width*=E,l.height*=p);else if(3===m){var u=l[0];l={width:l[1],height:l[2]},_&&(l.width*=E,l.height*=p),"object"==typeof u?u.length&&(u={x:u[0],y:u[1]}):u=R(u,{x:0,y:0,width:E,height:p},l),l.x=u.x-l.width*S.getAnchor().x,l.y=u.y-l.height*S.getAnchor().y}var F=JS(P.offsetX);F&&(l.x+=F),F=JS(P.offsetY),F&&(l.y+=F),l.width<0||l.height<0?S.p(l.x,l.y):S.setRect(l),S.a("rect",$S(P.rect))}function JS(S,P){var E=void 0;return E=HS(S)&&S.func?S.value:S,void 0===E&&(E=P),E}function $S(S){if(HS(S)&&S.func)return S.func}function vS(S){if(XS(S)){for(var P=new ht.List,E=S.length,p=0;p<E;p+=2)P.add({x:S[p],y:S[p+1]});S=P}return S}function BS(S){if(S instanceof ht.List&&(S=S.toArray()),XS(S)){for(var P=[],E=0;E<S.length;E++){var p=S[E];P.push(p.x,p.y)}S=P}return S}function KS(S){return{width:16,height:16,comps:[{type:function(P,E,p,l,_){var m=ht.Default.getImage(S.graphView.getImage(l));if(m&&m.snapshotURL)(m=ht.Default.getImage(m.snapshotURL))&&o(P,m,"uniform",E.x,E.y,E.width,E.height,l,_);else{var u=m&&m.boundExtend?l.getRect():S.graphView.getDataUIBounds(l);if(u&&u.width&&u.height){P.save();var F=Math.min(1,16/Math.max(u.width,u.height));P.translate(-u.x*F+(16-u.width*F)/2,-u.y*F+(16-u.height*F)/2),P.scale(F,F),S.graphView.drawData(P,l),P.restore()}}}}]}}function LS(S,P){var E=S.graphView.getEdgeInfo(P);if(!E)return PE;var p=E.edgeTypeInfo,l=void 0,_=void 0;if(!E.type||E.points){E.sourcePoint.x,E.sourcePoint.y,E.targetPoint.x,E.targetPoint.y;E.type?(l=new ht.List(E.sourcePoint),l.addAll(E.points),l.add(E.targetPoint),_=E.segments):E.looped?(l=pE,_=lE):l=E.center?[E.c1,E.sourcePoint,E.targetPoint,E.c2]:[E.sourcePoint,E.targetPoint]}else p&&(l=p.points,_=p.segments);var m=V(l);if(m&&(m.width||m.height)){var u=Math.max(1,Math.max(m.width,m.height)/16),F=[],f=(16-m.width/u)/2,H=(16-m.height/u)/2;l instanceof ht.List&&(l=l.toArray()),l.forEach(function(S){F.push((S.x-m.x)/u+f,(S.y-m.y)/u+H)});var T=_?_.toArray():null;return{width:16,height:16,comps:[{type:"shape",points:F,segments:T,borderWidth:1,borderColor:E.color,borderCap:E.cap,borderJoin:E.join}]}}return PE}function eS(S){var P=V(S.getPoints());if(P&&(P.width||P.height)){var E=Math.max(1,Math.max(P.width,P.height)/16),p=[],l=(16-P.width/E)/2,_=(16-P.height/E)/2;S.getPoints().each(function(S){p.push((S.x-P.x)/E+l,(S.y-P.y)/E+_)});var m=S.getSegments()?S.getSegments().toArray():null;return{width:16,height:16,comps:[{type:"shape",points:p,segments:m,rotation:S.getRotation(),background:S.s("shape.background"),repeatImage:S.s("shape.repeat.image"),borderWidth:S.s("shape.border.width")?1:0,borderColor:S.s("shape.border.color"),borderCap:S.s("shape.border.cap"),borderJoin:S.s("shape.border.join"),gradient:S.s("shape.gradient"),gradientColor:S.s("shape.gradient.color"),closePath:S.isClosePath()}]}}return PE}function rS(S){return ht.Default.isInput(S)}function qS(S,P){var E=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},p=E.nullable,_=void 0===p||p,m=E.trim,u=void 0!==m&&m,F=E.cancellable,f=void 0===F||F,H=E.width,T=void 0===H?300:H,X=E.height,W=void 0===X?120:X,h=E.maxLength,Q=void 0===h?-1:h,i=arguments[3],a=new eP;a.addRow([{id:"input",textField:{text:P}}],[.1]);var s=new LP,k=[],Y=null,x=null;Y=function(){var S=a.v("input");return u&&S&&S.trim(),!1!==_||S?Q>0&&S&&S.length>Q?void OS(null,l("editor.inputmax"),function(){}):(i(S,"ok"),void s.hide()):void OS(null,l("editor.inputempty"),function(){})},k.push({label:l("editor.ok"),action:Y}),f&&(x=function(){i(P,"cancel"),s.hide()},k.push({label:l("editor.cancel"),action:x})),s.setConfig({title:S,draggable:!0,width:T,height:W,contentPadding:10,content:a,buttons:k,buttonsAlign:"right"}),s.$49$=x,s.$48$=Y,s.show(),a.getViewById("input").getElement()._ignore=!0,a.getViewById("input").setFocus()}function OS(S,P,E,p){var _=arguments.length>4&&void 0!==arguments[4]?arguments[4]:300,m=[],u=void 0,F=void 0;E&&(u=function(){f.hide(),E()},m.push({label:l("editor.ok"),action:u})),p&&(F=function(){f.hide(),p()},m.push({label:l("editor.cancel"),action:F}));var f=new LP({title:S||l("editor.prompt"),contentPadding:20,width:_,draggable:!0,content:"<p>"+P+"</p>",buttons:m});f.$49$=F||u,f.$48$=u,f.show()}function dS(S,P,E,p){var l={unfocusable:!0,id:S,toolTip:P},_=ht.Default.getImage(E),m=_?_.width:16,u=_?_.height:16;return l.icon={width:m+8,height:u+8,fitSize:!!_&&_.fitSize,comps:[{type:"rect",background:{func:function(S,P){return P.getCurrentItem()===l?rP.config.color_hover:null}},rect:[0,0,m+8,u+8]},{type:"image",name:E,color:{func:function(S,P){return p&&p()?rP.config.color_select:rP.config.color_dark}},rect:[4,4,m,u]}]},l}function AS(S,P){var E=ht.Default.createDiv(!0);return E.style.font=ht.Default.labelFont,E.style.color=ht.Default.labelColor,E.style.paddingLeft="4px",E.style.lineHeight=ht.Default.widgetRowHeight+"px",E.style.whiteSpace="nowrap",E.innerHTML=S,P&&(E.style.textAlign=P),E}function NS(S,P,E,p){var l=new ht.widget.Button;return l.setLabel(S),l.setLabelColor(ht.Default.labelColor),l.setLabelSelectColor(rP.config.color_select),l.setIcon(E),l.setBackground(null),l.setBorderColor(null),p&&(l.onClicked=p),P&&(l.setToolTip(P),l.enableToolTip()),l.getCurrentBackground=function(){return this._hover||this.isPressed()?rP.config.color_hover:null},l.getCurrentBorderColor=function(){return this.isSelected()?rP.config.color_select:null},l.getView().addEventListener("mouseenter",function(){l.isDisabled()||(l._hover=!0,l.iv())},!1),l.getView().addEventListener("mouseleave",function(){l.isDisabled()||(l._hover=!1,l.iv())},!1),l}function ZS(S,P){var E=ht.Default.getImage(S);if(!E)throw S;var p={width:E.width,height:E.height,fitSize:E.fitSize,comps:[{type:"image",name:S,color:{func:function(){return P&&P()?rP.config.color_select:rP.config.color_dark}}}]},l=S+".state";return ht.Default.setImage(l,p),l}function CS(S,P,E){var p=new FileReader;p.onloadend=function(S){P(S.target.result)},E?p.readAsDataURL(S):p.readAsText(S)}function oS(S,P){if(P){P===document.body&&(document.title=l("editor.title"),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"),P.appendChild(S.getView());var E=S.getView().style;E.left="0px",E.top="0px",setInterval(function(){if(S.getView()!==(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){var p=void 0,l=void 0;P===document.body?(p=document.documentElement.clientWidth,window.innerWidth&&window.innerWidth<p&&(p=window.innerWidth),l=document.documentElement.clientHeight,window.innerHeight&&window.innerHeight<l&&(l=window.innerHeight)):(p=P.clientWidth,l=P.clientHeight),p===S._oldWidth&&l===S._oldHeight||(S._oldWidth=p,S._oldHeight=l,E.width=p+"px",E.height=l+"px",S.iv())}},500)}}function DS(S){if(S)for(var P=0;P<S.length;P++)null==S[P]&&(S[P]=0)}function yS(S){if(S)for(var P=ht.Color.chart,E=0;E<S.length;E++)null==S[E]&&(S[E]=P[E%P.length])}function IS(S,P){P=void 0===P?S?S.length:0:P;for(var E=new Array(P),p=0;p<P;p++)E[p]=S?S[p]:void 0;return E}function nS(S){if(S instanceof ht.graph.GraphView){var P=S.getContentRect(),E=Math.max(P.width,P.height),p=Math.min(1,rP.config.imageSize/E);return E<3&&(p=rP.config.imageSize/E),S.toDataURL(void 0,void 0,p)}var l=ht.Default.getImage(S),_=Math.max(l.width,l.height),m=Math.min(1,rP.config.imageSize/_);return ht.Default.toCanvas(S,l.width*m,l.height*m).toDataURL("image/png",1)}function US(S,P,E){if(S instanceof Array)for(var p=0,l=S.length;p<l;p++)US(S[p],P,E);else if(S instanceof Object)for(var _ in S)if(S.hasOwnProperty(_)){var m=S[_];if(!HS(m))continue;if(fS(m.func)&&tP.test(m.func)){var u=m.func.slice(5);P&&void 0===P[u]&&(P[u]=_),E&&void 0===E[u]&&(E[u]=m.value)}else US(m,P,E)}}function tS(S){var P={clazz:this.getClass(),name:this.getName(),displayName:this.getDisplayName(),toolTip:this.getToolTip(),tag:this.getTag(),icon:this.getIcon(),layer:this.getLayer(),parent:S.$58$(this.getParent()),a:{},s:{},dataBindings:this.getDataBindings()?G(this.getDataBindings()):null},p=this.getStyleMap();for(var l in p)P.s[l]=E(this.s(l));var _=this.getAttrObject();for(var m in _)P.a[m]=E(this.a(m));return P}function wS(S,P){var p=new S.clazz;if(rP.config.cloneName&&p.setName(S.name),rP.config.cloneDisplayName&&p.setDisplayName(S.displayName),rP.config.cloneToolTip&&p.setToolTip(S.toolTip),rP.config.cloneTag&&p.setTag(S.tag),rP.config.cloneIcon&&p.setIcon(S.icon),rP.config.cloneLayer&&p.setLayer(S.layer),rP.config.cloneStyle)for(var l in S.s)p.s(l,E(S.s[l]));if(rP.config.cloneAttr)for(var _ in S.a)p.a(_,E(S.a[_]));return rP.config.cloneDataBindings&&S.dataBindings&&p.setDataBindings(J(S.dataBindings)),p}function SP(S,P,E){var p=rP.config.cloneParent?P.$50$(S.parent,E):void 0;this.setParent(p||P.getCurrentSubGraph())}function PP(S){var P=tS.call(this,S);return P.rotation=this.getRotation(),P.position=this.p(),P.size={width:this._width,height:this._height},P.scale=this.getScale(),P.anchor=this.getAnchor(),P.image=this.getImage(),P.host=S.$58$(this.getHost()),P}function EP(S,P){var E=wS(S,P);return rP.config.cloneRotation&&E.setRotation(S.rotation),rP.config.clonePosition&&E.setPosition(S.position),rP.config.cloneSize&&E.setSize(S.size),rP.config.cloneScale&&E.setScale(S.scale),.5===S.anchor.x&&.5===S.anchor.y||rP.config.cloneAnchor&&E.setAnchor(S.anchor),rP.config.cloneImage&&E.setImage(S.image),E}function pP(S,P,E){SP.call(this,S,P,E),rP.config.cloneHost&&this.setHost(P.$50$(S.host,E))}function lP(S){var P=tS.call(this,S);return P.source=S.$58$(this.getSource()),P.target=S.$58$(this.getTarget()),P}function _P(S,P){return wS(S,P)}function mP(S,P,E){SP.call(this,S,P,E),rP.config.cloneSource&&this.setSource(P.$50$(S.source,E)),rP.config.cloneTarget&&this.setTarget(P.$50$(S.target,E))}function uP(S){var P=PP.call(this,S);return P.expanded=this.isExpanded(),P}function FP(S,P){var E=EP(S,P);return rP.config.cloneExpanded&&E.setExpanded(S.expanded),E}function fP(S){var P=PP.call(this,S);return P.points=E(this.getPoints()),P.segments=E(this.getSegments()),P.thickness=this.getThickness(),P.closePath=this.isClosePath(),P}function HP(S,P){var p=EP(S,P);return rP.config.clonePoints&&p.setPoints(E(S.points)),rP.config.cloneSegments&&p.setSegments(E(S.segments)),rP.config.cloneThickness&&p.setThickness(S.thickness),rP.config.cloneClosePath&&p.setClosePath(S.closePath),p}function TP(S){var P=PP.call(this,S);return P.clickThroughEnabled=this.isClickThroughEnabled(),P.syncSize=this.isSyncSize(),P}function XP(S,P){var E=EP(S,P);return rP.config.cloneClickThroughEnabled&&E.setClickThroughEnabled(S.clickThroughEnabled),rP.config.cloneSyncSize&&E.setSyncSize(S.syncSize),E}function WP(S){var P=TP.call(this,S);return P.ref=this.getRef(),P}function hP(S,P){var E=XP(S,P);return rP.config.cloneRef&&E.setRef(S.ref),E}function QP(S){if(!(S instanceof ht.Node))return null;if(S instanceof ht.Group||S instanceof ht.Grid||S instanceof ht.Block)return null;var P=void 0;if(S instanceof HE)P={type:"clip",points:E(S.getPoints()),segments:E(S.getSegments()),closePath:S.isClosePath()};else if(S instanceof TE)P={type:"restore"};else if(S instanceof ht.Shape)P={type:"shape",points:E(S.getPoints()),segments:E(S.getSegments()),closePath:S.isClosePath()};else if(S instanceof ht.Text)P={type:"text",text:S.s("text"),align:S.s("text.align"),vAlign:S.s("text.vAlign"),color:S.s("text.color"),font:S.s("text.font"),shadow:S.s("text.shadow"),shadowColor:S.s("text.shadow.color"),shadowBlur:S.s("text.shadow.blur"),shadowOffsetX:S.s("text.shadow.offset.x"),shadowOffsetY:S.s("text.shadow.offset.y")};else if(S instanceof ht.Node){var p=S.s("shape");p?(P={type:"node_shape",shape:S.s("shape")},"rect"===p?P.depth=S.s("shape.depth"):"roundRect"===p?P.polygonSide=S.s("shape.corner.radius"):"polygon"===p?P.polygonSide=S.s("shape.polygon.side"):"arc"===p&&(P.arcFrom=S.s("shape.arc.from"),P.arcTo=S.s("shape.arc.to"),P.arcClose=S.s("shape.arc.close"),P.arcOval=S.s("shape.arc.oval"))):S.getImage()&&(P={type:"node_image",image:S.getImage(),stretch:S.s("image.stretch"),color:S.s("body.color")})}return P&&(P.visible=S.s("2d.visible"),P.displayName=S.getDisplayName(),P.x=S.getPosition().x,P.y=S.getPosition().y,P.anchorX=S.getAnchor().x,P.anchorY=S.getAnchor().y,P.scaleX=S.getScale().x,P.scaleY=S.getScale().y,P.rotation=S.getRotation(),P.width=S._width,P.height=S._height,P.opacity=S.s("opacity"),"shape"!==P.type&&"node_shape"!==P.type||(P.background=S.s("shape.background"),P.repeatImage=S.s("shape.repeat.image"),P.borderWidth=S.s("shape.border.width"),P.borderColor=S.s("shape.border.color"),P.border3d=S.s("shape.border.3d"),P.border3dColor=S.s("shape.border.3d.color"),P.border3dAccuracy=S.s("shape.border.3d.accuracy"),P.borderCap=S.s("shape.border.cap"),P.borderJoin=S.s("shape.border.join"),P.borderPattern=S.s("shape.border.pattern"),P.gradient=S.s("shape.gradient"),P.gradientColor=S.s("shape.gradient.color"),P.dash=S.s("shape.dash"),P.dashPattern=S.s("shape.dash.pattern"),P.dashOffset=S.s("shape.dash.offset"),P.dashColor=S.s("shape.dash.color"),P.dashWidth=S.s("shape.dash.width"),P.dash3d=S.s("shape.dash.3d"),P.dash3dColor=S.s("shape.dash.3d.color"),P.dash3dAccuracy=S.s("shape.dash.3d.accuracy"),P.fillRule=S.s("shape.fill.rule"),P.fillClipDirection=S.s("shape.fill.clip.direction"),P.fillClipPercentage=S.s("shape.fill.clip.percentage"),P.gradientPack=E(S.s("shape.gradient.pack")),P.borderWidthAbsolute=S.s("shape.border.width.absolute"))),P}function iP(S,P){var p=void 0;if("clip"===S.type)P&&(p=new HE,p.s("type","clip"),p.setPoints(S.points),p.setSegments(S.segments));else if("restore"===S.type)P&&(p=new TE,p.s("type","restore"));else if("shape"===S.type)p=P?new uE:new ht.Shape,p.s("type","shape"),p.setPoints(S.points),p.setSegments(S.segments),p.setClosePath(S.closePath);else if("node_shape"===S.type){p=P?new mE:new ht.Node;var l=S.shape;p.s("shape",l),"rect"===l?p.s("shape.depth",S.depth):"roundRect"===l?p.s("shape.corner.radius",S.polygonSide):"polygon"===l?p.s("shape.polygon.side",S.polygonSide):"arc"===l&&(p.s("shape.arc.from",S.arcFrom),p.s("shape.arc.to",S.arcTo),p.s("shape.arc.close",S.arcClose),p.s("shape.arc.oval",S.arcOval))}else"node_image"===S.type?(P?(p=new FE,p.s("type","image"),p.s("image",S.image)):(p=new ht.Node,p.setImage(S.image)),p.s("body.color",S.color)):"text"===S.type&&(p=P?new fE:new ht.Text,p.s("type","text"),p.s("text",S.text),p.s("text.align",S.align),p.s("text.vAlign",S.vAlign),p.s("text.color",S.color),p.s("text.font",S.font),p.s("text.shadow",S.shadow),p.s("text.shadow.color",S.shadowColor),p.s("text.shadow.blur",S.shadowBlur),p.s("text.shadow.offset.x",S.shadowOffsetX),p.s("text.shadow.offset.y",S.shadowOffsetY));return p?(p.s("2d.visible",S.visible),p.setDisplayName(S.displayName),p.setPosition(S.x,S.y),.5===S.anchorX&&.5===S.anchorY||p.setAnchor(S.anchorX,S.anchorY),p.setScale(S.scaleX,S.scaleY),p.setRotation(S.rotation),p.setSize(S.width,S.height),p.s("opacity",S.opacity),"shape"!==S.type&&"node_shape"!==S.type||(p.s("shape.background",S.background),p.s("shape.repeat.image",S.repeatImage),p.s("shape.border.width",S.borderWidth),p.s("shape.border.color",S.borderColor),p.s("shape.border.3d",S.border3d),p.s("shape.border.3d.color",S.border3dColor),p.s("shape.border.3d.accuracy",S.border3dAccuracy),p.s("shape.border.cap",S.borderCap),p.s("shape.border.join",S.borderJoin),p.s("shape.border.pattern",S.borderPattern),p.s("shape.gradient",S.gradient),p.s("shape.gradient.color",S.gradientColor),p.s("shape.dash",S.dash),p.s("shape.dash.pattern",S.dashPattern),p.s("shape.dash.offset",S.dashOffset),p.s("shape.dash.color",S.dashColor),p.s("shape.dash.width",S.dashWidth),p.s("shape.dash.3d",S.dash3d),p.s("shape.dash.3d.color",S.dash3dColor),p.s("shape.dash.3d.accuracy",S.dash3dAccuracy),p.s("shape.fill.rule",S.fillRule),p.s("shape.fill.clip.direction",S.fillClipDirection),p.s("shape.fill.clip.percentage",S.fillClipPercentage),p.s("shape.gradient.pack",E(S.gradientPack)),p.s("shape.border.width.absolute",S.borderWidthAbsolute)),p):null}function aP(S,P){var E=void 0,p=P?P.dm:null,l=p?p.a("width"):100,_=p?p.a("height"):100,m=JS(S.type);if(fS(m)){var u=lp[m];u?E=new u(S,l,_):pS(m)&&(E=new OE(S,l,_))}else E=new pp(S,l,_);return E&&P&&P.addData(E,!0),E}function sP(S,P){S.s("chart.series")||S.s("chart.series",[]);var E=S.s("chart.series");E[0]||(E[0]={});var p=E[0];return p.values||(p.values=[]),p.colors||(p.colors=[]),p[P]}function kP(S,P){return JS(sP(S,P))}function YP(S,P){return $S(sP(S,P))}function xP(){var S=rP.config.customProperties.display;S&&S.length&&S.forEach(function(S){var P=(S.accessType||"a")+":"+S.property;EE.display[P]=!0}),S=rP.config.customProperties.data,S&&S.length&&S.forEach(function(S){var P=(S.accessType||"a")+":"+S.property;EE.data[P]=!0}),S=rP.config.customProperties.symbol,S&&S.length&&S.forEach(function(S){EE.symbol[S.property]=!0}),(S=rP.config.customProperties.comp)&&S.length&&S.forEach(function(S){EE.comp[S.property]=!0})}function MP(){var S=rP.config,P=rP.consts,E=function(P,E){void 0===S.valueTypes[P]&&(E.name="editor.valuetype."+P.toLowerCase(),S.valueTypes[P]=E)};E("String",{type:"string"}),E("Image",{type:"image"}),E("URL",{type:"url"}),E("Multiline",{type:"multiline",rows:1}),E("Font",{type:"font"}),E("Angle",{type:"number",angle:!0}),E("Int",{type:"int",step:1}),E("PositiveNumber",{type:"number",step:1,min:0}),E("Number",{type:"number",step:1}),E("Color",{type:"color"}),E("Boolean",{type:"boolean"}),E("Function",{type:"function"}),E("Object",{type:"object"}),E("ObjectArray",{type:"objectArray",rows:3}),E("StringArray",{type:"stringArray",rows:3}),E("NumberArray",{type:"numberArray",rows:3}),E("ColorArray",{type:"colorArray",rows:3}),E("Opacity",{type:"number",min:0,max:1,step:.01}),E("Percentage",{type:"number",min:0,max:1,step:.01}),E("Gradient",{type:"enum",values:S.gradients,icons:S.gradientIcons,dropDownWidth:140}),E("FillRule",{type:"enum",values:P.fillRules,labels:P.fillRuleLabels}),E("ClipDirection",{type:"enum",values:P.clipDirections,labels:P.clipDirectionLabels}),E("CapStyle",{type:"enum",values:P.caps,labels:P.capLabels}),E("JoinStyle",{type:"enum",values:P.joins,labels:P.joinLabels}),E("Align",{type:"enum",values:P.aligns,labels:P.alignLabels}),E("VAlign",{type:"enum",values:P.vAligns,labels:P.vAlignLabels}),E("Stretch",{type:"enum",values:P.stretchs,labels:P.stretchLabels}),E("Direction",{type:"enum",values:P.directions,labels:P.directionLabels}),E("Orientation",{type:"enum",values:P.orientations,labels:P.orientationLabels}),E("ColumnChart",{type:"enum",values:P.columnChartTypes,labels:P.columnChartTypeLabels}),P.valueTypes=[],P.valueTypeLabels=[];for(var p in rP.config.valueTypes)!function(S){var E=rP.config.valueTypes[S];E.type&&(P.valueTypes.push(S),P.valueTypeLabels.push(l(E.name)||l(S)),"enum"===E.type&&E.i18nLabels&&!E.labels&&(E.labels=[],E.i18nLabels.forEach(function(S){E.labels.push(l(S))})))}(p)}function bP(){var S=rP.consts={};S.edgeTypes=[void 0,"points"].concat(Object.keys(ht.Default.getEdgeTypeMap())),S.aligns=["left","center","right"],S.alignLabels=[l("editor.align.left"),l("editor.align.center"),l("editor.align.right")],S.vAligns=["top","middle","bottom"],S.vAlignLabels=[l("editor.valign.top"),l("editor.valign.middle"),l("editor.valign.bottom")],S.stretchs=["fill","uniform","centerUniform"],S.stretchLabels=[l("editor.stretch.fill"),l("editor.stretch.uniform"),l("editor.stretch.centeruniform")],S.fillRules=["nonzero","evenodd"],S.fillRuleLabels=[l("editor.nonzero"),l("editor.evenodd")],S.clipDirections=["top","bottom","left","right"],S.clipDirectionLabels=[l("editor.clipdirection.top"),l("editor.clipdirection.bottom"),l("editor.clipdirection.left"),l("editor.clipdirection.right")],S.caps=["butt","round","square"],S.capLabels=[l("editor.cap.butt"),l("editor.cap.round"),l("editor.cap.square")],S.joins=["bevel","round","miter"],S.joinLabels=[l("editor.join.bevel"),l("editor.join.round"),l("editor.join.miter")],S.directions=["h","v"],S.directionLabels=[l("editor.direction.h"),l("editor.direction.v")],S.orientations=["top","right","bottom","left"],S.orientationLabels=[l("editor.orientation.top"),l("editor.orientation.right"),l("editor.orientation.bottom"),l("editor.orientation.left")],S.columnChartTypes=["columnChart","stackedColumnChart","percentageColumnChart"],S.columnChartTypeLabels=[l("editor.columncharttype.columnchart"),l("editor.columncharttype.stackedcolumnchart"),l("editor.columncharttype.percentagecolumnchart")],S.gradients=rP.config.gradients,S.shapes=[void 0,"rect","circle","oval","roundRect","star","triangle","hexagon","pentagon","diamond","rightTriangle","parallelogram","trapezoid","polygon","arc"],S.shapeLabels=[],S.shapeIcons=[],S.shapes.forEach(function(P){P?(S.shapeLabels.push(l("editor.comptype."+P.toLowerCase())),S.shapeIcons.push({width:16,height:16,comps:[{type:P,rect:[2,4,12,8],borderWidth:1,borderColor:rP.config.color_dark}]})):(S.shapeLabels.push(""),S.shapeIcons.push({width:16,height:16,comps:[]}))}),S.selectTypes=["shadow","rect","circle","oval","roundRect"],S.selectTypeLabels=[],S.selectTypeIcons=[],S.selectTypes.forEach(function(P){"shadow"===P?(S.selectTypeLabels.push(l("editor.shadow")),S.selectTypeIcons.push({width:16,height:16,comps:[]})):(S.selectTypeLabels.push(l("editor.comptype."+P.toLowerCase())),S.selectTypeIcons.push({width:16,height:16,comps:[{type:P,rect:[2,4,12,8],borderWidth:1,borderColor:rP.config.color_dark}]}))}),S.displayConnectActionTypes=rP.config.displayConnectActionTypes,S.displayConnectActionTypeLabels=[],S.displayConnectActionTypes.forEach(function(P){var E=P?P.toLowerCase():"none";S.displayConnectActionTypeLabels.push(l("editor.connectactiontype."+E,!0)||l(P))}),S.symbolConnectActionTypes=rP.config.symbolConnectActionTypes,S.symbolConnectActionTypeLabels=[],S.symbolConnectActionTypes.forEach(function(P){var E=P?P.toLowerCase():"none";S.symbolConnectActionTypeLabels.push(l("editor.connectactiontype."+E,!0)||l(P))})}String.prototype.startsWith||(String.prototype.startsWith=function(S,P){return P=P||0,this.substr(P,S.length)===S}),String.prototype.endsWith||(String.prototype.endsWith=function(S,P){var E=this.toString();("number"!=typeof P||!isFinite(P)||Math.floor(P)!==P||P>E.length)&&(P=E.length),P-=S.length;var p=E.lastIndexOf(S,P);return-1!==p&&p===P});var jP=window.hteditor_config||{},zP=function(S,P){void 0===jP[S]&&(jP[S]=P)};zP("color_select","#45C4F9"),zP("color_select_dark","#39B0E4"),zP("color_pane","#FCFCFC"),zP("color_pane_dark","#F7F7F7"),zP("color_line","#E4E4E4"),zP("color_dark","#2C2C2C"),zP("color_light","white"),zP("color_data_border","#979797"),zP("color_data_background","#D8D8D8"),zP("color_transparent","rgba(70,70,70,0.4)"),zP("color_disabled","#8C8C8C"),zP("color_guide","red"),zP("color_hover","rgba(184,184,184,0.18)"),zP("color_mask","rgba(84,110,125,0.30)");var cP=function(){var S=navigator.userAgent
;return S.indexOf("compatible")>-1&&S.indexOf("MSIE")>-1||S.indexOf("Trident")>-1&&S.indexOf("rv:11.0")>-1}();if(zP("host",window.location.hostname),zP("port",window.location.port),zP("locale","en"),zP("serviceClass","hteditor.WebSocketService"),zP("maxUndoRedoSteps",200),zP("inspectorTitleHeight",void 0),zP("smallFont","10px arial, sans-serif"),zP("boldFont","bold 12px arial, sans-serif"),zP("leftSplitViewPosition",260),zP("rightSplitViewPosition",-300),zP("mainSplitViewPosition",-320),zP("explorerSplitViewPosition",.4),zP("requestDelay",100),zP("imageSize",200),zP("fileSize",50),zP("maxFileSize",200),zP("dragImageSize",50),zP("dragImageOpacity",.7),zP("animate",!0),zP("fitPadding",20),zP("rulerSize",16),zP("edgeLoop",!0),zP("pasteOffset",5),zP("continuousLayout",!0),zP("maxZoom",50),zP("minZoom",.01),zP("detailFilter",{}),zP("compactFilter",{}),zP("customProperties",{}),zP("rulerEnabled",!0),zP("gridEnabled",!1),zP("displayGridBlockSize",40),zP("displayGridThickLinesEvery",10),zP("displayGridThickColor","rgb(191, 191, 191)"),zP("displayGridLightColor","rgba(191, 191, 191, 0.4)"),zP("displayGridAngle",Math.PI/2),zP("displayGridRotation",0),zP("displayGridZoomThreshold",.25),zP("displayGridAlignmentGuideColor",jP.color_guide),zP("symbolGridBlockSize",1),zP("symbolGridThickLinesEvery",20),zP("symbolGridThickColor","rgb(191, 191, 191)"),zP("symbolGridLightColor","rgba(191, 191, 191, 0.2)"),zP("symbolGridAngle",Math.PI/2),zP("symbolGridRotation",0),zP("symbolGridZoomThreshold",.25),zP("symbolGridAlignmentGuideColor",jP.color_guide),zP("maxStringLength",1e6),zP("maxFileNameLength",100),zP("traceMissingI18n",!1),zP("container",void 0),zP("continuousCreating",!1),zP("valueTypes",{}),zP("indent","zh"===jP.locale?90:110),zP("indent2",70),zP("clearDataBindingsBeforeImporting",!0),zP("insertDisplayViewAsRefGraph",!1),zP("displayPreviewURL","display.html"),zP("symbolPreviewURL","symbol.html"),zP("removeFileByKeyboardEnabled",!1),zP("locateFileEnabled",!0),zP("promptBeforeClosing",!0),zP("displaysVisible",!0),zP("symbolsVisible",!0),zP("componentsVisible",!0),zP("assetsVisible",!0),zP("displaysModifiable",!0),zP("symbolsModifiable",!0),zP("componentsModifiable",!0),zP("assetsModifiable",!0),zP("settingDefaultValueBeforeSaving",!1),zP("svgSegments",20),zP("importConfirm",!0),zP("newIfFailToOpen",!0),zP("dataBindings",void 0),zP("useCodeEditor",!cP),zP("codeEditorClass","hteditor.CodeEditor"),zP("fontPreview","Hightopo"),zP("checkForFileChanges",!0),zP("checkForFileChangesInterval",3e3),zP("rotateAsClock",!1),zP("cloneAttr",!0),zP("cloneStyle",!0),zP("cloneName",!0),zP("cloneDisplayName",!0),zP("cloneToolTip",!0),zP("cloneTag",!1),zP("cloneIcon",!0),zP("cloneLayer",!0),zP("cloneParent",!0),zP("cloneDataBindings",!0),zP("cloneSource",!0),zP("cloneTarget",!0),zP("cloneExpanded",!0),zP("cloneClickThroughEnabled",!0),zP("cloneSyncSize",!0),zP("cloneRef",!0),zP("clonePoints",!0),zP("cloneSegments",!0),zP("cloneThickness",!0),zP("cloneClosePath",!0),zP("cloneRotation",!0),zP("clonePosition",!0),zP("cloneSize",!0),zP("cloneScale",!0),zP("cloneAnchor",!0),zP("cloneImage",!0),zP("cloneHost",!0),zP("dialogTitleBackground",null),zP("explorerMode","treeList"),zP("isDataBound",function(S,P,E){var p=S.getDataBindings();return p&&p[P]&&p[P][E]}),zP("paletteColors",[["rgb(51,153,255)","#60ACFC","#32D3EB","rgb(93,217,174)","rgb(125,195,125)","rgb(255,235,195)","rgb(226,250,87)"],["#FEB64D","#FF7C7C","rgb(241,125,164)","rgb(204,104,166)","rgb(135,144,204)","rgb(145,115,205)","rgb(124,145,155)"],["rgb(48,242,120)","rgb(0,199,7)","rgb(242,83,75)","rgb(212,0,0)","rgb(240,225,19)","rgb(247,247,247)","rgb(61,61,61)"]]),zP("gradients",[null,"linear.southwest","linear.southeast","linear.northwest","linear.northeast","linear.north","linear.south","linear.west","linear.east","radial.center","radial.southwest","radial.southeast","radial.northwest","radial.northeast","radial.north","radial.south","radial.west","radial.east","spread.horizontal","spread.vertical","spread.diagonal","spread.antidiagonal","spread.north","spread.south","spread.west","spread.east"]),jP.gradientIcons||(jP.gradientIcons=[],jP.gradients.forEach(function(S){S?jP.gradientIcons.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:S,gradientColor:jP.color_line,background:jP.color_dark}]}):jP.gradientIcons.push({width:20,height:14,comps:[]})})),zP("fontList",["SimSun","NSimSun","FangSong","KaiTi","FangSong_GB2312","Microsoft YaHei","cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"]),zP("expandedTitles",{}),["TitleBasic","TitleCustom","TitleBackground","TitleBorder","TitleText","TitleImage","TitleNode","TitleGroupBasic","TitleEdgeBasic","TitleArc","TitleDataBinding","TitleComponent","TitleShapeBackground","TitleShapeBorder","TitleGroupTitle","TitleEditingPoint","TitleChart","TitleLayout"].forEach(function(S){null==jP.expandedTitles[S]&&(jP.expandedTitles[S]=!0)}),ht.Default.handleUnfoundImage=function(S,P){return ht.Default.getImage("editor.unknown")},zP("displayConnectActionType",null),zP("symbolConnectActionType",null),zP("displayConnectActionTypes",[null,"copyStyle","host","parent"]),zP("symbolConnectActionTypes",[null,"copyStyle"]),zP("appendDisplayConnectActionTypes",null),zP("appendSymbolConnectActionTypes",null),zP("appendConnectActions",null),zP("connectActions",{copyStyle:{action:function(S,P,p){if(p){var l=p.getStyleMap();for(var _ in l)"shape"!==_&&"label"!==_&&"label2"!==_&&"note"!==_&&"note2"!==_&&"text"!==_&&P.s(_,E(l[_]))}},extraInfo:{visible:function(S){return!0}}},host:{action:function(S,P,E){P instanceof ht.Node&&E instanceof ht.Node&&P.setHost(E)},extraInfo:{delete:{visible:function(S){return S.sm().ld()instanceof ht.Node&&S.sm().ld().getHost()},action:function(S,P){P instanceof ht.Node&&P.setHost(void 0)}},visible:function(S){return S.sm().ld()instanceof ht.Node}}},parent:{action:function(S,P,E){E&&P.setParent(E)},extraInfo:{delete:{visible:function(S){return S.sm().ld().getParent()},action:function(S,P){P.setParent(void 0)}},visible:function(S){return!0}}}}),jP.appendDisplayConnectActionTypes&&jP.appendDisplayConnectActionTypes.forEach(function(S){jP.displayConnectActionTypes.push(S)}),jP.appendSymbolConnectActionTypes&&jP.appendSymbolConnectActionTypes.forEach(function(S){jP.symbolConnectActionTypes.push(S)}),jP.appendConnectActions)for(var VP in jP.appendConnectActions)jP.connectActions[VP]=jP.appendConnectActions[VP];for(var gP in jP.connectActions){var RP=jP.connectActions[gP];ht.Default.setConnectAction(gP,RP.action,RP.extraInfo)}var GP=ht.Default.getToolTipDiv();GP.style.color=jP.color_dark,GP.style.background=jP.color_pane,ht.widget.ColorPicker.prototype._paletteColors=jP.paletteColors,ht.graph.GraphView.prototype._scrollBarColor=jP.color_transparent,ht.graph.GraphView.prototype._rectSelectBackground=jP.color_transparent,ht.graph.GraphView.prototype._rectSelectBorderColor=jP.color_select,ht.graph.GraphView.prototype.isLabelVisible=function(){return!0},ht.widget.ListView.prototype._scrollBarColor=jP.color_transparent,ht.widget.TreeView.prototype._scrollBarColor=jP.color_transparent,ht.widget.TableView.prototype._scrollBarColor=jP.color_transparent,ht.widget.TreeTableView.prototype._scrollBarColor=jP.color_transparent,ht.widget.PropertyView.prototype._scrollBarColor=jP.color_transparent,ht.widget.FormPane.prototype._scrollBarColor=jP.color_transparent,ht.widget.SplitView.prototype._dividerBackground=jP.color_line,ht.widget.SplitView.prototype._continuousLayout=jP.continuousLayout,ht.widget.ListView.prototype._selectBackground=jP.color_select,ht.widget.TreeView.prototype._selectBackground=jP.color_select,ht.widget.TableView.prototype._selectBackground=jP.color_select,ht.widget.TreeTableView.prototype._selectBackground=jP.color_select,ht.widget.TableHeader.prototype._columnLineColor=jP.color_line,ht.widget.TableHeader.prototype._insertColor=jP.color_select_dark,ht.widget.TableView.prototype._columnLineColor=jP.color_line,ht.widget.Toolbar.prototype._separatorColor=jP.color_line,ht.widget.Toolbar.prototype._itemGap=4,ht.widget.Button.prototype._labelColor=jP.color_light,ht.widget.Button.prototype._borderColor=null,ht.widget.Button.prototype._background=jP.color_select,ht.widget.Button.prototype._selectBackground=jP.color_select_dark,ht.widget.CheckBox.prototype._pressBackground=jP.color_pane_dark,ht.widget.ComboBox.prototype._selectBackground=jP.color_select,ht.widget.TabView.prototype._insertColor=jP.color_select_dark,ht.widget.TabView.prototype._selectWidth=0,ht.widget.TabView.prototype._selectBackground=jP.color_select,ht.widget.TabView.prototype._tabBackground=jP.color_dark;var JP=ht.widget.TabView.prototype.drawTab;ht.widget.TabView.prototype.drawTab=function(S,P,E,p,l,_,m){return m=P==this.getCurrentTab()?jP.color_select:jP.color_dark,JP.call(this,S,P,E,p,l,_,m)},ht.widget.FormPane.prototype._hPadding=4,ht.widget.FormPane.prototype._vPadding=4,ht.widget.FormPane.prototype._hGap=4,ht.widget.FormPane.prototype._vGap=4,ht.widget.Slider.prototype._background=jP.color_dark,ht.widget.Slider.prototype._leftBackground=jP.color_select,ht.widget.Slider.prototype._button={width:14,height:14,comps:[{type:"circle",rect:[0,0,14,14],borderWidth:1,borderColor:jP.color_dark,background:jP.color_pane_dark}]},ht.widget.ComboBox.prototype._dropDownIcon=ht.widget.MultiComboBox.prototype._dropDownIcon={width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:jP.color_dark}]},ht.Default.comboBoxBorderColor=jP.color_line,ht.Default.textFieldBorderColor=jP.color_line,ht.Default.contextMenuHoverBackground=jP.color_select,ht.Default.contextMenuSeparatorColor=jP.color_line,ht.Default.dialogTitleBackground=jP.dialogTitleBackground||jP.color_dark,ht.Default.dialogButtonBackground=jP.color_select,ht.Default.dialogButtonSelectBackground=jP.color_select_dark,ht.Default.dialogHeaderBackground=jP.color_pane_dark,ht.Default.toolbarBackground=jP.color_pane_dark,ht.Default.tableHeaderBackground=jP.color_pane_dark,ht.Default.contextMenuLabelFont=ht.Default.labelFont,ht.Default.contextMenuBorderRadius=0,ht.Default.contextMenuBorderColor=jP.color_line,ht.Default.contextMenuSubmenuMark=">&nbsp;",ht.Default.contextMenuCheckIcon={width:16,height:16,comps:[{type:"shape",points:[13,3,7,12,4,8],borderWidth:1,borderColor:jP.color_dark}]},ht.Default.setImage("radioOn",{width:16,height:16,comps:[{type:"circle",rect:[2,2,12,12],borderWidth:1,borderColor:ht.Color.widgetIconBorder,background:"#FFF"},{type:"circle",rect:[4,4,8,8],background:jP.color_select}]}),ht.Default.setImage("expandIcon",{width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:jP.color_dark}]}),ht.Default.setImage("collapseIcon",{width:16,height:16,comps:[{type:"shape",points:[6,3,12,8,6,13],segments:[1,2,2],borderWidth:1,borderColor:jP.color_dark}]}),ht.widget.TreeView.prototype._expandIcon="expandIcon",ht.widget.TreeView.prototype._collapseIcon="collapseIcon",ht.widget.TreeTableView.prototype._expandIcon="expandIcon",ht.widget.TreeTableView.prototype._collapseIcon="collapseIcon",ht.widget.TextField.prototype.setEditable=ht.widget.TextArea.prototype.setEditable=function(S){var P=this._element;S?(P.removeAttribute("readonly"),P.style.color=ht.Default.labelColor):(P.setAttribute("readonly",!0),P.style.color=jP.color_disabled)},ht.Default.onElementCreated=function(S){("INPUT"===S.tagName&&"button"!==S.type||"TEXTAREA"===S.tagName)&&(S.style.border=jP.color_line+" solid 1px",S.style.outline=0,S.style.padding="2px","TEXTAREA"===S.tagName&&(S.style.whiteSpace="pre",S.setAttribute("spellcheck","false")),S.addEventListener("focus",function(P){S.oldBorder=S.style.border,S.style.border=jP.color_select+" solid 1px","INPUT"===S.tagName&&requestAnimationFrame(function(){S.select()}),"TEXTAREA"===S.tagName&&(S.style.zIndex="1")},!1),S.addEventListener("blur",function(P){S.style.border=S.oldBorder,"TEXTAREA"===S.tagName&&(S.style.zIndex="")},!1))},ht.Default.onWidgetColorPickerCreated=function(P){for(var E=jP.color_line+" solid 1px",p=P.getView(),l=p.querySelectorAll(".colorPalette"),_=0;_<l.length;_++)l[_].style.border=E;p.querySelector(".satval").style.border=E,p.querySelector(".hue_image").style.border=E,p.querySelector(".preview").style.border=E,l=p.querySelectorAll('input[type="button"]');for(var m=0;m<l.length;m++){var u=l[m];u.style.border=E,u.style.background="none",u.style.outline="none",u.style.width="30px",u.addEventListener("mouseover",function(S){S.target.style.background=jP.color_hover},!1),u.addEventListener("mouseout",function(){event.target.style.background="none"},!1)}l=p.querySelectorAll("span");for(var F=0;F<l.length;F++)S(P,p,l[F])},ht.Default.handleUnfoundImage=function(S,P){return ht.Default.getImage("editor.unknown")};var $P=(function(){function S(S){this.value=S}function P(P){function E(S,P){return new Promise(function(E,l){var u={key:S,arg:P,resolve:E,reject:l,next:null};m?m=m.next=u:(_=m=u,p(S,P))})}function p(E,_){try{var m=P[E](_),u=m.value;u instanceof S?Promise.resolve(u.value).then(function(S){p("next",S)},function(S){p("throw",S)}):l(m.done?"return":"normal",m.value)}catch(S){l("throw",S)}}function l(S,P){switch(S){case"return":_.resolve({value:P,done:!0});break;case"throw":_.reject(P);break;default:_.resolve({value:P,done:!1})}_=_.next,_?p(_.key,_.arg):m=null}var _,m;this._invoke=E,"function"!=typeof P.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(P.prototype[Symbol.asyncIterator]=function(){return this}),P.prototype.next=function(S){return this._invoke("next",S)},P.prototype.throw=function(S){return this._invoke("throw",S)},P.prototype.return=function(S){return this._invoke("return",S)}}(),function(S,P){if(!(S instanceof P))throw new TypeError("Cannot call a class as a function")}),vP=function(){function S(S,P){for(var E=0;E<P.length;E++){var p=P[E];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(S,p.key,p)}}return function(P,E,p){return E&&S(P.prototype,E),p&&S(P,p),P}}(),BP=function(S,P){if("function"!=typeof P&&null!==P)throw new TypeError("Super expression must either be null or a function, not "+typeof P);S.prototype=Object.create(P&&P.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(S,P):S.__proto__=P)},KP=function(S,P){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!P||"object"!=typeof P&&"function"!=typeof P?S:P},LP=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P.prototype.onShown=function(){SE.push(this)},P.prototype.onHidden=function(){_(SE,this)},P}(ht.widget.Dialog),eP=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this,E));return p.getView().style.background=rP.config.color_pane,p}return BP(P,S),P.prototype.addLine=function(){this.addRow([],[.1],1.01,{background:rP.config.color_line})},P.prototype.addTitle=function(S){var P=[{element:S,font:rP.config.boldFont}],E={background:rP.config.color_pane_dark};this.addRow(P,[.1],null,E)},P.prototype.getRowIndex=function(S){return this.getRows().indexOf(S)},P}(ht.widget.FormPane),rP={strings:{},customStrings:{},config:jP},qP=["onDown","onUp","onMove","onEnter","onHover","onLeave","onBeginDrag","onDrag","onEndDrag","onScroll"],OP="unknow",dP="root",AP="dir",NP="image",ZP="symbol",CP="display",oP="component",DP="model",yP="scene",IP="tile",nP="list",UP="accordion",tP=/^attr@/,wP=/firefox/.test(window.navigator.userAgent.toLowerCase()),SE=[],PE={width:16,height:16,comps:[]},EE={display:{},symbol:{},data:{},comp:{}},pE=new ht.List([{x:50,y:75},{x:25,y:75},{x:25,y:25},{x:75,y:25},{x:75,y:75},{x:65,y:60},{x:75,y:75},{x:85,y:60}]),lE=new ht.List([1,2,2,2,2,2,1,2]);ht.Default.setImage("check",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:rP.config.color_line},{type:"shape",points:[13,3,7,12,4,8],borderWidth:2,borderColor:{func:function(S,P){return S&&P&&P.getRowSize&&P.isSelected&&P.isSelected(S)?rP.config.color_line:rP.config.color_select}}}]}),ht.Default.setImage("uncheck",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:rP.config.color_line}]}),ht.Default.setImage("text_icon",{width:16,height:16,comps:[{type:"shape",points:[3,14,8,2,13,14,5,9,11,9],segments:[1,2,2,1,2],borderColor:rP.config.color_dark,borderWidth:1}]}),ht.Default.setImage("refGraph_icon",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:rP.config.color_dark,rotation:.7854,points:[12.90381,7.59615,12.90381,7.59615,12.90381,4.61619,12.90381,3.59619,12.90381,2.57619,11.72047,1.59619,10.40381,1.59619,9.08714,1.59619,7.90381,2.61619,7.90381,3.59619,7.90381,4.35799,7.90381,7.59615,7.90381,7.59615,7.90381,7.59615,7.90381,9.59619,10.40381,9.59619],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:rP.config.color_dark,rotation:-2.35619,points:[8.21091,12.28904,8.21091,12.28904,8.21091,9.30909,8.21091,8.28909,8.21091,7.26909,7.02758,6.28909,5.71091,6.28909,4.39425,6.28909,3.21091,7.30909,3.21091,8.28909,3.21091,9.05088,3.21091,12.28904,3.21091,12.28904,3.21091,12.28904,3.21091,14.28909,5.71091,14.28909],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unknown",{width:50,height:50,fitSize:!0,comps:[{type:"shape",points:[5,5,45,45],segments:[1,2],borderWidth:1,borderColor:"red"},{type:"shape",points:[5,45,45,5],segments:[1,2],borderWidth:1,borderColor:"red"}]}),ht.Default.setImage("editor.root",{width:30,height:30,fitSize:!0,comps:[{type:"shape",points:[23,8,8,23],segments:[1,2],borderWidth:1,borderColor:"white"}]}),ht.Default.setImage("editor.display",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:rP.config.color_light,rect:[6,1,4,4.00837]},{type:"circle",borderWidth:1,borderColor:rP.config.color_light,rect:[11,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:rP.config.color_light,points:[2.98235,11.0795,2.98235,8,7.89475,8,7.89475,5.00837,7.89475,8,13,8,13,11]},{type:"circle",borderWidth:1,borderColor:rP.config.color_light,rect:[1,10.99163,4,4.00837]}]}),ht.Default.setImage("editor.symbol",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:rP.config.color_light,rect:[0,2,10,8]},{type:"rect",borderWidth:1,borderColor:rP.config.color_light,rect:[5,6,10,8]}]}),ht.Default.setImage("editor.filter",{background:"rgb(130,130,130)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",closePath:!0,points:[2,1.5,14,1.5,9.50949,5.5,9.50949,9.5,13,9.5,9.50949,9.5,9.50949,11.5,12,11.5,9.50949,11.5,9.50949,14.5,6.5335,12.5,6.5335,5.5,2,1.5]}]}),ht.Default.setImage("editor.bind",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unbind",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:.7854,points:[13.49999,7.03553,13.49999,7.03553,13.49999,5.05554,13.49999,4.03553,13.49999,3.01553,12.31666,2.03553,10.99999,2.03553,9.68333,2.03553,8.49999,3.05553,8.49999,4.03553,8.49999,5.01553,8.49999,7.03553,8.49999,7.03553],segments:[1,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.92699,points:[7.28554,13.25761,7.28554,13.25761,7.28554,11.27761,7.28554,10.2576,7.28554,9.23761,6.1022,8.25761,4.78554,8.25761,3.46887,8.25761,2.28554,9.2776,2.28554,10.2576,2.28554,11.2376,2.28554,13.25761,2.28554,13.25761],segments:[1,4,4,4,4]}]}),ht.Default.setImage("editor.dircollapsed",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,204,153)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14.5,14.5,.5,14.5,.5,1.50001,6.5,1.50001,7.5,3.50001,14.5,3.50001,14.5,14.5]},{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.5,5.50001,14.5,5.50001,14.5,14.50001,.5,14.50001,.5,5.50001]}]}),ht.Default.setImage("editor.direxpanded",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(51,153,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.35891,10.47175,3.3125,6.30284,15.5,6.30284,13.625,14.5,.5,14.5,.5,1.5,6.125,1.5,7.0625,3.2289,12.6875,3.2289,12.6875,6.30284]}]}),ht.Default.setImage("editor.dir",{background:"rgb(227,227,227)",width:20,height:20,fitSize:!0,comps:[{type:"shape",background:"#FFCC99",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[19,4,19,18,1,18,1,2,8.71429,2,10,4,19,4]},{type:"rect",shadow:!0,shadowColor:"rgba(0,0,0,0.4)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(255,255,255)",borderColor:"#979797",rotation:6.28319,rect:[2.98273,5.998,13.98346,9.99004]},{type:"shape",background:"rgba(255,255,153,0.3)",borderColor:"rgb(255,255,255)",borderCap:"round",points:[18,9,18,17,2,17,2,9,18,9]},{type:"rect",shadowColor:"rgb(0,0,0)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(232,230,230)",borderColor:"#979797",rotation:6.28319,rect:[4,7,11.98532,1.06039]}]}),ht.Default.setImage("editor.dxf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[25.13334,60.62742,20.38001,60.62742,20.11302,60.62742,19.89504,60.41688,19.89504,60.15453,19.89504,43.31796,19.89504,43.05561,20.11302,42.84507,20.38001,42.84507,25.13334,42.84507,30.66329,42.84507,33.35167,45.67873,33.35167,51.50916,33.35167,57.47593,30.51009,60.62742,25.13334,60.62742,25.13334,60.62742,23.32783,57.5939,25.03463,57.5939,28.43349,57.5939,29.82018,55.90554,29.82018,51.77117,29.82018,47.64415,28.35946,45.88193,24.93627,45.88193,23.32783,45.88193,23.32783,57.5939,23.32783,57.5939],segments:[1,2,4,2,4,2,4,4,2,1,2,4,4,2,2,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[48.10416,60.62742,45.1488,60.62742,44.97846,60.62742,44.82286,60.54254,44.73581,60.40217,40.95446,54.3465,37.26771,60.39482,37.1786,60.53886,37.01957,60.62776,36.84889,60.62776,34.01657,60.62776,33.84041,60.62776,33.67761,60.53552,33.59227,60.38379,33.50693,60.2324,33.51275,60.04759,33.60735,59.89987,39.05608,51.53522,33.90312,43.56961,33.80853,43.42557,33.8027,43.24076,33.88804,43.08937,33.97338,42.93797,34.13618,42.8454,34.31235,42.8454,37.31706,42.8454,37.4874,42.8454,37.64677,42.93396,37.73382,43.078,41.14399,48.68284,44.48219,43.08168,44.56924,42.93396,44.72861,42.84507,44.90272,42.84507,47.73299,42.84507,47.91121,42.84507,48.074,42.93731,48.15729,43.08903,48.24434,43.24042,48.2368,43.42524,48.14221,43.56928,43.03826,51.48342,48.51339,59.89987,48.60798,60.04759,48.61552,60.2324,48.52847,60.38379,48.44518,60.53485,48.28238,60.62742,48.10416,60.62742,48.10416,60.62742],segments:[1,2,4,2,2,4,2,4,4,2,2,4,4,2,4,2,2,4,2,4,4,2,2,4,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]}]}),ht.Default.setImage("editor.sound",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",points:[29.93506,40.65719,29.93506,52.11129,29.99768,52.17391,38.01482,58.31199,38.01482,53.06642,38.01482,39.70982,38.01482,34.45641,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,44.44257,36.03797,44.44257,36.03797,43.87107,35.70912,43.69881,34.9732,44.02766,34.40163,44.37211,33.84573,45.10803,33.65787,45.66393,33.99448,47.80131,35.26287,49.59417,37.09491,50.81553,39.2714,52.01338,41.37743,52.71019,43.80448,52.71019,46.38028,52.71019,48.95608,52.01338,51.38313,50.81553,53.48924,49.59417,55.65789,47.80131,57.49777,45.66393,58.77392,45.10803,59.1262,44.37211,58.93834,44.02766,58.35901,43.69881,57.79528,43.87107,57.05152,44.44257,56.7305,46.24326,55.65789,47.71518,54.13119,48.7486,52.32266,49.73508,50.57675,50.30665,48.55685,50.30665,46.38812,50.30665,44.23514,49.72724,42.19948,48.7486,40.46141,47.71518,38.63721,46.23542,37.10275,44.44257,36.03797,44.44257,36.03797,44.44257,36.03797,28.49449,40.89991,28.49449,40.89991,23.62472,40.89991,23.62472,51.86073,28.49449,51.86073,28.49449,40.89991,28.49449,40.89991,28.49449,40.89991,28.80767,38.51197,28.80767,38.51197,38.42189,31.14469,38.64118,30.96459,38.91517,30.86286,39.21267,30.86286,39.88597,30.86286,40.41052,31.38741,40.41052,32.05287,40.41052,39.70982,40.41052,39.97605,41.53008,40.43014,42.47745,41.16606,43.21337,42.09776,44.14506,43.28777,44.7088,44.76753,44.7088,46.38812,44.7088,48.00879,44.1529,49.50414,43.21337,50.67856,42.50096,51.61017,41.53008,52.33834,40.41052,52.80027,40.41052,53.07426,40.41052,60.72336,40.41052,60.99743,40.32439,61.24015,40.1678,61.45936,39.76073,61.97607,39.01698,62.07788,38.50019,61.67073,28.82334,54.25651,22.46606,54.25651,22.43471,54.25651,21.77708,54.25651,21.23686,53.72412,21.23686,53.06642,21.23686,39.73333,21.23686,39.70982,21.23686,39.04435,21.76924,38.51197,22.43471,38.51197,28.80767,38.51197,28.80767,38.51197,28.80767,38.51197,40.40269,41.5497,40.40269,41.5497,40.40269,51.21878,41.06823,50.85858,41.62405,50.37322,42.08598,49.79381,42.8219,48.86219,43.26039,47.6721,43.26039,46.38812,43.26039,45.11197,42.81414,43.92196,42.08598,42.98243,41.62405,42.39526,41.06039,41.90982,40.40269,41.5497,40.40269,41.5497,40.40269,41.5497],segments:[1,2,2,2,2,2,2,2,2,2,2,1,2,4,4,4,4,4,4,4,4,4,4,4,4,2,2,1,2,2,2,2,2,2,2,1,2,2,4,4,2,2,4,4,4,4,2,2,4,4,2,2,2,4,2,2,4,2,2,2,1,2,2,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.video",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",
points:[34.79567,39.50193,35.8771,39.50193,36.86394,39.06777,37.56645,38.36518,38.28485,37.63888,38.7269,36.65212,38.7269,35.57851,38.7269,34.497,38.28485,33.51024,37.56645,32.80765,36.86394,32.08933,35.86927,31.6472,34.79567,31.6472,33.70626,31.6472,32.7274,32.08933,32.0169,32.80765,31.30641,33.51024,30.86435,34.497,30.86435,35.57851,30.86435,36.65212,31.30641,37.63888,32.0169,38.36518,32.7274,39.05987,33.71416,39.50193,34.79567,39.50193,34.79567,39.50193,34.79567,39.50193,33.03527,33.81021,33.03527,33.81021,33.47733,33.36816,34.10098,33.08399,34.79567,33.08399,35.48246,33.08399,36.0982,33.36816,36.54816,33.81021,36.99022,34.26807,37.27438,34.88382,37.27438,35.57061,37.27438,36.2574,36.99022,36.87315,36.54816,37.33101,36.0982,37.76524,35.48246,38.0494,34.79567,38.0494,34.10098,38.0494,33.47733,37.76524,33.03527,37.33101,32.59314,36.87315,32.31687,36.2574,32.31687,35.57061,32.31687,34.88382,32.59314,34.27598,33.03527,33.81021,33.03527,33.81021,33.03527,33.81021,38.719,42.35963,38.719,42.35963,39.05848,43.38583,39.77688,44.19107,40.6768,44.64103,42.60298,45.61989,44.97913,44.84625,45.95008,42.92007,46.40794,42.02015,46.53422,40.94655,46.17901,39.92027,45.86323,38.89408,45.14484,38.08884,44.23702,37.63888,43.33711,37.18892,42.2714,37.06264,41.24513,37.40995,40.21894,37.74943,39.39789,38.46775,38.95583,39.35984,38.49007,40.25185,38.3796,41.32546,38.719,42.35963,38.719,42.35963,38.719,42.35963,40.24257,40.02292,40.24257,40.02292,40.53471,39.44669,41.04781,38.99665,41.68726,38.77563,42.33454,38.5704,43.02923,38.64144,43.58184,38.93351,44.15808,39.22558,44.60803,39.72295,44.82124,40.38604,45.03436,41.03339,44.96332,41.70438,44.67907,42.28851,44.06341,43.50428,42.55557,43.98577,41.33198,43.3543,40.77937,43.07005,40.30578,42.56486,40.10048,41.9175,39.87945,41.25442,39.9663,40.58343,40.24257,40.02292,40.24257,40.02292,40.24257,40.02292,40.13209,46.26716,40.13209,46.26716,39.16114,46.10935,38.09543,46.33828,37.21915,46.96976,36.34286,47.61711,35.80606,48.54073,35.65607,49.5354,35.65607,49.5354,35.50608,50.53006,35.71929,51.57996,36.35076,52.46415,36.98231,53.33245,37.89803,53.86926,38.89269,54.02714,38.9243,54.02714,41.04781,54.38235,43.08447,52.8904,43.42395,50.76689,43.42395,50.75899,43.56604,49.76433,43.34501,48.71435,42.71346,47.84604,42.06618,46.96976,41.14256,46.42505,40.13209,46.26716,40.13209,46.26716,40.13209,46.26716,39.14533,52.60623,39.14533,52.60623,39.12953,52.59833,38.49797,52.49568,37.91384,52.1641,37.51912,51.61157,37.1244,51.05896,36.97441,50.38798,37.07706,49.75642,37.17181,49.13278,37.51912,48.54073,38.07172,48.13021,38.62433,47.73549,39.30322,47.60131,39.93469,47.69606,40.55044,47.79081,41.15046,48.13021,41.5451,48.69072,41.94772,49.24333,42.08981,49.91431,41.98724,50.53796,41.77403,51.87993,40.4794,52.81936,39.14533,52.60623,39.14533,52.60623,39.14533,52.60623,49.24984,57.84791,49.24984,57.84791,41.37939,57.84791,46.82629,55.31388,50.46553,49.76433,50.46553,43.63056,50.46553,39.30453,48.70514,35.38909,45.86323,32.54719,43.03714,29.72109,39.12162,27.9607,34.79567,27.9607,26.1594,27.9607,19.12572,34.99437,19.12572,43.63056,19.12572,47.94079,20.88612,51.87993,23.71222,54.69813,26.54622,57.54003,30.46963,59.30043,34.79567,59.30043,35.20611,59.30043,35.29296,59.30043,49.24984,59.30043,49.64456,59.30043,49.96816,58.96893,49.96816,58.57421,49.96816,58.17158,49.64456,57.84791,49.24984,57.84791,49.24984,57.84791,49.24984,57.84791,34.79567,56.88485,34.79567,56.88485,31.13271,56.88485,27.81723,55.39282,25.42528,53.00087,23.01761,50.5853,21.54138,47.28553,21.54138,43.62266,21.54138,36.34425,27.51725,30.36837,34.79567,30.36837,38.45064,30.36837,41.77403,31.8525,44.15808,34.25227,46.56583,36.64422,48.04206,39.96769,48.04206,43.62266,48.04206,47.28553,46.55793,50.6011,44.16598,53.00087,41.68726,55.48757,38.30856,56.88485,34.79567,56.88485,34.79567,56.88485,34.79567,56.88485,28.91446,44.64103,28.91446,44.64103,29.80655,44.18317,30.54067,43.38583,30.86435,42.35173,31.19593,41.32546,31.08538,40.25976,30.63542,39.35984,29.67237,37.44156,27.25672,36.66002,25.35424,37.63888,23.42015,38.62564,22.64651,41.00178,23.62545,42.92007,24.07541,43.81998,24.88057,44.53838,25.90684,44.86206,26.94884,45.20146,28.02245,45.09889,28.91446,44.64103,28.91446,44.64103,28.91446,44.64103,26.3647,43.51211,26.3647,43.51211,25.71735,43.29108,25.20425,42.82532,24.91218,42.28069,24.29643,41.0492,24.79373,39.54136,26.00942,38.92561,27.22519,38.30986,28.73294,38.79143,29.34869,40.02292,29.63286,40.59134,29.7118,41.25442,29.50658,41.90178,29.28555,42.54905,28.81979,43.06215,28.27509,43.34639,27.69877,43.63056,27.01198,43.71741,26.3647,43.51211,26.3647,43.51211,26.3647,43.51211,29.44344,46.26716,29.44344,46.26716,27.31195,46.59874,25.85153,48.61178,26.17521,50.72738,26.17521,50.75899,26.33309,51.75365,26.8778,52.69308,27.73828,53.32455,28.59876,53.9561,29.66447,54.17713,30.62752,54.02714,30.66703,54.01924,32.80634,53.67194,34.25886,51.66681,33.92728,49.52749,33.60361,47.39609,31.58275,45.94356,29.44344,46.26716,29.44344,46.26716,29.44344,46.26716,32.50637,49.75642,32.50637,49.75642,32.7274,51.1063,31.80378,52.39303,30.44593,52.60623,30.4223,52.61413,29.79865,52.7009,29.13557,52.55091,28.59086,52.14837,28.04616,51.75365,27.69877,51.15371,27.5962,50.53006,27.5962,50.50635,27.3909,49.17229,28.33032,47.90128,29.66447,47.69606,31.00644,47.48293,32.29317,48.40655,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,37.44808,43.63056,37.44808,43.63056,37.44808,42.89644,37.1481,42.22537,36.67444,41.75171,36.18497,41.27022,35.52189,40.96235,34.79567,40.96235,34.06147,40.96235,33.39048,41.27022,32.90891,41.75171,32.43525,42.23328,32.14318,42.89644,32.14318,43.63056,32.14318,44.36469,32.43525,45.02785,32.90891,45.50933,33.39838,45.983,34.06147,46.28297,34.79567,46.28297,36.25609,46.28297,37.44808,45.08308,37.44808,43.63056,37.44808,43.63056,37.44808,43.63056,34.79567,44.83835,34.79567,44.83835,34.45619,44.83835,34.14831,44.71207,33.93519,44.49104,33.71416,44.28574,33.5878,43.96997,33.5878,43.63846,33.5878,43.31479,33.71416,42.99901,33.93519,42.77798,34.14831,42.56486,34.45619,42.42277,34.79567,42.42277,35.11927,42.42277,35.42714,42.55695,35.64817,42.77798,35.86927,42.99901,36.01136,43.31479,36.01136,43.63846,36.01136,44.30155,35.46665,44.83835,34.79567,44.83835,34.79567,44.83835,34.79567,44.83835],segments:[1,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,2,4,4,2,4,2,4,4,2,2,1,2,2,4,4,4,4,4,4,4,2,2,1,2,2,4,4,4,4,4,4,2,2,2,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.flipx",{width:16,height:16,comps:[{type:"shape",points:[8,1,8,14],segments:[1,2],borderWidth:1,borderColor:rP.config.color_dark},{type:"shape",points:[6,3,6,13,2,13],background:rP.config.color_dark},{type:"shape",points:[10,3,10,13,14,13],background:rP.config.color_select}]}),ht.Default.setImage("editor.flipy",{width:16,height:16,comps:[{type:"shape",points:[2,8,15,8],segments:[1,2],borderWidth:1,borderColor:rP.config.color_dark},{type:"shape",points:[3,6,13,6,3,2],background:rP.config.color_dark},{type:"shape",points:[3,10,13,10,3,14],background:rP.config.color_select}]}),ht.Default.setImage("editor.resetsize",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[8,1,8,6,6,3,8,1,10,3,8,10,8,15,6,13,8,15,10,13,1,8,6,8,3,6,1,8,3,10,10,8,15,8,13,6,15,8,13,10],segments:[1,2,1,2,2,1,2,1,2,2,1,2,1,2,2,1,2,1,2,2]}]}),ht.Default.setImage("editor.func",{width:16,height:16,comps:[{type:"border",rect:[0,0,16,16],width:1,color:"#E4E4E4"},{type:"text",rect:[0,0,16,16],text:"F",align:"center",color:"black"}]}),ht.Default.setImage("editor.comp",{fitSize:!0,comps:[{type:{func:function(S){return S.compType},isSafeFunc:!0}}]}),ht.Default.setImage("editor.oops",{width:128,height:128,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",background:"rgb(237,237,237)",borderColor:"#979797",points:[34.08079,87.52544,34.08079,87.52544,59.57908,97.75645,77.79215,90.58303,96.00522,83.40961,106.8249,68.87436,109.71641,51.69689,109.71641,51.69689,117.89865,74.48774,101.34821,87.52544,84.79777,100.56314,59.50721,102.27801,46.42474,94.29524],segments:[1,4,4,4,4]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,36.49467,28.49791,18.12387]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,36.49467,28.49791,18.12387]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",points:[39.9814,51.13901,39.9814,51.13901,32.00842,57.90113,30.56723,66.4088,29.12604,74.91647,34.21664,85.16969,34.21664,85.16969,39.0516,89.44677,39.0516,89.44677,36.05169,79.68945,37.3999,70.48443,38.74811,61.27941,44.44444,52.62669,44.44444,52.62669,39.9814,51.13901,39.9814,51.13901],segments:[1,4,4,2,4,4,2,2]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",scaleX:-1,points:[97.67259,49.56003,97.67259,49.56003,89.6996,57.90113,88.25841,66.4088,86.81722,74.91647,91.8398,85.99598,91.8398,85.99598,96.74279,89.44677,96.74279,89.44677,93.74288,79.68945,95.09109,70.48443,96.4393,61.27941,102.44264,50.50641,102.44264,50.50641,97.67259,49.56003],segments:[1,4,4,2,4,4,2]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[59.61377,32.055,59.61377,32.055,61.61221,36.91182,59.19747,38.71578,56.78274,40.51974,34.08079,42.18493,34.08079,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[94.48806,32.055,94.48806,32.055,96.4865,36.91182,94.07177,38.71578,91.65703,40.51974,68.95508,42.18493,68.95508,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[67.02409,33.58143,67.02409,33.58143,64.9426,37.74441,67.02409,39.68714],segments:[1,4]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,40.07324,28.49791,11.89121]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,40.07323,28.49791,11.89121]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[60.89581,46.6003,56.70566,57.66949,39.6779,55.58118,39.6779,55.58118],segments:[1,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[90.173,46.6003,85.98284,57.66949,68.95508,55.58118,68.95508,55.58118],segments:[1,4]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[40.88134,45.66533,40.88134,50.44931,49.68823,51.31913,49.03586,45.66533,40.99007,45.5566]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[78.31735,45.66533,78.31735,50.44931,87.12423,51.31913,86.47187,45.66533,78.42607,45.5566]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[36.81151,80.08117,46.71402,84.60188,54.03326,76.42155,61.35251,85.46297,73.83828,76.20628,86.96987,83.95607,93.85858,76.85209,99.24038,80.08117]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",points:[95.58345,31.98512,95.58345,31.98512,104.33563,25.53184,105.97087,18.7394,107.6061,11.94695,113.65647,33.63444,105.97087,42.39888],segments:[1,4,4]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[44.41276,23.77714,38.68944,23.77714,33.30496,20.23699,28.88983,14.5401,24.47469,8.84321,22.55729,35.68983,32.04166,40.72938],segments:[1,4,4]},{type:"oval",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[93.19422,30.5138,93.19422,30.5138,96.32695,28.82985,99.04364,25.51534,100.63358,23.57553,102.08422,21.24706,102.68792,18.7394,104.32316,11.94695,112.13179,31.92062,104.44618,40.68506],segments:[1,4,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[40.62881,26.14647,34.90549,26.14647,32.31798,22.75803,27.90285,17.06114,23.48771,11.36426,18.41848,35.24736,27.90285,40.28692],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[91.52207,49.98659,1.67215,3.35736]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[39.44815,49.46033,2.86639,3.35736]}]}),ht.Default.setImage("editor.block",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15,14.5,1,14.5,1,1.50001,7,1.50001,8,3.50001,15,3.50001,15,14.5]},{type:"rect",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[5.5,7.22625,6,5]},{type:"circle",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[2.5,4.72625,6,5]}]}),ht.Default.setImage("editor.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.82964,11.54111,13.17036,11.54111,13.17036,13.12467,13.17036,5.20688,2.82964,5.20688,2.82964,13.12467,13.17036,13.12467,7.26137,13.12467,5.78413,15.5,10.21588,15.5,8.84426,13.12467,13.17036,13.12467,13.17036,11.54111]}]}),ht.Default.setImage("editor.subgraph",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[4.90316,8.05737,4.90316,8.05737,4.30121,6.50546,5.25104,5.82166,6.20086,5.13787,7.09165,5.82166,7.09165,5.82166,7.09165,5.82166,7.76857,4.36921,9.6391,4.91013,11.50964,5.45106,11.09684,8.05737,11.09684,8.05737,11.09684,8.05737,12.482,8.53031,12.482,9.79106,12.482,10.86629,11.67411,11.63079,11.09684,11.63079,4.90316,11.63079,4.31315,11.63079,3.518,10.84732,3.518,9.79106,3.518,8.56402,4.90316,8.05737,4.90316,8.05737],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[13,13.5,8.02409,13.5,8,9,8.02409,13.5,3,13.5]}]}),ht.Default.setImage("editor.restore",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.add",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",rotation:3.14159,points:[9.47991,2.5,13.48953,7.4,9.47991,7.4,9.47991,2.5,2.48953,2.5,2.48953,13.5,13.48953,13.5,13.48953,7.4]}]}),ht.Default.setImage("editor.delete",{background:"rgb(89,89,89)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[5.5,5.57173,5.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.05685,5.57173,8.05685,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[10.5,5.57173,10.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,3.18902,15,3.16996,5.32652,3.16021,6.32652,1.16021,9.32652,1.16021,10.32652,3.16021]},{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[3.33333,3.18902,9.33334,11.65078]}]}),ht.Default.setImage("editor.import",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"triangle",borderColor:"rgb(255,255,255)",borderWidth:1,rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.top",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.86035,6.44002,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,4.58061,13.85824,4.51881]}]}),ht.Default.setImage("editor.up",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.89924,6.05159,8.20153,8.2581]}]}),ht.Default.setImage("editor.down",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.89924,.69031,8.20153,8.2581]}]}),ht.Default.setImage("editor.bottom",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.93812,.69031,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,10.85024,13.85824,10.78844]}]}),ht.Default.setImage("editor.menu",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.93729,4,14.93729,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,8,15.06271,8]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,12,15.06271,12]}]}),ht.Default.setImage("editor.undo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",shadowColor:"#1ABC9C",points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.redo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",shadowColor:"#1ABC9C",scaleX:-1,points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.edit",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(51,153,255)",shadowColor:"#1ABC9C",rotation:5.49779,closePath:!0,points:[6,-.83884,.5,13.16116,6.04966,10.58206,11.5,13.16116,6,-.83884]}]}),ht.Default.setImage("editor.rulers",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[1.50517,1.5,1.5,4.49799,2.47337,4.49798,1.5,4.49799,1.50003,14.5,11.23413,14.48019,11.23413,13.48171,11.23413,14.47896,14.5,14.47897,4.00002,14.47899,4.00001,12.00001,1.50521,12.00002]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14,6,14,14,6,14]}]}),ht.Default.setImage("editor.grid",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.49468,1.49999,4.5,14.49999,4.49468,11.53541,1.5,11.51432,14.5,11.51432,11.52105,11.53541,11.52105,14.49999,11.52105,1.49999,11.5,4.50429,14.5,4.50429,1.5,4.50429]}]}),ht.Default.setImage("editor.save",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[3.66183,14.5,14.5,14.5,14.5,4.83454,10.71984,1.5,3.66183,1.5,3.66183,6.18654,10.71984,6.18654,10.71984,1.5,1.5,1.5,1.5,14.5,3.66183,14.5,3.66183,9.03168,12.17213,9.03168,12.17213,14.5]}]}),ht.Default.setImage("editor.preview",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[1.9869,6.489,2,2,14,8,1.9869,14,2,9.555]}]}),ht.Default.setImage("editor.reload",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.zoomout",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8]}]}),ht.Default.setImage("editor.zoomin",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8,8,2,8,14],segments:[1,2,1,2]}]}),ht.Default.setImage("editor.zoomtofit",{background:"rgb(179,179,179)",gridLightColor:"rgba(0,0,0,0.20)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.00001,11.91764,8.00001,15]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-1.5708,rect:[9.75,7.24608,2,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-1.5708,points:[13.516,6.484,13.516,9.51599]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-3.14159,points:[8.00001,.99999,8.00001,4.08236]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[2.516,6.4801,2.516,9.51209]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[4.25,7.24608,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:3.14159,rect:[7.00001,4.5,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:6.28319,rect:[7,10,2,1.5]}]}),ht.Default.setImage("editor.toggleleft",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[3.49001,5.50001,3.51001,10.49999]}]}),ht.Default.setImage("editor.toggleboth",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.toggleright",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[12.49999,5.50001,12.51999,10.49999]}]}),ht.Default.setImage("editor.display.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.display.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.display.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.display.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.display.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.display.node",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.5,9.38462,14.5,9.38462,14.5,11.23077,14.5,2,1.5,2,1.5,11.23077,14.5,11.23077,7.07143,11.23077,5,15,11,15,8.92857,11.23077]}]}),ht.Default.setImage("editor.display.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[13,12.5,13,10.54,3,10.54,13,10.54,13,5.5,3,5.5,3,12.5,13,12.5,7,12.5,5.85714,15.5,10.14287,15.5,9,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8,2.19286,15.5,2.19286,15.5,15.5]}]}),ht.Default.setImage("editor.display.edge",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[.69044,.97071,4,4.00837]},{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[11.27696,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[4.35933,3.02819,7.84441,2.9749,7.84441,12.99581,11.64067,12.99581]}]}),ht.Default.setImage("editor.display.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.display.subgraph",{gridThickColor:"rgb(191,191,191)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(207,207,207)",visible:!1,closePath:!0,points:[2.81788,9.09381,2.81788,9.09381,1.38027,6.92868,3.20223,5.43826,5.02418,3.94784,6.51488,5.43826,6.51488,5.43826,6.51488,5.43826,7.61273,3.06338,10.74281,3.94784,13.87289,4.8323,13.18212,9.09381,13.18212,9.09381,13.18212,9.09381,15.5,9.8671,15.5,11.92851,15.5,13.6866,14.14811,14.93662,13.18212,14.93662,2.81788,14.93662,1.83057,14.93662,.5,13.65558,.5,11.92851,.5,9.92221,2.81788,9.09381,2.81788,9.09381],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[4.99379,5.52777,6,4.47223]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",visible:!1,shadowColor:"#1ABC9C",rect:[4,6.43826,2,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.15905,arcTo:5.5676,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[2.5,3.11794,5,5]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.57792,arcTo:6.6497,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[5.63862,1.53868,9.36138,7.15852]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:1.5708,arcTo:3.87463,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[-1,6.56338,8.99379,5.93662]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:5.00909,arcTo:1.5708,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[8.00621,6.56338,8.99379,5.93662]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",visible:!1,points:[3.4969,12.5,12.5031,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[9.72,12.5,8,10,6.34,12.5]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",displayName:"\u5706\u5f62",rect:[0,0,2,2]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[15,15.5,8.02409,15.5,8.02409,14,8.02409,15.5,1,15.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[2.81167,6.59481,2.81167,6.59481,1.80439,4.03022,3.39379,2.90023,4.98319,1.77025,6.47379,2.90023,6.47379,2.90023,6.47379,2.90023,7.60652,.5,10.7366,1.3939,13.86668,2.28781,13.17591,6.59481,13.17591,6.59481,13.17591,6.59481,15.49379,7.37636,15.49379,9.45978,15.49379,11.23663,14.1419,12.5,13.17591,12.5,2.81167,12.5,1.82436,12.5,.49379,11.20528,.49379,9.45978,.49379,7.43206,2.81167,6.59481,2.81167,6.59481],segments:[1,4,4,4,4,4,4,2,4,4]}]}),ht.Default.setImage("editor.symbol.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.symbol.oval",{
background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.symbol.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.symbol.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.symbol.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.image",{background:"rgb(156,156,156)",width:16,height:16,comps:[{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",rect:[.5,1.96,15,12]},{type:"circle",background:"rgb(255,255,255)",borderColor:"rgb(255,255,255)",rect:[3.32103,4.48721,1.5,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[2.18757,9.112,6.11684,9.112,7.77072,10.39241,9.50807,13.68975,9.69338,14.04145,9.04982,12.34611,7.45717,10.69236,7.45717,10.69236,8.72728,5.98721,14.05092,5.98721],segments:[1,4,4,4]}]}),ht.Default.setImage("editor.symbol.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.symbol.border",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[.5,6.01503,.5,2,15.48868,2,15.5,14,.5,14,.5,10]}]}),ht.Default.setImage("editor.symbol.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.symbol.piechart",{background:"rgb(97,97,97)",width:16,height:16,comps:[{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:.5236,arcTo:4.71239,rect:[.53628,2.06928,13.08634,13.08634]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:4.71239,arcTo:.5236,rect:[2.37737,1,13.08634,13.08634]}]}),ht.Default.setImage("editor.symbol.onedimensionalcolumnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[3.42625,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[10.00543,1,3,14]}]}),ht.Default.setImage("editor.symbol.columnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[1,9,3,6]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[4,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[9,1,3,14]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[12,10.93747,3,4.06253]}]}),ht.Default.setImage("editor.symbol.linechart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[1,14,5,7,11,8,15,2]}]}),ht.Default.setImage("editor.point.mirrored",{width:30,height:30,fitSize:!1,comps:[{type:"arc",background:"rgb(202,235,248)",borderWidth:2,borderColor:"rgb(17,158,216)",arcClose:!1,rect:[3.5,10.30081203536023,23,25.3726296254234]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.300812035360231,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[17.842265898626422,9.310233818119592,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.713262902082427,8.310233818119592,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.4018068742542837,9.30081203536023,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.286737097917573,8.310233818119592,3,4]}]}),ht.Default.setImage("editor.point.straight",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[26.974999999999998,23.185840967335317,15.133692185007973,10.275109094255685,3.0250000000000004,23.185840967335317]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.561327956066684,6,6]}]}),ht.Default.setImage("editor.point.disconnected",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.1940148593724587,22.95774078992803,3.1940148593724587,18.139874123261343,7.6015038461565965,10.497740789928038,14.542032480517832,10.497740789928038,26.80598514062754,22.95774078992803],segments:[1,4,2]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12.093814401372779,7.5391087731804305,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[16.36973009802768,14.555043156001322,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[22.831111406474626,16.51363217953681,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.2671011430070465,9.53910877318043,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.152031366670336,8.548530555939791,3,4]}]}),ht.Default.setImage("editor.point.asymmetric",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.5000000000000027,22.974997694265234,3.5000000000000027,17.50768540873153,5.131816608669447,11.637417102180905,12.400695544362113,11.637417102180905,22.516641067164265,11.637417102180905,26.5,22.974997694265234,26.5,22.974997694265234],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[9.324670579660944,7.637417102180905,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[3.405482351035767,9.637417102180905,6.540642002660807,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.7221578598514142,8.637417102180905,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[15.278596259040164,9.637417102180905,11.965262549245955,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.731262324024406,8.637417102180905,3,4]}]}),ht.Default.setImage("editor.layout.circular",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,3,3,8,5,13,11,13,13,8],segments:[1,2,2,2,2,5]}]}),ht.Default.setImage("editor.layout.symmetric",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderWidth:1,borderColor:"white",points:[8,8,8,3,8,8,3,8,8,8,5,13,8,8,11,13,8,8,13,8],segments:[1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.hierarchical",{width:16,height:16,comps:[{type:"shape",background:"white",points:[4,3,4,5,6,5,6,3,10,3,10,5,12,5,12,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[5,4,2,12,5,4,8,12,5,4,14,12,11,4,2,12,11,4,8,12,11,4,14,12],segments:[1,2,1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardnorth",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,3,7,5,9,5,9,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,4,2,12,8,4,8,12,8,4,14,12],segments:[1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardsouth",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardnorth",rotation:Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardeast",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardnorth",rotation:.5*-Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardwest",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardnorth",rotation:.5*Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.align.distributehorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14,14,2,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[8,5,8,11],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.distributevertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2,2,14,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[5,8,11,8],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.alignleft",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[5,5,13,5,5,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.alignhorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[8,2,8,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[3,5,13,5,6,11,10,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.alignright",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[14,2,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[3,5,11,5,11,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.aligntop",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[5,5,5,13,11,5,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.alignvertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,8,14,8],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[5,3,5,13,11,6,11,10],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]}),ht.Default.setImage("editor.align.alignbottom",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,14,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_dark}}},{type:"shape",points:[5,3,5,11,11,11,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return hteditor.config.color_select}}}]});var _E=function(){return!0};ZS("editor.layout.circular"),ZS("editor.layout.symmetric"),ZS("editor.layout.hierarchical"),ZS("editor.layout.towardnorth"),ZS("editor.layout.towardsouth"),ZS("editor.layout.towardeast"),ZS("editor.layout.towardwest"),ZS("editor.root"),ZS("editor.bind",_E),ZS("editor.unbind"),ZS("editor.dir"),ZS("editor.dxf"),ZS("editor.sound"),ZS("editor.video"),ZS("editor.resetsize"),ZS("editor.restore"),ht.Data.prototype.$50$=SP,ht.Data.prototype.$51$=function(S){return this._refGraph?[]:[tS.call(this,S),wS]},ht.Node.prototype.$50$=pP,ht.Node.prototype.$51$=function(S){return this._refGraph?[]:[PP.call(this,S),EP]},ht.Edge.prototype.$50$=mP,ht.Edge.prototype.$51$=function(S){return this._refGraph?[]:[lP.call(this,S),_P]},ht.Group.prototype.$51$=function(S){return this._refGraph?[]:[uP.call(this,S),FP]},ht.Shape.prototype.$51$=function(S){return this._refGraph?[]:[fP.call(this,S),HP]},ht.Block.prototype.$51$=function(S){return this._refGraph?[]:[TP.call(this,S),XP]},ht.RefGraph.prototype.$51$=function(S){return this._refGraph?[]:[WP.call(this,S),hP]};var mE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype."+this.s("shape").toLowerCase())},P.prototype.parse=function(S,P,E){S&&(jS(this,"shape",S.type,"rect"),jS(this,"shape.background",S.background,null),jS(this,"shape.repeat.image",S.repeatImage),jS(this,"shape.border.width",S.borderWidth),jS(this,"shape.border.color",S.borderColor,null),jS(this,"shape.border.3d",S.border3d),jS(this,"shape.border.3d.color",S.border3dColor),jS(this,"shape.border.3d.accuracy",S.border3dAccuracy),jS(this,"shape.border.cap",S.borderCap),jS(this,"shape.border.join",S.borderJoin),jS(this,"shape.border.pattern",S.borderPattern),jS(this,"shape.gradient",S.gradient),jS(this,"shape.gradient.color",S.gradientColor),jS(this,"shape.dash",S.dash),jS(this,"shape.dash.pattern",S.dashPattern),jS(this,"shape.dash.offset",S.dashOffset),jS(this,"shape.dash.color",S.dashColor),jS(this,"shape.dash.width",S.dashWidth),jS(this,"shape.dash.3d",S.dash3d),jS(this,"shape.dash.3d.color",S.dash3dColor),jS(this,"shape.dash.3d.accuracy",S.dash3dAccuracy),jS(this,"shape.border.width.absolute",S.borderWidthAbsolute),jS(this,"shape.fill.clip.direction",S.fillClipDiretion),jS(this,"shape.fill.clip.percentage",S.fillClipPercentage),"rect"===this.compType?jS(this,"shape.depth",S.depth):"roundRect"===this.compType?jS(this,"shape.corner.radius",S.cornerRadius):"polygon"===this.compType?jS(this,"shape.polygon.side",S.polygonSide):"arc"===this.compType&&(jS(this,"shape.arc.from",S.arcFrom),jS(this,"shape.arc.to",S.arcTo),jS(this,"shape.arc.close",S.arcClose),jS(this,"shape.arc.oval",S.arcOval)),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"shape","type",void 0),sS(this,S,"shape.background","background",null),sS(this,S,"shape.repeat.image","repeatImage"),sS(this,S,"shape.border.width","borderWidth"),sS(this,S,"shape.border.color","borderColor",null),sS(this,S,"shape.border.3d","border3d"),sS(this,S,"shape.border.3d.color","border3dColor"),sS(this,S,"shape.border.3d.accuracy","border3dAccuracy"),sS(this,S,"shape.border.cap","borderCap"),sS(this,S,"shape.border.join","borderJoin"),sS(this,S,"shape.border.pattern","borderPattern"),sS(this,S,"shape.gradient","gradient"),sS(this,S,"shape.gradient.color","gradientColor"),sS(this,S,"shape.dash","dash"),sS(this,S,"shape.dash.pattern","dashPattern"),sS(this,S,"shape.dash.offset","dashOffset"),sS(this,S,"shape.dash.color","dashColor"),sS(this,S,"shape.dash.width","dashWidth"),sS(this,S,"shape.dash.3d","dash3d"),sS(this,S,"shape.dash.3d.color","dash3dColor"),sS(this,S,"shape.dash.3d.accuracy","dash3dAccuracy"),sS(this,S,"shape.border.width.absolute","borderWidthAbsolute"),sS(this,S,"shape.fill.clip.direction","fillClipDirection"),sS(this,S,"shape.fill.clip.percentage","fillClipPercentage"),"rect"===this.compType?sS(this,S,"shape.depth","depth"):"roundRect"===this.compType?sS(this,S,"shape.corner.radius","cornerRadius"):"polygon"===this.compType?sS(this,S,"shape.polygon.side","polygonSide"):"arc"===this.compType&&(sS(this,S,"shape.arc.from","arcFrom"),sS(this,S,"shape.arc.to","arcTo"),sS(this,S,"shape.arc.close","arcClose"),sS(this,S,"shape.arc.oval","arcOval")),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("shape")}}]),P}(ht.Node),uE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.shape")},P.prototype.parse=function(S,P,E){S&&(jS(this,"type",S.type,"shape"),jS(this,"shape.background",S.background,null),jS(this,"shape.repeat.image",S.repeatImage),jS(this,"shape.border.width",S.borderWidth),jS(this,"shape.border.color",S.borderColor,null),jS(this,"shape.border.3d",S.border3d),jS(this,"shape.border.3d.color",S.border3dColor),jS(this,"shape.border.3d.accuracy",S.border3dAccuracy),jS(this,"shape.border.cap",S.borderCap),jS(this,"shape.border.join",S.borderJoin),jS(this,"shape.border.pattern",S.borderPattern),jS(this,"shape.gradient",S.gradient),jS(this,"shape.gradient.color",S.gradientColor),jS(this,"shape.dash",S.dash),jS(this,"shape.dash.pattern",S.dashPattern),jS(this,"shape.dash.offset",S.dashOffset),jS(this,"shape.dash.color",S.dashColor),jS(this,"shape.dash.width",S.dashWidth),jS(this,"shape.dash.3d",S.dash3d),jS(this,"shape.dash.3d.color",S.dash3dColor),jS(this,"shape.dash.3d.accuracy",S.dash3dAccuracy),jS(this,"shape.fill.rule",S.fillRule),jS(this,"shape.fill.clip.direction",S.fillClipDiretion),jS(this,"shape.fill.clip.percentage",S.fillClipPercentage),jS(this,"shape.gradient.pack",S.gradientPack),jS(this,"shape.border.width.absolute",S.borderWidthAbsolute),MS(this,S,P,E),RS(this,S),this.setPoints(vS(JS(S.points))),this.setSegments(JS(S.segments)))},P.prototype.toJSON=function(){var S={};if(sS(this,S,"type","type",void 0),sS(this,S,"shape.background","background",null),sS(this,S,"shape.repeat.image","repeatImage"),sS(this,S,"shape.border.width","borderWidth"),sS(this,S,"shape.border.color","borderColor",null),sS(this,S,"shape.border.3d","border3d"),sS(this,S,"shape.border.3d.color","border3dColor"),sS(this,S,"shape.border.3d.accuracy","border3dAccuracy"),sS(this,S,"shape.border.cap","borderCap"),sS(this,S,"shape.border.join","borderJoin"),sS(this,S,"shape.border.pattern","borderPattern"),sS(this,S,"shape.gradient","gradient"),sS(this,S,"shape.gradient.color","gradientColor"),sS(this,S,"shape.dash","dash"),sS(this,S,"shape.dash.pattern","dashPattern"),sS(this,S,"shape.dash.offset","dashOffset"),sS(this,S,"shape.dash.color","dashColor"),sS(this,S,"shape.dash.width","dashWidth"),sS(this,S,"shape.dash.3d","dash3d"),sS(this,S,"shape.dash.3d.color","dash3dColor"),sS(this,S,"shape.dash.3d.accuracy","dash3dAccuracy"),sS(this,S,"shape.fill.rule","fillRule"),sS(this,S,"shape.fill.clip.direction","fillClipDirection"),sS(this,S,"shape.fill.clip.percentage","fillClipPercentage"),sS(this,S,"shape.gradient.pack","gradientPack"),sS(this,S,"shape.border.width.absolute","borderWidthAbsolute"),bS(this,S),aS(this,S),xS(S,"points",this.a("points"),BS(this.getPoints())),this.getSegments()){var P=this.getSegments().toArray();if(P.length){var E=1===P[0];if(E)for(var p=1;p<P.length;p++)if(2!==P[p]){E=!1;break}E||xS(S,"segments",this.a("segments"),P)}}return S},vP(P,[{key:"compType",get:function(){return this.s("type")}}]),P}(ht.Shape),FE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){if(this.getDisplayName())return this.getDisplayName();var S=this.s("image");return S&&S.length<100?S:l("editor.comptype.image")},P.prototype.onStyleChanged=function(P,E,p){S.prototype.onStyleChanged.call(this,P,E,p),"image"===P&&this.setImage(p)},P.prototype.parse=function(S,P,E){S&&(jS(this,"type",S.type,"image"),jS(this,"body.color",S.color),jS(this,"image.stretch",S.stretch),jS(this,"image",S.name,"node_image"),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"type","type",void 0),sS(this,S,"body.color","color"),sS(this,S,"image.stretch","stretch"),sS(this,S,"image","name"),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("type")}}]),P}(ht.Node),fE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||this.s("text")||l("editor.comptype.text")},P.prototype.parse=function(S,P,E){S&&(jS(this,"type",S.type,"text"),jS(this,"text",S.text),jS(this,"text.align",S.align),jS(this,"text.vAlign",S.vAlign),jS(this,"text.color",S.color),jS(this,"text.font",S.font),jS(this,"text.shadow",S.shadow),jS(this,"text.shadow.color",S.shadowColor),jS(this,"text.shadow.blur",S.shadowBlur),jS(this,"text.shadow.offset.x",S.shadowOffsetX),jS(this,"text.shadow.offset.y",S.shadowOffsetY),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"type","type",void 0),sS(this,S,"text","text"),sS(this,S,"text.align","align"),sS(this,S,"text.vAlign","vAlign"),sS(this,S,"text.color","color"),sS(this,S,"text.font","font"),sS(this,S,"text.shadow","shadow"),sS(this,S,"text.shadow.color","shadowColor"),sS(this,S,"text.shadow.blur","shadowBlur"),sS(this,S,"text.shadow.offset.x","shadowOffsetX"),sS(this,S,"text.shadow.offset.y","shadowOffsetY"),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("type")}}]),P}(ht.Text),HE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.s({"shape.border.color":"red","shape.border.width":1,"shape.background":null}),_.parse(E,p,l),_.setClosePath(!0),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.clip")},P.prototype.parse=function(S,P,E){S&&(jS(this,"type",S.type,"clip"),MS(this,S,P,E),this.setPoints(vS(JS(S.points))),this.setSegments(JS(S.segments)))},P.prototype.toJSON=function(){var S={};if(sS(this,S,"type","type",void 0),bS(this,S),xS(S,"points",this.a("points"),BS(this.getPoints())),this.getSegments()){var P=this.getSegments().toArray();if(P.length){var E=1===P[0];if(E)for(var p=1;p<P.length;p++)if(2!==P[p]){E=!1;break}E||xS(S,"segments",this.a("segments"),P)}}return S},vP(P,[{key:"compType",get:function(){return this.s("type")}}]),P}(ht.Shape),TE=function(S){function P(E,p,l){return $P(this,P),KP(this,S.call(this))}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.restore")},P.prototype.parse=function(S,P,E){S&&(jS(this,"type",S.type,"restore"),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"type","type",void 0),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("type")}}]),P}(ht.Node),XE=function(S){function P(){return $P(this,P),KP(this,S.call(this))}return BP(P,S),P}(ht.widget.BorderPane),WE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P}(ht.widget.ContextMenu),hE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P.prototype.invalidateAll=function(P,E){if("imageLoading"!==E)return"imageLoaded"===E?(this.fpImageLoaded=!0,this.dm().each(function(S){S.fp("imageLoaded",!1,!0)}),void(this.fpImageLoaded=!1)):void S.prototype.invalidateAll.call(this,P,E)},P.prototype.adjustZoom=function(S){return S>rP.config.maxZoom?rP.config.maxZoom:S<rP.config.minZoom?rP.config.minZoom:S},P.prototype.getUnionNodeRect=function(S){var P=this,E=void 0;return S=S._as||S,S.forEach(function(S){S instanceof ht.Node&&(E=Z(E,P.getNodeRect(S)))}),E},P.prototype.$64$=function(S){this.validate();var P=this.getViewRect(),E=this.getUnionNodeRect(S);if(!P||!E||ht.Default.intersectsRect(P,E))return null;var p=P.x+P.width/2-E.x-E.width/2,l=P.y+P.height/2-E.y-E.height/2;return this.moveDatas(S,p,l),{x:p,y:l}},P}(ht.graph.GraphView),QE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P}(ht.widget.ListView),iE=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this,E));return p.getView().style.background=rP.config.color_pane_dark,p.setMaskBackground(null),p.setContentBorderColor(null),p.setContentBackground("white"),p.getMask().style.border=rP.config.color_select+" solid 1px",p}return BP(P,S),P}(ht.graph.Overview),aE=function(S){function P(E,p,l,_){$P(this,P);var m=KP(this,S.call(this,E,p,l,_));return m.setTogglable(!1),m}return BP(P,S),P}(ht.widget.SplitView),sE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P}(ht.widget.TablePane),kE=function(S){function P(){return $P(this,P),KP(this,S.call(this))}return BP(P,S),P.prototype.addTab=function(S,P,E){var p=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=new ht.Tab;return l.setName(S),l.setView(P),p&&(this.getTabModel().add(l),E&&this.getTabModel().sm().ss(l)),l},P}(ht.widget.TabView),YE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P}(ht.widget.Toolbar),xE=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this,E));return p.setDoubleClickToToggle(!1),p}return BP(P,S),P.prototype.getToggleIcon=function(S){if(this._loader&&!this._loader.isLoaded(S))return this._collapseIcon;var P=S.getChildren(),E=P.size();if(E){for(var p=!1,l=0;l<E;l++)if(this.isVisible(P.get(l))){p=!0;break}if(p)return this.isExpanded(S)?this._expandIcon:this._collapseIcon}},P.prototype.hasExpandedChild=function(S){if(!this.isExpanded(S))return!1;var P=S.getChildren(),E=P.size();if(E)for(var p=0;p<E;p++)if(this.isVisible(P.get(p)))return!0;return!1},vP(P,[{key:"expandIds",get:function(){return Object.keys(this._expandMap)},set:function(S){var P=this;S.forEach(function(S){var E=P.dm().getDataById(S);E&&P.expand(E)})}},{key:"selectionIds",get:function(){var S=[];return this.sm().each(function(P){S.push(P.$34$||P._id)}),S},set:function(S){var P=this,E=[];S.forEach(function(S){var p=P.dm().getDataById(S);p&&E.push(p)}),this.sm().ss(E)}}]),P}(ht.widget.TreeView);!function(S,P,E){var p=S.ht,l=p.Default;l.getInternal().addMethod(l,{svgToShape:function(S,P){var E=new p.SvgConverter(P);return{converter:E,output:E.toShape(S)}}});var _=p.Context2dProxy=function(S,P,E){var p=this;p.ctx=S,p.writer=P,p._currentContext={a:1,b:0,c:0,d:1,tx:0,ty:0},p._emptyPath(),p._forceSplitEllipse=!0,p._ellipseSegments=E.segments,p._contextStack=[];for(var l in CanvasRenderingContext2D.prototype)if("webkitImageSmoothingEnabled"!==l){var _=S[l];"function"==typeof _&&(S[l]=function(P,E){return function(){try{var l=E.apply(S,arguments);return p.handleFunc(P,l,arguments),l}catch(S){}}}(l,_))}};_.prototype={},_.prototype.constructor=_,_.prototype.handleFunc=function(S,P,E){var p=this;switch(S){case"save":p._ctxSave();break;case"restore":p._ctxRestore();break;case"translate":p._ctxTranslate.apply(p,E);break;case"rotate":p._ctxRotate.apply(p,E);break;case"scale":p._ctxScale.apply(p,E);break;case"setTransform":p._ctxSetTransform.apply(p,E);break;case"transform":p._ctxTransform.apply(p,E);break;case"fillText":case"strokeText":p._ctxText(E[0],E[1],E[2],"fillText"===S);break;case"rect":p._ctxRect.apply(p,E);break;case"fill":p._ctxFill(E[0]);break;case"fillRect":p._ctxRect.apply(p,E),p._ctxDraw("fill");break;case"stroke":p._ctxDraw("stroke");break;case"moveTo":p._ctxMoveTo(E[0],E[1]);break;case"lineTo":p._ctxLineTo(E[0],E[1]);break;case"beginPath":p._ctxBeginPath();break;case"closePath":p._ctxClosePath();break;case"arc":p._ctxArc.apply(p,E);break;case"ellipse":p._ctxEllipse.apply(p,E);break;case"quadraticCurveTo":p._ctxBezier([{x:E[0],y:E[1]}],E[2],E[3]);break;case"bezierCurveTo":p._ctxBezier([{x:E[0],y:E[1]},{x:E[2],y:E[3]}],E[4],E[5]);break;case"createLinearGradient":p._ctxCreateGradient(P,!0,E);break;case"createRadialGradient":p._ctxCreateGradient(P,!1,E);break;case"createPattern":p._ctxCreatePattern(P,E[0],E[1]);break;case"drawImage":p._ctxDrawImage.apply(p,E);break;case"clip":p._ctxClip()}},_.prototype.handleSetter=function(S,P){},_.prototype._ctxSave=function(){var S=this,P={},E=S._currentContext;for(var p in E)P[p]=E[p],"clip"===p&&E[p]&&delete E[p];S._contextStack.push(P)},_.prototype._ctxRestore=function(){var S=this;S._currentContext.clip&&S.writer.addRestore(),S._currentContext=S._contextStack.pop(),S._transformUpdated()},_.prototype._ctxTranslate=function(S,P){if(S=S||0,P=P||0,0!==S||0!==P){var E=this,p=E._currentContext,l=p.a,_=p.b,m=p.c,u=p.d;p.tx=l*S+m*P+p.tx,p.ty=_*S+u*P+p.ty,E._transformUpdated()}},_.prototype._ctxScale=function(S,P){if(S=S||1,P=P||1,1!==S||1!==P){var E=this,p=E._currentContext;p.a*=S,p.b*=S,p.c*=P,p.d*=P,E._transformUpdated()}},_.prototype._ctxRotate=function(S){var P=Math.cos(S),E=Math.sin(S),p=this,l=p._currentContext,_=l.a,m=l.b,u=l.c,F=l.d;l.a=_*P+u*E,l.b=m*P+F*E,l.c=-_*E+u*P,l.d=-m*E+F*P,p._transformUpdated()},_.prototype._ctxSetTransform=function(S,P,E,p,l,_){var m=this,u=m._currentContext;u.a=S,u.b=P,u.c=E,u.d=p,u.tx=l,u.ty=_,m._transformUpdated()},_.prototype._ctxTransform=function(S,P,E,p,l,_){var m=this,u=m._currentContext,F=u.a,f=u.b,H=u.c,T=u.d;u.a=F*S+H*P,u.b=f*S+T*P,u.c=F*E+H*p,u.d=f*E+T*p,u.tx=F*l+H*_+u.tx,u.ty=f*l+T*_+u.ty,m._transformUpdated()},_.prototype._transformUpdated=function(){},_.prototype._calcCurrentRotation=function(){var S=this._currentContext;return 0===S.b&&0===S.c?0:Math.atan2(S.b,S.a)},_.prototype._calcCurrentScale=function(){var S=this._currentContext;return{x:Math.sqrt(S.a*S.a+S.c*S.c),y:Math.sqrt(S.b*S.b+S.d*S.d)}},_.prototype._transformPoint=function(S){var P=this._currentContext,E=S.x,p=S.y;return{x:P.a*E+P.c*p+P.tx,y:P.b*E+P.d*p+P.ty}},_.prototype._transformPoints=function(S){for(var P=this,E=new Array(S.length),p=0,l=S.length;p<l;p++)E[p]=P._transformPoint(S[p]);return E},_.prototype._transformSize=function(S){var P=this._currentContext;return S*Math.max(Math.sqrt(P.c*P.c+P.d*P.d),Math.sqrt(P.a*P.a+P.b*P.b))},_.prototype._equal=function(S,P){var E=S-P;return E>-1e-5&&E<1e-5},_.prototype._ctxText=function(S,P,E,p){var l,_,m=this,u=m.ctx,F=u.font,f=p?u.fillStyle:u.strokeStyle,H=u.textAlign,T=u.textBaseline;"string"==typeof F&&(_=F.match(/\d+/))&&(l=_[0],F=F.replace(/\d+/,m._transformSize(l)));var X=m._calcCurrentRotation();"alphabetic"===T?(T="bottom",E+=.25*u.measureText("e").width):"hanging"===T&&(T="top",E+=.2*u.measureText("e").width),"string"==typeof f&&"rgba(0,0,0,0)"===f.replace(/ /g,"")||S.trim().length&&m.writer.addText(S,m._transformPoint({x:P,y:E}),F,X,H,T,f)},_.prototype._ctxDrawImage=function(S,P,E,p,l,_,m,u,F){if(S.width&&S.height){void 0===p&&void 0===l?(_=P,m=E,P=0,E=0,p=u=S.width,l=F=S.height):void 0===_&&void 0===m&&(_=P,m=E,u=p,F=l,P=0,E=0,p=S.width,l=S.height);var f=this,H=f._currentContext,T=u/p,X=F/l,W=_-T*P,h=m-X*E,Q=H.a,i=H.b,a=H.c,s=H.d;H.tx,H.ty}},_.prototype._ctxClip=function(){var S=this;S._currentContext.clip=!0,
S._ctxDraw("clip")},_.prototype._ctxCreateGradient=function(S,P,E){S.isLinear=P,S.points=P?[E[0],E[1],E[2],E[3]]:[E[0],E[1],E[2],E[3],E[4],E[5]];var p=this._currentContext;S.trans=[p.a,p.b,p.c,p.d,p.tx,p.ty];var l=S.addColorStop;S.addColorStop=function(P,E){l.apply(this,arguments),S.colorStops||(S.colorStops=[]),S.colorStops.push(P,E)}},_.prototype._ctxCreatePattern=function(S,P,E){console.log("create pattern")},_.prototype._ctxRect=function(S,P,E,p){var l=this,_=l._transformPoints([{x:S,y:P},{x:S+E,y:P},{x:S+E,y:P+p},{x:S,y:P+p}]);l._path.push({type:"rect",points:_})},_.prototype._ctxMoveTo=function(S,P){var E=this,p=E._transformPoint({x:S,y:P});E._headPoint=p,E._path.push({type:"moveTo",x:p.x,y:p.y})},_.prototype._ctxLineTo=function(S,P){var E=this,p=E._transformPoint({x:S,y:P});E._path.push({type:"lineTo",x:p.x,y:p.y})},_.prototype._ctxArc=function(S,P,E,p,l,_){p=p||0,l=l||2*Math.PI,E&&this._ctxEllipse(S,P,E,E,0,p,l,_)},_.prototype._ctxEllipse=function(S,P,E,p,l,_,m,u){var F,f,H,T,X,W,h,Q,i,a,s,k,Y,x,M=this,b=M._calcCurrentScale(),j=M._transformPoint({x:S,y:P});X=Math.sin(l),W=Math.cos(l);var z=function(l){var _=E*Math.cos(-l),m=p*Math.sin(-l);return M._transformPoint({x:S+(W*_-X*m),y:P+(X*_+W*m)})},c=[],V=m;if(u)for(;V>=_;)V-=2*Math.PI;else for(;V<=_;)V+=2*Math.PI;for(i=(V-_)/M._ellipseSegments,s=0;s<=M._ellipseSegments;s++)a=_+i*s,k=z(-a),c.push(k);if(c[0],T=c[c.length-1],F=M._calcaEllipseAngle(_,m,u),_=F.start,m=F.end,h=M._equal(b.x,b.y),Q=M._equal(E,p),!M._forceSplitEllipse&&h&&Q&&M._equal(Math.abs(_-m),2*Math.PI))M._path.push({type:"circle",x:j.x,y:j.y,end:T,keyPoints:c,radius:E*b.x});else if(!M._forceSplitEllipse&&h&&Q)f=M._calcCurrentRotation(),H=Math.cos(f),Y=M._currentContext.a*H<0,x=M._currentContext.d*H<0,F=M._transformStartEndAngle(_,m,Y,x),_=F.start-f,m=F.end-f,M._path.push({type:"arc",x:j.x,y:j.y,end:T,radius:E*b.x,startAngle:_,endAngle:m,keyPoints:c});else{if(M._forceSplitEllipse||!h){for(M._path.length||M._path.push({type:"moveTo",x:c[0].x,y:c[0].y}),s=1;s<=M._ellipseSegments;s++)k=c[s],M._path.push({type:"lineTo",x:k.x,y:k.y});return}var g,R,G=z(0),J=z(Math.PI/2),$=function(S,P){var E=S.x-P.x,p=S.y-P.y;return Math.sqrt(E*E+p*p)},v=$(G,j),B=$(J,j);B>v?(R=v,v=B,B=R,g=J):g=G,f=M._calcCurrentRotation(),H=Math.cos(f),Y=M._currentContext.a*H<0,x=M._currentContext.d*H<0,F=M._transformStartEndAngle(_-Math.PI/2,m-Math.PI/2,Y,x),_=F.start,m=F.end,M._path.push({type:"ellipse",x:j.x,y:j.y,end:T,major:{x:g.x-j.x,y:g.y-j.y},ratio:B/v,startAngle:_,endAngle:m,keyPoints:c})}},_.prototype._ctxBezier=function(S,P,E){var p=this,l=p._transformPoint({x:P,y:E});this._path.push({type:"bezier",x:l.x,y:l.y,ctrl:p._transformPoints(S)})},_.prototype._ctxBeginPath=function(){this._emptyPath()},_.prototype._ctxClosePath=function(){var S=this,P=S._headPoint;P&&(S._path.push({type:"lineTo",x:P.x,y:P.y,subType:"closePath"}),S._headPoint=null,S._lastPoint=null)},_.prototype._calcaEllipseAngle=function(S,P,E){S=-S,P=-P;var p,l=S%(2*Math.PI),_=P%(2*Math.PI);for(l<0&&(l+=2*Math.PI),_<0&&(_+=2*Math.PI),E||(p=l,l=_,_=p);_<=l;)_+=2*Math.PI;return{start:l,end:_}},_.prototype._transformStartEndAngle=function(S,P,E,p){var l;return(p||E)&&(E&&p?(S=Math.PI+S,P=Math.PI+P):(l=Math.PI*(E?1:2)-P,P=Math.PI*(E?1:2)-S,S=l)),{start:S,end:P}},_.prototype._ctxFill=function(S){var P=this;return P._fillRule=S||"nonzero",P._ctxDraw("fill")},_.prototype._ctxDraw=function(S){var P=this,E=P._path;if(E.length){var p,l,_,m,u,F=[],f=[];if("clip"===S)u={clip:!0};else{if("stroke"===S){u={stroke:!0,lineWidth:P._transformSize(P.ctx.lineWidth),color:P.ctx.strokeStyle};var H=P.ctx.lineCap;"butt"!==H&&(u.lineCap=H);var T=P.ctx.getLineDash();if(T&&T.length){u.dash=!0;for(var X=0,W=T.length;X<W;X++)T[X]=P._transformSize(T[X]);u.dashPattern=T,u.dashOffset=P._transformSize(P.ctx.lineDashOffset)}}else u={stroke:!1,color:P.ctx.fillStyle},"nonzero"!==P._fillRule&&(u.fillRule=P._fillRule);if(P.ctx.globalAlpha<1&&(u.opacity=P.ctx.globalAlpha),"string"!=typeof u.color)if(u.color instanceof CanvasGradient){var h=u.color,Q=[h.isLinear?"L":"R"];Q=Q.concat(h.points),Q=Q.concat(h.trans),Q=Q.concat(h.colorStops),u.gradientPack=Q}else if(u.color instanceof CanvasPattern&&u.color.gradient){var _=u.color,h=_.gradient,Q=[h.isLinear?"L":"R"];Q=Q.concat(h.points);var i=_.trans,a=h.trans[0],s=h.trans[1],k=h.trans[2],Y=h.trans[3],x=h.trans[4],M=h.trans[5],b=i[0],j=i[1],z=i[2],c=i[3],V=i[4],g=i[5];Q=Q.concat([a*b+k*j,s*b+Y*j,a*z+k*c,s*z+Y*c,a*V+k*g+x,s*V+Y*g+M]),Q=Q.concat(h.colorStops),u.gradientPack=Q}else u.trans=[P._currentContext.a,P._currentContext.b,P._currentContext.c,P._currentContext.d,P._currentContext.tx,P._currentContext.ty],u.color=u.color.image?u.color.image:u.color,u.isPattern=!0;if("string"==typeof u.color&&"rgba(0,0,0,0)"===u.color.replace(/ /g,""))return}for(l=0,p=E.length;l<p;l++)switch(_=E[l],_.type){case"moveTo":P._lastPoint={x:_.x,y:_.y},F.push(P._lastPoint),f.push(1);break;case"lineTo":F.push({x:_.x,y:_.y}),f.push(2),P._lastPoint={x:_.x,y:_.y};break;case"rect":m=_.points,F.push({x:m[0].x,y:m[0].y},{x:m[1].x,y:m[1].y},{x:m[2].x,y:m[2].y},{x:m[3].x,y:m[3].y},{x:m[0].x,y:m[0].y}),f.push(2,2,2,2,2),P._lastPoint=_.points[0];break;case"circle":case"arc":case"ellipse":console.log("split to line",_.type);break;case"arcBegin":F.length&&f.length&&P.writer.addShape(F,f,u),F=[],f=[];break;case"arcClose":P.writer.addShape(F,f,u),F=[],f=[];break;case"bezier":if(!P._lastPoint)break;1===_.ctrl.length?(F.push({x:_.ctrl[0].x,y:_.ctrl[0].y},{x:_.x,y:_.y}),f.push(3)):(F.push({x:_.ctrl[0].x,y:_.ctrl[0].y},{x:_.ctrl[1].x,y:_.ctrl[1].y},{x:_.x,y:_.y}),f.push(4)),P._lastPoint={x:_.x,y:_.y};break;default:F.push({x:_.x,y:_.y}),f.push(2)}P.writer.addShape(F,f,u)}},_.prototype._emptyPath=function(){var S=this;S._path=[],S._lastPoint=null,S._headPoint=null};var m=p.SvgConverter=function(S){var P=this;P.initConfig(S||{}),P.initCanvas()};m.prototype={},m.prototype.constructor=m,m.prototype.initConfig=function(S){var P,E=this;P=E.options={},P.size=S.size||512,P.segments=S.segments||16},m.prototype.initCanvas=function(){var S=this,P=document.createElement("canvas");P.width=P.height=S.options.size,P.style.width=P.style.height=S.options.size;var E=P.getContext;P.getContext=function(P){return function(E){var p=P.apply(this,arguments);return"2d"===E&&S.wrapContext2d(p),p}}(E),S._canvas=P,S._segments=[]},m.prototype.toShape=function(S){var P=this;P._canvas;return P._segments=[],canvg(P._canvas,S,{ignoreMouse:!0,ignoreAnimation:!0}),P.write()},m.prototype.wrapContext2d=function(S){var P=this;return new p.Context2dProxy(S,P,P.options)},m.prototype.write=function(){var S=this;return{width:S._canvas.width,height:S._canvas.height,comps:S._segments}},m.prototype.addComponent=function(S){this._segments.push(S)},m.prototype.addText=function(S,P,E,p,l,_,m){l=l||"left","start"===l?l="left":"end"===l&&(l="right"),"alphabetic"===_?_="bottom":"hanging"===_&&(_="top"),this.addComponent({type:"text",color:m,text:S,rotation:p,rect:[P.x,P.y,0,0],align:l,vAlign:_,font:E})},m.prototype.addShape=function(S,P,E){for(var p=this,l=[],_=0,m=S.length;_<m;_++){var u=S[_];l.push(u.x,u.y)}if(E.clip)return void p.addComponent({type:"clip",points:l,segments:P});var F={type:"shape",points:l,segments:P};void 0!=E.opacity&&(F.opacity=E.opacity),E.stroke?(E.dash?(F.dash=E.dash,F.dashPattern=E.dashPattern,F.dashOffset=E.dashOffset,F.dashColor=E.color,F.dashWidth=E.lineWidth,F.borderColor=null,F.borderWidth=0,F.background=null):(F.borderColor=E.color,F.borderWidth=E.lineWidth,F.background=null),E.lineCap&&(F.borderCap=E.lineCap)):(F.borderColor=null,F.borderWidth=0,E.isPattern?(F.repeatImage=E.color,F.trans=E.trans,F.background=null):E.gradientPack?(F.gradientPack=E.gradientPack,F.background=null):F.background=E.color,E.gradient&&(F.gradient=E.gradient,F.gradientColor=E.gradientColor),E.fillRule&&(F.fillRule=E.fillRule)),p.addComponent(F)},m.prototype.addRestore=function(){this.addComponent({type:"restore"})},function(S){function P(S){this.ok=!1,"#"==S.charAt(0)&&(S=S.substr(1,6)),S=S.replace(/ /g,""),S=S.toLowerCase();var E={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var p in E)S==p&&(S=E[p]);for(var l=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(S){return[parseInt(S[1]),parseInt(S[2]),parseInt(S[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(S){return[parseInt(S[1],16),parseInt(S[2],16),parseInt(S[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(S){return[parseInt(S[1]+S[1],16),parseInt(S[2]+S[2],16),parseInt(S[3]+S[3],16)]}}],_=0;_<l.length;_++){var m=l[_].re,u=l[_].process,F=m.exec(S);if(F){var f=u(F);this.r=f[0],this.g=f[1],this.b=f[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var S=this.r.toString(16),P=this.g.toString(16),E=this.b.toString(16);return 1==S.length&&(S="0"+S),1==P.length&&(P="0"+P),1==E.length&&(E="0"+E),"#"+S+P+E},this.getHelpXML=function(){for(var S=new Array,p=0;p<l.length;p++)for(var _=l[p].example,m=0;m<_.length;m++)S[S.length]=_[m];for(var u in E)S[S.length]=u;var F=document.createElement("ul");F.setAttribute("id","rgbcolor-examples");for(var p=0;p<S.length;p++)try{var f=document.createElement("li"),H=new P(S[p]),T=document.createElement("div");T.style.cssText="margin: 3px; border: 1px solid black; background:"+H.toHex()+"; color:"+H.toHex(),T.appendChild(document.createTextNode("test"));var X=document.createTextNode(" "+S[p]+" -> "+H.toRGB()+" -> "+H.toHex());f.appendChild(T),f.appendChild(X),F.appendChild(f)}catch(S){}return F}}"undefined"!=typeof define&&define.amd?define(function(){return P}):"undefined"!=typeof module&&module.exports&&(module.exports=P),S.RGBColor=P}(void 0!==S?S:this),function(S){function P(S){for(var P=S.data,E=S.width*S.height*4,p=0;p<E;p+=4){var l=P[p+3]/255;P[p]*=l,P[p+1]*=l,P[p+2]*=l}}function E(S){for(var P=S.data,E=S.width*S.height*4,p=0;p<E;p+=4){var l=P[p+3];0!=l&&(l=255/l,P[p]*=l,P[p+1]*=l,P[p+2]*=l)}}function p(S,P,E,p){var m=document.getElementById(S),u=m.naturalWidth,F=m.naturalHeight,f=document.getElementById(P);f.style.width=u+"px",f.style.height=F+"px",f.width=u,f.height=F;var H=f.getContext("2d");H.clearRect(0,0,u,F),H.drawImage(m,0,0),isNaN(E)||E<1||(p?l(P,0,0,u,F,E):_(P,0,0,u,F,E))}function l(S,p,l,_,f,H){if(!(isNaN(H)||H<1)){H|=0;var T,X=document.getElementById(S),W=X.getContext("2d");try{try{T=W.getImageData(p,l,_,f)}catch(S){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),T=W.getImageData(p,l,_,f)}catch(S){throw alert("Cannot access local image"),new Error("unable to access local image data: "+S)}}}catch(S){throw alert("Cannot access image"),new Error("unable to access image data: "+S)}P(T);var h,Q,i,a,s,k,Y,x,M,b,j,z,c,V,g,R,G,J,$,v,B,K,L,e,r=T.data,q=H+H+1,O=_-1,d=f-1,A=H+1,N=A*(A+1)/2,Z=new m,C=Z;for(i=1;i<q;i++)if(C=C.next=new m,i==A)var o=C;C.next=Z;var D=null,y=null;Y=k=0;var I=u[H],n=F[H];for(Q=0;Q<f;Q++){for(R=G=J=$=x=M=b=j=0,z=A*(v=r[k]),c=A*(B=r[k+1]),V=A*(K=r[k+2]),g=A*(L=r[k+3]),x+=N*v,M+=N*B,b+=N*K,j+=N*L,C=Z,i=0;i<A;i++)C.r=v,C.g=B,C.b=K,C.a=L,C=C.next;for(i=1;i<A;i++)a=k+((O<i?O:i)<<2),x+=(C.r=v=r[a])*(e=A-i),M+=(C.g=B=r[a+1])*e,b+=(C.b=K=r[a+2])*e,j+=(C.a=L=r[a+3])*e,R+=v,G+=B,J+=K,$+=L,C=C.next;for(D=Z,y=o,h=0;h<_;h++)r[k]=x*I>>n,r[k+1]=M*I>>n,r[k+2]=b*I>>n,r[k+3]=j*I>>n,x-=z,M-=c,b-=V,j-=g,z-=D.r,c-=D.g,V-=D.b,g-=D.a,a=Y+((a=h+H+1)<O?a:O)<<2,R+=D.r=r[a],G+=D.g=r[a+1],J+=D.b=r[a+2],$+=D.a=r[a+3],x+=R,M+=G,b+=J,j+=$,D=D.next,z+=v=y.r,c+=B=y.g,V+=K=y.b,g+=L=y.a,R-=v,G-=B,J-=K,$-=L,y=y.next,k+=4;Y+=_}for(h=0;h<_;h++){for(G=J=$=R=M=b=j=x=0,k=h<<2,z=A*(v=r[k]),c=A*(B=r[k+1]),V=A*(K=r[k+2]),g=A*(L=r[k+3]),x+=N*v,M+=N*B,b+=N*K,j+=N*L,C=Z,i=0;i<A;i++)C.r=v,C.g=B,C.b=K,C.a=L,C=C.next;for(s=_,i=1;i<=H;i++)k=s+h<<2,x+=(C.r=v=r[k])*(e=A-i),M+=(C.g=B=r[k+1])*e,b+=(C.b=K=r[k+2])*e,j+=(C.a=L=r[k+3])*e,R+=v,G+=B,J+=K,$+=L,C=C.next,i<d&&(s+=_);for(k=h,D=Z,y=o,Q=0;Q<f;Q++)a=k<<2,r[a]=x*I>>n,r[a+1]=M*I>>n,r[a+2]=b*I>>n,r[a+3]=j*I>>n,x-=z,M-=c,b-=V,j-=g,z-=D.r,c-=D.g,V-=D.b,g-=D.a,a=h+((a=Q+A)<d?a:d)*_<<2,x+=R+=D.r=r[a],M+=G+=D.g=r[a+1],b+=J+=D.b=r[a+2],j+=$+=D.a=r[a+3],D=D.next,z+=v=y.r,c+=B=y.g,V+=K=y.b,g+=L=y.a,R-=v,G-=B,J-=K,$-=L,y=y.next,k+=_}E(T),W.putImageData(T,p,l)}}function _(S,P,E,p,l,_){if(!(isNaN(_)||_<1)){_|=0;var f,H=document.getElementById(S),T=H.getContext("2d");try{try{f=T.getImageData(P,E,p,l)}catch(S){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),f=T.getImageData(P,E,p,l)}catch(S){throw alert("Cannot access local image"),new Error("unable to access local image data: "+S)}}}catch(S){throw alert("Cannot access image"),new Error("unable to access image data: "+S)}var X,W,h,Q,i,a,s,k,Y,x,M,b,j,z,c,V,g,R,G,J,$=f.data,v=_+_+1,B=p-1,K=l-1,L=_+1,e=L*(L+1)/2,r=new m,q=r;for(h=1;h<v;h++)if(q=q.next=new m,h==L)var O=q;q.next=r;var d=null,A=null;s=a=0;var N=u[_],Z=F[_];for(W=0;W<l;W++){for(z=c=V=k=Y=x=0,M=L*(g=$[a]),b=L*(R=$[a+1]),j=L*(G=$[a+2]),k+=e*g,Y+=e*R,x+=e*G,q=r,h=0;h<L;h++)q.r=g,q.g=R,q.b=G,q=q.next;for(h=1;h<L;h++)Q=a+((B<h?B:h)<<2),k+=(q.r=g=$[Q])*(J=L-h),Y+=(q.g=R=$[Q+1])*J,x+=(q.b=G=$[Q+2])*J,z+=g,c+=R,V+=G,q=q.next;for(d=r,A=O,X=0;X<p;X++)$[a]=k*N>>Z,$[a+1]=Y*N>>Z,$[a+2]=x*N>>Z,k-=M,Y-=b,x-=j,M-=d.r,b-=d.g,j-=d.b,Q=s+((Q=X+_+1)<B?Q:B)<<2,z+=d.r=$[Q],c+=d.g=$[Q+1],V+=d.b=$[Q+2],k+=z,Y+=c,x+=V,d=d.next,M+=g=A.r,b+=R=A.g,j+=G=A.b,z-=g,c-=R,V-=G,A=A.next,a+=4;s+=p}for(X=0;X<p;X++){for(c=V=z=Y=x=k=0,a=X<<2,M=L*(g=$[a]),b=L*(R=$[a+1]),j=L*(G=$[a+2]),k+=e*g,Y+=e*R,x+=e*G,q=r,h=0;h<L;h++)q.r=g,q.g=R,q.b=G,q=q.next;for(i=p,h=1;h<=_;h++)a=i+X<<2,k+=(q.r=g=$[a])*(J=L-h),Y+=(q.g=R=$[a+1])*J,x+=(q.b=G=$[a+2])*J,z+=g,c+=R,V+=G,q=q.next,h<K&&(i+=p);for(a=X,d=r,A=O,W=0;W<l;W++)Q=a<<2,$[Q]=k*N>>Z,$[Q+1]=Y*N>>Z,$[Q+2]=x*N>>Z,k-=M,Y-=b,x-=j,M-=d.r,b-=d.g,j-=d.b,Q=X+((Q=W+L)<K?Q:K)*p<<2,k+=z+=d.r=$[Q],Y+=c+=d.g=$[Q+1],x+=V+=d.b=$[Q+2],d=d.next,M+=g=A.r,b+=R=A.g,j+=G=A.b,z-=g,c-=R,V-=G,A=A.next,a+=p}T.putImageData(f,P,E)}}function m(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var u=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],F=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],f={image:p,canvasRGBA:l,canvasRGB:_};"undefined"!=typeof define&&define.amd?define(function(){return f}):"undefined"!=typeof module&&module.exports&&(module.exports=f),S.stackBlur=f}(void 0!==S?S:this),function(P,E){P.canvg=function(P,E){function l(S){var P=[0,0,0],E=function(E,p){var l=S.match(E);null!=l&&(P[p]+=l.length,S=S.replace(E," "))};return S=S.replace(/:not\(([^\)]*)\)/g,"     $1 "),S=S.replace(/{[\s\S]*/gm," "),E(F,1),E(f,0),E(H,1),E(T,2),E(X,1),E(W,1),S=S.replace(/[\*\s\+>~]/g," "),S=S.replace(/[#\.]/g," "),E(h,2),P.join("")}function _(_){var u={opts:_};u.FRAMERATE=30,u.MAX_VIRTUAL_PIXELS=3e4,u.log=function(S){},1==u.opts.log&&"undefined"!=typeof console&&(u.log=function(S){console.log(S)}),u.init=function(S){var P=0;u.UniqueId=function(){return"canvg"+ ++P},u.Definitions={},u.Styles={},u.StylesSpecificity={},u.Animations=[],u.Images=[],u.ctx=S,u.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(S,P){this.viewPorts.push({width:S,height:P})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){var S,P=this.Current();return P&&(S=P.width)?S:100},this.height=function(){var S,P=this.Current();return P&&(S=P.height)?S:100},this.ComputeSize=function(S){return null!=S&&"number"==typeof S?S:"x"==S?this.width():"y"==S?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},u.init(),u.ImagesLoaded=function(){for(var S=0;S<u.Images.length;S++)if(!u.Images[S].loaded)return!1;return!0},u.trim=function(S){return S.replace(/^\s+|\s+$/g,"")},u.compressSpaces=function(S){return S.replace(/[\s\r\t\n]+/gm," ")},u.ajax=function(S){S=p.Default.beforeLoadURL(S);var P=new p.Request,E={};return E.url=encodeURI(S),E.sync=!0,P.send(E),P.getResponseText()},u.parseXml=function(P){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var E=new Windows.Data.Xml.Dom.XmlDocument,p=new Windows.Data.Xml.Dom.XmlLoadSettings;return p.prohibitDtd=!1,E.loadXml(P,p),E}if(S.DOMParser){return(new DOMParser).parseFromString(P,"text/xml")}P=P.replace(/<!DOCTYPE svg[^>]*>/,"");var E=new ActiveXObject("Microsoft.XMLDOM");return E.async="false",E.loadXML(P),E},u.Property=function(S,P){this.name=S,this.value=P},u.Property.prototype.getValue=function(){return this.value},u.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},u.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var S=parseFloat(this.value);return(this.value+"").match(/%$/)&&(S/=100),S},u.Property.prototype.valueOrDefault=function(S){return this.hasValue()?this.value:S},u.Property.prototype.numValueOrDefault=function(S){return this.hasValue()?this.numValue():S},u.Property.prototype.addOpacity=function(S){var E=this.value;if(null!=S.value&&""!=S.value&&"string"==typeof this.value){var p=new P(this.value);p.ok&&(E="rgba("+p.r+", "+p.g+", "+p.b+", "+S.numValue()+")")}return new u.Property(this.name,E)},u.Property.prototype.getDefinition=function(){var S=this.value.match(/#([^\)'"]+)/);return S&&(S=S[1]),S||(S=this.value),u.Definitions[S]},u.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},u.Property.prototype.getFillStyleDefinition=function(S,P){var E=this.getDefinition();if(null!=E&&E.createGradient)return E.createGradient(u.ctx,S,P);if(null!=E&&E.createPattern){if(E.getHrefAttribute().hasValue()){var p=E.attribute("patternTransform");E=E.getHrefAttribute().getDefinition(),p.hasValue()&&(E.attribute("patternTransform",!0).value=p.value)}return E.createPattern(u.ctx,S)}return null},u.Property.prototype.getDPI=function(S){return 96},u.Property.prototype.getEM=function(S){var P=12,E=new u.Property("fontSize",u.Font.Parse(u.ctx.font).fontSize);return E.hasValue()&&(P=E.toPixels(S)),P},u.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},u.Property.prototype.toPixels=function(S,P){if(!this.hasValue())return 0;var E=this.value+"";if(E.match(/em$/))return this.numValue()*this.getEM(S);if(E.match(/ex$/))return this.numValue()*this.getEM(S)/2;if(E.match(/px$/))return this.numValue();if(E.match(/pt$/))return this.numValue()*this.getDPI(S)*(1/72);if(E.match(/pc$/))return 15*this.numValue();if(E.match(/cm$/))return this.numValue()*this.getDPI(S)/2.54;if(E.match(/mm$/))return this.numValue()*this.getDPI(S)/25.4;if(E.match(/in$/))return this.numValue()*this.getDPI(S);if(E.match(/%$/))return this.numValue()*u.ViewPort.ComputeSize(S);var p=this.numValue();return P&&p<1?p*u.ViewPort.ComputeSize(S):p},u.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var S=this.value+"";return S.match(/s$/)?1e3*this.numValue():(S.match(/ms$/),this.numValue())},u.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var S=this.value+"";return S.match(/deg$/)?this.numValue()*(Math.PI/180):S.match(/grad$/)?this.numValue()*(Math.PI/200):S.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var F={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return u.Property.prototype.toTextBaseline=function(){return this.hasValue()?F[this.value]:null},u.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(S,P,E,p,l,_){var m=null!=_?this.Parse(_):this.CreateFont("","","","","",u.ctx.font);return{fontFamily:l||m.fontFamily,fontSize:p||m.fontSize,fontStyle:S||m.fontStyle,fontWeight:E||m.fontWeight,fontVariant:P||m.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var S=this;this.Parse=function(P){for(var E={},p=u.trim(u.compressSpaces(P||"")).split(" "),l={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},_="",m=0;m<p.length;m++)l.fontStyle||-1==S.Styles.indexOf(p[m])?l.fontVariant||-1==S.Variants.indexOf(p[m])?l.fontWeight||-1==S.Weights.indexOf(p[m])?l.fontSize?"inherit"!=p[m]&&(_+=p[m]):("inherit"!=p[m]&&(E.fontSize=p[m].split("/")[0]),l.fontStyle=l.fontVariant=l.fontWeight=l.fontSize=!0):("inherit"!=p[m]&&(E.fontWeight=p[m]),l.fontStyle=l.fontVariant=l.fontWeight=!0):("inherit"!=p[m]&&(E.fontVariant=p[m]),l.fontStyle=l.fontVariant=!0):("inherit"!=p[m]&&(E.fontStyle=p[m]),l.fontStyle=!0);return""!=_&&(E.fontFamily=_),E}},u.ToNumberArray=function(S){for(var P=u.trim(u.compressSpaces((S||"").replace(/,/g," "))).split(" "),E=0;E<P.length;E++)P[E]=parseFloat(P[E]);return P},u.Point=function(S,P){this.x=S,this.y=P},u.Point.prototype.angleTo=function(S){return Math.atan2(S.y-this.y,S.x-this.x)},u.Point.prototype.applyTransform=function(S){var P=this.x*S[0]+this.y*S[2]+S[4],E=this.x*S[1]+this.y*S[3]+S[5];this.x=P,this.y=E},u.CreatePoint=function(S){var P=u.ToNumberArray(S);return new u.Point(P[0],P[1])},u.CreatePath=function(S){for(var P=u.ToNumberArray(S),E=[],p=0;p<P.length;p+=2)E.push(new u.Point(P[p],P[p+1]));return E},u.BoundingBox=function(S,P,E,p){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(S,P){null!=S&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=S,this.x2=S),S<this.x1&&(this.x1=S),S>this.x2&&(this.x2=S)),null!=P&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=P,this.y2=P),P<this.y1&&(this.y1=P),P>this.y2&&(this.y2=P))},this.addX=function(S){this.addPoint(S,null)},this.addY=function(S){this.addPoint(null,S)},this.addBoundingBox=function(S){this.addPoint(S.x1,S.y1),this.addPoint(S.x2,S.y2)},this.addQuadraticCurve=function(S,P,E,p,l,_){var m=S+2/3*(E-S),u=P+2/3*(p-P),F=m+1/3*(l-S),f=u+1/3*(_-P);this.addBezierCurve(S,P,m,F,u,f,l,_)},this.addBezierCurve=function(S,P,E,p,l,_,m,u){var F=[S,P],f=[E,p],H=[l,_],T=[m,u];this.addPoint(F[0],F[1]),this.addPoint(T[0],T[1]);for(var X=0;X<=1;X++){var W=function(S){return Math.pow(1-S,3)*F[X]+3*Math.pow(1-S,2)*S*f[X]+3*(1-S)*Math.pow(S,2)*H[X]+Math.pow(S,3)*T[X]},h=6*F[X]-12*f[X]+6*H[X],Q=-3*F[X]+9*f[X]-9*H[X]+3*T[X],i=3*f[X]-3*F[X];if(0!=Q){var a=Math.pow(h,2)-4*i*Q;if(!(a<0)){var s=(-h+Math.sqrt(a))/(2*Q);0<s&&s<1&&(0==X&&this.addX(W(s)),1==X&&this.addY(W(s)));var k=(-h-Math.sqrt(a))/(2*Q);0<k&&k<1&&(0==X&&this.addX(W(k)),1==X&&this.addY(W(k)))}}else{if(0==h)continue;var Y=-i/h;0<Y&&Y<1&&(0==X&&this.addX(W(Y)),1==X&&this.addY(W(Y)))}}},this.isPointInBox=function(S,P){return this.x1<=S&&S<=this.x2&&this.y1<=P&&P<=this.y2},this.addPoint(S,P),this.addPoint(E,p)},u.Transform=function(S){var P=this;this.Type={},this.Type.translate=function(S){this.p=u.CreatePoint(S),this.getMatrix=function(){return[1,0,0,1,this.p.x||0,this.p.y||0]},this.apply=function(S){S.translate(this.p.x||0,this.p.y||0)},this.unapply=function(S){S.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(S){S.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(S){var P=u.ToNumberArray(S);this.angle=new u.Property("angle",P[0]),this.cx=P[1]||0,this.cy=P[2]||0,this.apply=function(S){S.translate(this.cx,this.cy),S.rotate(this.angle.toRadians()),S.translate(-this.cx,-this.cy)},this.getMatrix=function(){var S=this.angle.toRadians(),P=Math.sin(S),E=Math.cos(S),p=this.cx,l=this.cy;return[E,P,-P,E,E*-p+P*l+p,P*-p-E*l+l]},this.unapply=function(S){S.translate(this.cx,this.cy),S.rotate(-1*this.angle.toRadians()),S.translate(-this.cx,-this.cy)},this.applyToPoint=function(S){var P=this.angle.toRadians();S.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),S.applyTransform([Math.cos(P),Math.sin(P),-Math.sin(P),Math.cos(P),0,0]),S.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(S){this.p=u.CreatePoint(S),this.getMatrix=function(){return[this.p.x||1,0,0,this.p.y||this.p.x||1,0,0]},this.apply=function(S){S.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(S){S.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(S){S.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(S){this.m=u.ToNumberArray(S),this.getMatrix=function(){return this.m},this.apply=function(S){S.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(S){var P=this.m[0],E=this.m[2],p=this.m[4],l=this.m[1],_=this.m[3],m=this.m[5],u=1/(P*(1*_-0*m)-E*(1*l-0*m)+p*(0*l-0*_));S.transform(u*(1*_-0*m),u*(0*m-1*l),u*(0*p-1*E),u*(1*P-0*p),u*(E*m-p*_),u*(p*l-P*m))},this.applyToPoint=function(S){S.applyTransform(this.m)}},this.Type.SkewBase=function(S){this.base=P.Type.matrix,this.base(S),this.angle=new u.Property("angle",S)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(S){this.base=P.Type.SkewBase,this.base(S),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(S){this.base=P.Type.SkewBase,this.base(S),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.getMatrix=function(){for(var S=1,P=0,E=0,p=1,l=0,_=0,m=0;m<this.transforms.length;m++){var u=this.transforms[m].getMatrix(),F=S,f=P,H=E,T=p,X=l,W=_;S=F*u[0]+H*u[1],P=f*u[0]+T*u[1],E=F*u[2]+H*u[3],p=f*u[2]+T*u[3],l=F*u[4]+H*u[5]+X,_=f*u[4]+T*u[5]+W}return[S,P,E,p,l,_]},this.apply=function(S){for(var P=0;P<this.transforms.length;P++)this.transforms[P].apply(S)},this.unapply=function(S){for(var P=this.transforms.length-1;P>=0;P--)this.transforms[P].unapply(S)},this.applyToPoint=function(S){for(var P=0;P<this.transforms.length;P++)this.transforms[P].applyToPoint(S)};for(var E=u.trim(u.compressSpaces(S)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),p=0;p<E.length;p++){var l=u.trim(E[p].split("(")[0]),_=E[p].split("(")[1].replace(")",""),m=this.Type[l];if(void 0!==m){var F=new m(_);F.type=l,this.transforms.push(F)}}},u.AspectRatio=function(S,P,E,p,l,_,m,F,f,H){P=u.compressSpaces(P),P=P.replace(/^defer\s/,"");var T=P.split(" ")[0]||"xMidYMid",X=P.split(" ")[1]||"meet",W=E/p,h=l/_,Q=Math.min(W,h),i=Math.max(W,h);"meet"==X&&(p*=Q,_*=Q),"slice"==X&&(p*=i,_*=i),f=new u.Property("refX",f),H=new u.Property("refY",H),f.hasValue()&&H.hasValue()?S.translate(-Q*f.toPixels("x"),-Q*H.toPixels("y")):(T.match(/^xMid/)&&("meet"==X&&Q==h||"slice"==X&&i==h)&&S.translate(E/2-p/2,0),T.match(/YMid$/)&&("meet"==X&&Q==W||"slice"==X&&i==W)&&S.translate(0,l/2-_/2),T.match(/^xMax/)&&("meet"==X&&Q==h||"slice"==X&&i==h)&&S.translate(E-p,0),T.match(/YMax$/)&&("meet"==X&&Q==W||"slice"==X&&i==W)&&S.translate(0,l-_)),"none"==T?S.scale(W,h):"meet"==X?S.scale(Q,Q):"slice"==X&&S.scale(i,i),S.translate(null==m?0:-m,null==F?0:-F)},u.Element={},u.EmptyProperty=new u.Property("EMPTY",""),u.Element.ElementBase=function(S){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(S,P){var E=this.attributes[S];return null!=E?E:(1==P&&(E=new u.Property(S,""),this.attributes[S]=E),E||u.EmptyProperty)
},this.getHrefAttribute=function(){for(var S in this.attributes)if("href"==S||S.match(/:href$/))return this.attributes[S];return u.EmptyProperty},this.style=function(S,P,E){var p=this.styles[S];if(null!=p)return p;var l=this.attribute(S);if(null!=l&&l.hasValue())return this.styles[S]=l,l;if(1!=E){var _=this.parent;if(null!=_){var m=_.style(S);if(null!=m&&m.hasValue())return m}}return 1==P&&(p=new u.Property(S,""),this.styles[S]=p),p||u.EmptyProperty},this.render=function(S){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(S.save(),this.style("mask").hasValue()){var P=this.style("mask").getDefinition();null!=P&&P.apply(S,this)}else this.setContext(S),this.renderChildren(S),this.clearContext(S);S.restore()}},this.setContext=function(S){},this.clearContext=function(S){},this.renderChildren=function(S){for(var P=0;P<this.children.length;P++)this.children[P].render(S)},this.addChild=function(S,P){var E=S;P&&(E=u.CreateElement(S)),E.parent=this,"title"!=E.type&&this.children.push(E)},this.addStylesFromStyleDefinition=function(){for(var P in u.Styles)if("@"!=P[0]&&m(S,P)){var E=u.Styles[P],p=u.StylesSpecificity[P];if(null!=E)for(var l in E){var _=this.stylesSpecificity[l];void 0===_&&(_="000"),p>_&&(this.styles[l]=E[l],this.stylesSpecificity[l]=p)}}};var P=new RegExp("^[A-Z-]+$");if(null!=S&&1==S.nodeType){for(var E=0;E<S.attributes.length;E++){var p=S.attributes[E],l=function(S){return P.test(S)?S.toLowerCase():S}(p.nodeName);this.attributes[l]=new u.Property(l,p.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var _=this.attribute("style").value.split(";"),E=0;E<_.length;E++)if(""!=u.trim(_[E])){var F=_[E].split(":"),f=u.trim(F[0]),H=u.trim(F[1]);this.styles[f]=new u.Property(f,H)}this.attribute("id").hasValue()&&null==u.Definitions[this.attribute("id").value]&&(u.Definitions[this.attribute("id").value]=this);for(var E=0;E<S.childNodes.length;E++){var T=S.childNodes[E];if(1==T.nodeType&&this.addChild(T,!0),this.captureTextNodes&&(3==T.nodeType||4==T.nodeType)){var X=T.value||T.text||T.textContent||"";""!=u.compressSpaces(X)&&this.addChild(new u.Element.tspan(T),!1)}}}},u.Element.RenderedElementBase=function(S){this.base=u.Element.ElementBase,this.base(S),this.setContext=function(S){if(this.style("fill").isUrlDefinition()){var P=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=P&&(S.fillStyle=P)}else if(this.style("fill").hasValue()){var E=this.style("fill");"currentColor"==E.value&&(E.value=this.style("color").value),"inherit"!=E.value&&(S.fillStyle="none"==E.value?"rgba(0,0,0,0)":E.value)}if(this.style("fill-opacity").hasValue()){var E=new u.Property("fill",S.fillStyle);E=E.addOpacity(this.style("fill-opacity")),S.fillStyle=E.value}if(this.style("stroke").isUrlDefinition()){var P=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=P&&(S.strokeStyle=P)}else if(this.style("stroke").hasValue()){var p=this.style("stroke");"currentColor"==p.value&&(p.value=this.style("color").value),"inherit"!=p.value&&(S.strokeStyle="none"==p.value?"rgba(0,0,0,0)":p.value)}if(this.style("stroke-opacity").hasValue()){var p=new u.Property("stroke",S.strokeStyle);p=p.addOpacity(this.style("stroke-opacity")),S.strokeStyle=p.value}if(this.style("stroke-width").hasValue()){var l=this.style("stroke-width").toPixels();S.lineWidth=0==l?.001:l}if(this.style("stroke-linecap").hasValue()&&(S.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(S.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(S.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var _=u.ToNumberArray(this.style("stroke-dasharray").value);void 0!==S.setLineDash?S.setLineDash(_):void 0!==S.webkitLineDash?S.webkitLineDash=_:void 0===S.mozDash||1==_.length&&0==_[0]||(S.mozDash=_);var m=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==S.lineDashOffset?S.lineDashOffset=m:void 0!==S.webkitLineDashOffset?S.webkitLineDashOffset=m:void 0!==S.mozDashOffset&&(S.mozDashOffset=m)}if(void 0!==S.font&&(S.font=u.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()){new u.Transform(this.style("transform",!1,!0).value).apply(S)}if(this.style("clip-path",!1,!0).hasValue()){var F=this.style("clip-path",!1,!0).getDefinition();null!=F&&F.apply(S)}this.style("opacity").hasValue()&&(S.globalAlpha=this.style("opacity").numValue())}},u.Element.RenderedElementBase.prototype=new u.Element.ElementBase,u.Element.PathElementBase=function(S){this.base=u.Element.RenderedElementBase,this.base(S),this.path=function(S){return null!=S&&S.beginPath(),new u.BoundingBox},this.renderChildren=function(S){this.path(S),u.Mouse.checkPath(this,S),""!=S.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?S.fill(this.style("fill-rule").value):S.fill()),""!=S.strokeStyle&&S.stroke();var P=this.getMarkers();if(null!=P){if(this.style("marker-start").isUrlDefinition()){var E=this.style("marker-start").getDefinition();E.render(S,P[0][0],P[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var E=this.style("marker-mid").getDefinition(),p=1;p<P.length-1;p++)E.render(S,P[p][0],P[p][1]);if(this.style("marker-end").isUrlDefinition()){var E=this.style("marker-end").getDefinition();E.render(S,P[P.length-1][0],P[P.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},u.Element.PathElementBase.prototype=new u.Element.RenderedElementBase,u.Element.svg=function(P){this.base=u.Element.RenderedElementBase,this.base(P),this.baseClearContext=this.clearContext,this.clearContext=function(S){this.baseClearContext(S),u.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(P){P.strokeStyle="rgba(0,0,0,0)",P.lineCap="butt",P.lineJoin="miter",P.miterLimit=4,void 0!==P.font&&void 0!==S.getComputedStyle&&(P.font=S.getComputedStyle(P.canvas).getPropertyValue("font")),this.baseSetContext(P),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),P.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var E=u.ViewPort.width(),p=u.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){E=this.attribute("width").toPixels("x"),p=this.attribute("height").toPixels("y");var l=0,_=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(l=-this.attribute("refX").toPixels("x"),_=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(P.beginPath(),P.moveTo(l,_),P.lineTo(E,_),P.lineTo(E,p),P.lineTo(l,p),P.closePath(),P.clip())}if(u.ViewPort.SetCurrent(E,p),this.attribute("viewBox").hasValue()){var m=u.ToNumberArray(this.attribute("viewBox").value),F=m[0],f=m[1];E=m[2],p=m[3],u.AspectRatio(P,this.attribute("preserveAspectRatio").value,u.ViewPort.width(),E,u.ViewPort.height(),p,F,f,this.attribute("refX").value,this.attribute("refY").value),u.ViewPort.RemoveCurrent(),u.ViewPort.SetCurrent(m[2],m[3])}}},u.Element.svg.prototype=new u.Element.RenderedElementBase,u.Element.rect=function(S){this.base=u.Element.PathElementBase,this.base(S),this.path=function(S){var P=this.attribute("x").toPixels("x"),E=this.attribute("y").toPixels("y"),p=this.attribute("width").toPixels("x"),l=this.attribute("height").toPixels("y"),_=this.attribute("rx").toPixels("x"),m=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(m=_),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(_=m),_=Math.min(_,p/2),m=Math.min(m,l/2),null!=S&&(S.beginPath(),S.moveTo(P+_,E),S.lineTo(P+p-_,E),S.quadraticCurveTo(P+p,E,P+p,E+m),S.lineTo(P+p,E+l-m),S.quadraticCurveTo(P+p,E+l,P+p-_,E+l),S.lineTo(P+_,E+l),S.quadraticCurveTo(P,E+l,P,E+l-m),S.lineTo(P,E+m),S.quadraticCurveTo(P,E,P+_,E),S.closePath()),new u.BoundingBox(P,E,P+p,E+l)}},u.Element.rect.prototype=new u.Element.PathElementBase,u.Element.circle=function(S){this.base=u.Element.PathElementBase,this.base(S),this.path=function(S){var P=this.attribute("cx").toPixels("x"),E=this.attribute("cy").toPixels("y"),p=this.attribute("r").toPixels();return null!=S&&(S.beginPath(),S.arc(P,E,p,0,2*Math.PI,!0),S.closePath()),new u.BoundingBox(P-p,E-p,P+p,E+p)}},u.Element.circle.prototype=new u.Element.PathElementBase,u.Element.ellipse=function(S){this.base=u.Element.PathElementBase,this.base(S),this.path=function(S){var P=(Math.sqrt(2)-1)/3*4,E=this.attribute("rx").toPixels("x"),p=this.attribute("ry").toPixels("y"),l=this.attribute("cx").toPixels("x"),_=this.attribute("cy").toPixels("y");return null!=S&&(S.beginPath(),S.moveTo(l,_-p),S.bezierCurveTo(l+P*E,_-p,l+E,_-P*p,l+E,_),S.bezierCurveTo(l+E,_+P*p,l+P*E,_+p,l,_+p),S.bezierCurveTo(l-P*E,_+p,l-E,_+P*p,l-E,_),S.bezierCurveTo(l-E,_-P*p,l-P*E,_-p,l,_-p),S.closePath()),new u.BoundingBox(l-E,_-p,l+E,_+p)}},u.Element.ellipse.prototype=new u.Element.PathElementBase,u.Element.line=function(S){this.base=u.Element.PathElementBase,this.base(S),this.getPoints=function(){return[new u.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new u.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(S){var P=this.getPoints();return null!=S&&(S.beginPath(),S.moveTo(P[0].x,P[0].y),S.lineTo(P[1].x,P[1].y)),new u.BoundingBox(P[0].x,P[0].y,P[1].x,P[1].y)},this.getMarkers=function(){var S=this.getPoints(),P=S[0].angleTo(S[1]);return[[S[0],P],[S[1],P]]}},u.Element.line.prototype=new u.Element.PathElementBase,u.Element.polyline=function(S){this.base=u.Element.PathElementBase,this.base(S),this.points=u.CreatePath(this.attribute("points").value),this.path=function(S){var P=new u.BoundingBox(this.points[0].x,this.points[0].y);null!=S&&(S.beginPath(),S.moveTo(this.points[0].x,this.points[0].y));for(var E=1;E<this.points.length;E++)P.addPoint(this.points[E].x,this.points[E].y),null!=S&&S.lineTo(this.points[E].x,this.points[E].y);return P},this.getMarkers=function(){for(var S=[],P=0;P<this.points.length-1;P++)S.push([this.points[P],this.points[P].angleTo(this.points[P+1])]);return S.length>0&&S.push([this.points[this.points.length-1],S[S.length-1][1]]),S}},u.Element.polyline.prototype=new u.Element.PathElementBase,u.Element.polygon=function(S){this.base=u.Element.polyline,this.base(S),this.basePath=this.path,this.path=function(S){var P=this.basePath(S);return null!=S&&(S.lineTo(this.points[0].x,this.points[0].y),S.closePath()),P}},u.Element.polygon.prototype=new u.Element.polyline,u.Element.path=function(S){this.base=u.Element.PathElementBase,this.base(S);var P=this.attribute("d").value;P=P.replace(/,/gm," ");for(var E=0;E<2;E++)P=P.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");P=P.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),P=P.replace(/([0-9])([+\-])/gm,"$1 $2");for(var E=0;E<2;E++)P=P.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");P=P.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),P=u.compressSpaces(P),P=u.trim(P),this.PathParser=new function(S){this.tokens=S.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new u.Point(0,0),this.control=new u.Point(0,0),this.current=new u.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var S=new u.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(S)},this.getAsControlPoint=function(){var S=this.getPoint();return this.control=S,S},this.getAsCurrentPoint=function(){var S=this.getPoint();return this.current=S,S},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new u.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(S){return this.isRelativeCommand()&&(S.x+=this.current.x,S.y+=this.current.y),S},this.addMarker=function(S,P,E){null!=E&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(E)),this.addMarkerAngle(S,null==P?null:P.angleTo(S))},this.addMarkerAngle=function(S,P){this.points.push(S),this.angles.push(P)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var S=0;S<this.angles.length;S++)if(null==this.angles[S])for(var P=S+1;P<this.angles.length;P++)if(null!=this.angles[P]){this.angles[S]=this.angles[P];break}return this.angles}}(P),this.path=function(S){var P=this.PathParser;P.reset();var E=new u.BoundingBox;for(null!=S&&S.beginPath();!P.isEnd();)switch(P.nextCommand(),P.command){case"M":case"m":var p=P.getAsCurrentPoint();for(P.addMarker(p),E.addPoint(p.x,p.y),null!=S&&S.moveTo(p.x,p.y),P.start=P.current;!P.isCommandOrEnd();){var p=P.getAsCurrentPoint();P.addMarker(p,P.start),E.addPoint(p.x,p.y),null!=S&&S.lineTo(p.x,p.y)}break;case"L":case"l":for(;!P.isCommandOrEnd();){var l=P.current,p=P.getAsCurrentPoint();P.addMarker(p,l),E.addPoint(p.x,p.y),null!=S&&S.lineTo(p.x,p.y)}break;case"H":case"h":for(;!P.isCommandOrEnd();){var _=new u.Point((P.isRelativeCommand()?P.current.x:0)+P.getScalar(),P.current.y);P.addMarker(_,P.current),P.current=_,E.addPoint(P.current.x,P.current.y),null!=S&&S.lineTo(P.current.x,P.current.y)}break;case"V":case"v":for(;!P.isCommandOrEnd();){var _=new u.Point(P.current.x,(P.isRelativeCommand()?P.current.y:0)+P.getScalar());P.addMarker(_,P.current),P.current=_,E.addPoint(P.current.x,P.current.y),null!=S&&S.lineTo(P.current.x,P.current.y)}break;case"C":case"c":for(;!P.isCommandOrEnd();){var m=P.current,F=P.getPoint(),f=P.getAsControlPoint(),H=P.getAsCurrentPoint();P.addMarker(H,f,F),E.addBezierCurve(m.x,m.y,F.x,F.y,f.x,f.y,H.x,H.y),null!=S&&S.bezierCurveTo(F.x,F.y,f.x,f.y,H.x,H.y)}break;case"S":case"s":for(;!P.isCommandOrEnd();){var m=P.current,F=P.getReflectedControlPoint(),f=P.getAsControlPoint(),H=P.getAsCurrentPoint();P.addMarker(H,f,F),E.addBezierCurve(m.x,m.y,F.x,F.y,f.x,f.y,H.x,H.y),null!=S&&S.bezierCurveTo(F.x,F.y,f.x,f.y,H.x,H.y)}break;case"Q":case"q":for(;!P.isCommandOrEnd();){var m=P.current,f=P.getAsControlPoint(),H=P.getAsCurrentPoint();P.addMarker(H,f,f),E.addQuadraticCurve(m.x,m.y,f.x,f.y,H.x,H.y),null!=S&&S.quadraticCurveTo(f.x,f.y,H.x,H.y)}break;case"T":case"t":for(;!P.isCommandOrEnd();){var m=P.current,f=P.getReflectedControlPoint();P.control=f;var H=P.getAsCurrentPoint();P.addMarker(H,f,f),E.addQuadraticCurve(m.x,m.y,f.x,f.y,H.x,H.y),null!=S&&S.quadraticCurveTo(f.x,f.y,H.x,H.y)}break;case"A":case"a":for(;!P.isCommandOrEnd();){var m=P.current,T=P.getScalar(),X=P.getScalar(),W=P.getScalar()*(Math.PI/180),h=P.getScalar(),Q=P.getScalar(),H=P.getAsCurrentPoint(),i=new u.Point(Math.cos(W)*(m.x-H.x)/2+Math.sin(W)*(m.y-H.y)/2,-Math.sin(W)*(m.x-H.x)/2+Math.cos(W)*(m.y-H.y)/2),a=Math.pow(i.x,2)/Math.pow(T,2)+Math.pow(i.y,2)/Math.pow(X,2);a>1&&(T*=Math.sqrt(a),X*=Math.sqrt(a));var s=(h==Q?-1:1)*Math.sqrt((Math.pow(T,2)*Math.pow(X,2)-Math.pow(T,2)*Math.pow(i.y,2)-Math.pow(X,2)*Math.pow(i.x,2))/(Math.pow(T,2)*Math.pow(i.y,2)+Math.pow(X,2)*Math.pow(i.x,2)));isNaN(s)&&(s=0);var k=new u.Point(s*T*i.y/X,s*-X*i.x/T),Y=new u.Point((m.x+H.x)/2+Math.cos(W)*k.x-Math.sin(W)*k.y,(m.y+H.y)/2+Math.sin(W)*k.x+Math.cos(W)*k.y),x=function(S){return Math.sqrt(Math.pow(S[0],2)+Math.pow(S[1],2))},M=function(S,P){return(S[0]*P[0]+S[1]*P[1])/(x(S)*x(P))},b=function(S,P){return(S[0]*P[1]<S[1]*P[0]?-1:1)*Math.acos(M(S,P))},j=b([1,0],[(i.x-k.x)/T,(i.y-k.y)/X]),z=[(i.x-k.x)/T,(i.y-k.y)/X],c=[(-i.x-k.x)/T,(-i.y-k.y)/X],V=b(z,c);M(z,c)<=-1&&(V=Math.PI),M(z,c)>=1&&(V=0);var g=1-Q?1:-1,R=j+g*(V/2),G=new u.Point(Y.x+T*Math.cos(R),Y.y+X*Math.sin(R));if(P.addMarkerAngle(G,R-g*Math.PI/2),P.addMarkerAngle(H,R-g*Math.PI),E.addPoint(H.x,H.y),null!=S){var M=T>X?T:X,J=T>X?1:T/X,$=T>X?X/T:1;S.translate(Y.x,Y.y),S.rotate(W),S.scale(J,$),S.arc(0,0,M,j,j+V,1-Q),S.scale(1/J,1/$),S.rotate(-W),S.translate(-Y.x,-Y.y)}}break;case"Z":case"z":null!=S&&S.closePath(),P.current=P.start}return E},this.getMarkers=function(){for(var S=this.PathParser.getMarkerPoints(),P=this.PathParser.getMarkerAngles(),E=[],p=0;p<S.length;p++)E.push([S[p],P[p]]);return E}},u.Element.path.prototype=new u.Element.PathElementBase,u.Element.pattern=function(S){this.base=u.Element.ElementBase,this.base(S),this.createPattern=function(S,P){var E=this.attribute("width").toPixels("x",!0),p=this.attribute("height").toPixels("y",!0),l=new u.Element.svg;l.attributes.viewBox=new u.Property("viewBox",this.attribute("viewBox").value),l.attributes.width=new u.Property("width",E+"px"),l.attributes.height=new u.Property("height",p+"px"),l.attributes.transform=new u.Property("transform",this.attribute("patternTransform").value),l.children=this.children;var _=document.createElement("canvas");_.width=E,_.height=p;var m=_.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&m.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var F=-1;F<=1;F++)for(var f=-1;f<=1;f++)m.save(),l.attributes.x=new u.Property("x",F*_.width),l.attributes.y=new u.Property("y",f*_.height),l.render(m),m.restore();return S.createPattern(_,"repeat")}},u.Element.pattern.prototype=new u.Element.ElementBase,u.Element.marker=function(S){this.base=u.Element.ElementBase,this.base(S),this.baseRender=this.render,this.render=function(S,P,E){S.translate(P.x,P.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&S.rotate(E),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&S.scale(S.lineWidth,S.lineWidth),S.save();var p=new u.Element.svg;p.attributes.viewBox=new u.Property("viewBox",this.attribute("viewBox").value),p.attributes.refX=new u.Property("refX",this.attribute("refX").value),p.attributes.refY=new u.Property("refY",this.attribute("refY").value),p.attributes.width=new u.Property("width",this.attribute("markerWidth").value),p.attributes.height=new u.Property("height",this.attribute("markerHeight").value),p.attributes.fill=new u.Property("fill",this.attribute("fill").valueOrDefault("black")),p.attributes.stroke=new u.Property("stroke",this.attribute("stroke").valueOrDefault("none")),p.children=this.children,p.render(S),S.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&S.scale(1/S.lineWidth,1/S.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&S.rotate(-E),S.translate(-P.x,-P.y)}},u.Element.marker.prototype=new u.Element.ElementBase,u.Element.defs=function(S){this.base=u.Element.ElementBase,this.base(S),this.render=function(S){}},u.Element.defs.prototype=new u.Element.ElementBase,u.Element.GradientBase=function(S){this.base=u.Element.ElementBase,this.base(S),this.stops=[];for(var P=0;P<this.children.length;P++){var E=this.children[P];"stop"==E.type&&this.stops.push(E)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(S){for(var P=0;P<this.attributesToInherit.length;P++){var E=this.attributesToInherit[P];!this.attribute(E).hasValue()&&S.attribute(E).hasValue()&&(this.attribute(E,!0).value=S.attribute(E).value)}},this.createGradient=function(S,P,E){var p=this;this.getHrefAttribute().hasValue()&&(p=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(p));var l=function(S){if(E.hasValue()){return new u.Property("color",S).addOpacity(E).value}return S},_=this.getGradient(S,P);if(null==_)return l(p.stops[p.stops.length-1].color);for(var m=0;m<p.stops.length;m++)_.addColorStop(p.stops[m].offset,l(p.stops[m].color));if(this.attribute("gradientTransform").hasValue()){var F=u.ViewPort.viewPorts[0],f=new u.Element.rect;f.attributes.x=new u.Property("x",-u.MAX_VIRTUAL_PIXELS/3),f.attributes.y=new u.Property("y",-u.MAX_VIRTUAL_PIXELS/3),f.attributes.width=new u.Property("width",u.MAX_VIRTUAL_PIXELS),f.attributes.height=new u.Property("height",u.MAX_VIRTUAL_PIXELS);var H=new u.Element.g;H.attributes.transform=new u.Property("transform",this.attribute("gradientTransform").value),H.children=[f];var T=new u.Element.svg;T.attributes.x=new u.Property("x",0),T.attributes.y=new u.Property("y",0),T.attributes.width=new u.Property("width",F.width),T.attributes.height=new u.Property("height",F.height),T.children=[H];var X=document.createElement("canvas");X.width=F.width,X.height=F.height;var W=X.getContext("2d");W.fillStyle=_,T.render(W);var h=W.createPattern(X,"no-repeat");return h.gradient=_,h.gradientTransform=this.attribute("gradientTransform").value,h.trans=new u.Transform(this.attribute("gradientTransform").value).getMatrix(),h}return _}},u.Element.GradientBase.prototype=new u.Element.ElementBase,u.Element.linearGradient=function(S){this.base=u.Element.GradientBase,this.base(S),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(S,P){var E="objectBoundingBox"==this.gradientUnits()?P.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var p="objectBoundingBox"==this.gradientUnits()?E.x()+E.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),l="objectBoundingBox"==this.gradientUnits()?E.y()+E.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),_="objectBoundingBox"==this.gradientUnits()?E.x()+E.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),m="objectBoundingBox"==this.gradientUnits()?E.y()+E.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return p==_&&l==m?null:S.createLinearGradient(p,l,_,m)}},u.Element.linearGradient.prototype=new u.Element.GradientBase,u.Element.radialGradient=function(S){this.base=u.Element.GradientBase,this.base(S),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(S,P){var E=P.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var p="objectBoundingBox"==this.gradientUnits()?E.x()+E.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),l="objectBoundingBox"==this.gradientUnits()?E.y()+E.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),_=p,m=l;this.attribute("fx").hasValue()&&(_="objectBoundingBox"==this.gradientUnits()?E.x()+E.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(m="objectBoundingBox"==this.gradientUnits()?E.y()+E.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var u="objectBoundingBox"==this.gradientUnits()?(E.width()+E.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return S.createRadialGradient(_,m,0,p,l,u)}},u.Element.radialGradient.prototype=new u.Element.GradientBase,u.Element.stop=function(S){this.base=u.Element.ElementBase,this.base(S),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var P=this.style("stop-color",!0);""===P.value&&(P.value="#000"),this.style("stop-opacity").hasValue()&&(P=P.addOpacity(this.style("stop-opacity"))),this.color=P.value},u.Element.stop.prototype=new u.Element.ElementBase,u.Element.AnimateBase=function(S){this.base=u.Element.ElementBase,this.base(S),u.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var S=this.attribute("attributeType").value,P=this.attribute("attributeName").value;return"CSS"==S?this.parent.style(P,!0):this.parent.attribute(P,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(S){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+S;var P=!1;if(this.begin<this.duration){var E=this.calcValue();if(this.attribute("type").hasValue()){E=this.attribute("type").value+"("+E+")"}this.getProperty().value=E,P=!0}return P},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var S={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var P=S.progress*(this.values.value.length-1),E=Math.floor(P),p=Math.ceil(P);S.from=new u.Property("from",parseFloat(this.values.value[E])),S.to=new u.Property("to",parseFloat(this.values.value[p])),S.progress=(P-E)/(p-E)}else S.from=this.from,S.to=this.to;return S}},u.Element.AnimateBase.prototype=new u.Element.ElementBase,u.Element.animate=function(S){this.base=u.Element.AnimateBase,this.base(S),this.calcValue=function(){var S=this.progress();return S.from.numValue()+(S.to.numValue()-S.from.numValue())*S.progress+this.initialUnits}},u.Element.animate.prototype=new u.Element.AnimateBase,u.Element.animateColor=function(S){this.base=u.Element.AnimateBase,this.base(S),this.calcValue=function(){var S=this.progress(),E=new P(S.from.value),p=new P(S.to.value);if(E.ok&&p.ok){var l=E.r+(p.r-E.r)*S.progress,_=E.g+(p.g-E.g)*S.progress,m=E.b+(p.b-E.b)*S.progress;return"rgb("+parseInt(l,10)+","+parseInt(_,10)+","+parseInt(m,10)+")"}return this.attribute("from").value}},u.Element.animateColor.prototype=new u.Element.AnimateBase,u.Element.animateTransform=function(S){this.base=u.Element.AnimateBase,this.base(S),this.calcValue=function(){for(var S=this.progress(),P=u.ToNumberArray(S.from.value),E=u.ToNumberArray(S.to.value),p="",l=0;l<P.length;l++)p+=P[l]+(E[l]-P[l])*S.progress+" ";return p}},u.Element.animateTransform.prototype=new u.Element.animate,u.Element.font=function(S){this.base=u.Element.ElementBase,this.base(S),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var P=0;P<this.children.length;P++){var E=this.children[P];"font-face"==E.type?(this.fontFace=E,E.style("font-family").hasValue()&&(u.Definitions[E.style("font-family").value]=this)):"missing-glyph"==E.type?this.missingGlyph=E:"glyph"==E.type&&(""!=E.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[E.unicode]&&(this.glyphs[E.unicode]=[]),this.glyphs[E.unicode][E.arabicForm]=E):this.glyphs[E.unicode]=E)}},u.Element.font.prototype=new u.Element.ElementBase,u.Element.fontface=function(S){this.base=u.Element.ElementBase,this.base(S),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},u.Element.fontface.prototype=new u.Element.ElementBase,u.Element.missingglyph=function(S){this.base=u.Element.path,this.base(S),this.horizAdvX=0},u.Element.missingglyph.prototype=new u.Element.path,u.Element.glyph=function(S){this.base=u.Element.path,this.base(S),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},u.Element.glyph.prototype=new u.Element.path,u.Element.text=function(S){this.captureTextNodes=!0,this.base=u.Element.RenderedElementBase,this.base(S),this.baseSetContext=this.setContext,this.setContext=function(S){this.baseSetContext(S);var P=this.style("dominant-baseline").toTextBaseline();null==P&&(P=this.style("alignment-baseline").toTextBaseline()),null!=P&&(S.textBaseline=P)},this.getBoundingBox=function(){var S=this.attribute("x").toPixels("x"),P=this.attribute("y").toPixels("y"),E=this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize);return new u.BoundingBox(S,P-E,S+Math.floor(2*E/3)*this.children[0].getText().length,P)},this.renderChildren=function(S){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(S,this,0);for(var P=0;P<this.children.length;P++)this.renderChild(S,this,this,P)},this.getAnchorDelta=function(S,P,E){var p=this.style("text-anchor").valueOrDefault("start");if("start"!=p){for(var l=0,_=E;_<P.children.length;_++){var m=P.children[_];if(_>E&&m.attribute("x").hasValue())break;m.measureTextRecursive&&(l+=m.measureTextRecursive(S))}return-1*("end"==p?l:l/2)}return 0},this.renderChild=function(S,P,E,p){var l=E.children[p];l.attribute("x").hasValue()?(l.x=l.attribute("x").toPixels("x")+P.getAnchorDelta(S,E,p),l.attribute("dx").hasValue()&&(l.x+=l.attribute("dx").toPixels("x"))):(l.attribute("dx").hasValue()&&(P.x+=l.attribute("dx").toPixels("x")),l.x=P.x),P.x=l.x+(l.measureText?l.measureText(S):0),l.attribute("y").hasValue()?(l.y=l.attribute("y").toPixels("y"),l.attribute("dy").hasValue()&&(l.y+=l.attribute("dy").toPixels("y"))):(l.attribute("dy").hasValue()&&(P.y+=l.attribute("dy").toPixels("y")),l.y=P.y),P.y=l.y,l.render(S);for(var p=0;p<l.children.length;p++)P.renderChild(S,P,l,p)}},u.Element.text.prototype=new u.Element.RenderedElementBase,u.Element.TextElementBase=function(S){this.base=u.Element.RenderedElementBase,this.base(S),this.getGlyph=function(S,P,E){var p=P[E],l=null;if(S.isArabic){var _="isolated";(0==E||" "==P[E-1])&&E<P.length-2&&" "!=P[E+1]&&(_="terminal"),E>0&&" "!=P[E-1]&&E<P.length-2&&" "!=P[E+1]&&(_="medial"),E>0&&" "!=P[E-1]&&(E==P.length-1||" "==P[E+1])&&(_="initial"),void 0!==S.glyphs[p]&&null==(l=S.glyphs[p][_])&&"glyph"==S.glyphs[p].type&&(l=S.glyphs[p])}else l=S.glyphs[p];return null==l&&(l=S.missingGlyph),l},this.renderChildren=function(S){var P=this.parent.style("font-family").getDefinition();if(null==P)""!=S.fillStyle&&S.fillText(u.compressSpaces(this.getText()),this.x,this.y),""!=S.strokeStyle&&S.strokeText(u.compressSpaces(this.getText()),this.x,this.y);else{
var E=this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize),p=this.parent.style("font-style").valueOrDefault(u.Font.Parse(u.ctx.font).fontStyle),l=this.getText();P.isRTL&&(l=l.split("").reverse().join(""));for(var _=u.ToNumberArray(this.parent.attribute("dx").value),m=0;m<l.length;m++){var F=this.getGlyph(P,l,m),f=E/P.fontFace.unitsPerEm;S.translate(this.x,this.y),S.scale(f,-f);var H=S.lineWidth;S.lineWidth=S.lineWidth*P.fontFace.unitsPerEm/E,"italic"==p&&S.transform(1,0,.4,1,0,0),F.render(S),"italic"==p&&S.transform(1,0,-.4,1,0,0),S.lineWidth=H,S.scale(1/f,-1/f),S.translate(-this.x,-this.y),this.x+=E*(F.horizAdvX||P.horizAdvX)/P.fontFace.unitsPerEm,void 0===_[m]||isNaN(_[m])||(this.x+=_[m])}}},this.getText=function(){},this.measureTextRecursive=function(S){for(var P=this.measureText(S),E=0;E<this.children.length;E++)P+=this.children[E].measureTextRecursive(S);return P},this.measureText=function(S){var P=this.parent.style("font-family").getDefinition();if(null!=P){var E=this.parent.style("font-size").numValueOrDefault(u.Font.Parse(u.ctx.font).fontSize),p=0,l=this.getText();P.isRTL&&(l=l.split("").reverse().join(""));for(var _=u.ToNumberArray(this.parent.attribute("dx").value),m=0;m<l.length;m++){p+=(this.getGlyph(P,l,m).horizAdvX||P.horizAdvX)*E/P.fontFace.unitsPerEm,void 0===_[m]||isNaN(_[m])||(p+=_[m])}return p}var F=u.compressSpaces(this.getText());if(!S.measureText)return 10*F.length;S.save(),this.setContext(S);var f=S.measureText(F).width;return S.restore(),f}},u.Element.TextElementBase.prototype=new u.Element.RenderedElementBase,u.Element.tspan=function(S){this.captureTextNodes=!0,this.base=u.Element.TextElementBase,this.base(S),this.text=u.compressSpaces(S.value||S.text||S.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},u.Element.tspan.prototype=new u.Element.TextElementBase,u.Element.tref=function(S){this.base=u.Element.TextElementBase,this.base(S),this.getText=function(){var S=this.getHrefAttribute().getDefinition();if(null!=S)return S.children[0].getText()}},u.Element.tref.prototype=new u.Element.TextElementBase,u.Element.a=function(P){this.base=u.Element.TextElementBase,this.base(P),this.hasText=P.childNodes.length>0;for(var E=0;E<P.childNodes.length;E++)3!=P.childNodes[E].nodeType&&(this.hasText=!1);this.text=this.hasText?P.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(S){if(this.hasText){this.baseRenderChildren(S);var P=new u.Property("fontSize",u.Font.Parse(u.ctx.font).fontSize);u.Mouse.checkBoundingBox(this,new u.BoundingBox(this.x,this.y-P.toPixels("y"),this.x+this.measureText(S),this.y))}else if(this.children.length>0){var E=new u.Element.g;E.children=this.children,E.parent=this,E.render(S)}},this.onclick=function(){S.open(this.getHrefAttribute().value)},this.onmousemove=function(){u.ctx.canvas.style.cursor="pointer"}},u.Element.a.prototype=new u.Element.TextElementBase,u.Element.image=function(S){this.base=u.Element.RenderedElementBase,this.base(S);var P=this.getHrefAttribute().value;if(""!=P){var E=P.match(/\.svg$/);if(u.Images.push(this),this.loaded=!1,E)this.img=u.ajax(P),this.loaded=!0;else{this.img=document.createElement("img"),1==u.opts.useCORS&&(this.img.crossOrigin="Anonymous");var p=this;this.img.onload=function(){p.loaded=!0},this.img.onerror=function(){u.log('ERROR: image "'+P+'" not found'),p.loaded=!0},this.img.src=P}this.renderChildren=function(S){var P=this.attribute("x").toPixels("x"),p=this.attribute("y").toPixels("y"),l=this.attribute("width").toPixels("x"),_=this.attribute("height").toPixels("y");0!=l&&0!=_&&(S.save(),E?S.drawSvg(this.img,P,p,l,_):(S.translate(P,p),u.AspectRatio(S,this.attribute("preserveAspectRatio").value,l,this.img.width,_,this.img.height,0,0),S.drawImage(this.img,0,0)),S.restore())},this.getBoundingBox=function(){var S=this.attribute("x").toPixels("x"),P=this.attribute("y").toPixels("y"),E=this.attribute("width").toPixels("x"),p=this.attribute("height").toPixels("y");return new u.BoundingBox(S,P,S+E,P+p)}}},u.Element.image.prototype=new u.Element.RenderedElementBase,u.Element.g=function(S){this.base=u.Element.RenderedElementBase,this.base(S),this.getBoundingBox=function(){for(var S=new u.BoundingBox,P=0;P<this.children.length;P++)S.addBoundingBox(this.children[P].getBoundingBox());return S}},u.Element.g.prototype=new u.Element.RenderedElementBase,u.Element.symbol=function(S){this.base=u.Element.RenderedElementBase,this.base(S),this.render=function(S){}},u.Element.symbol.prototype=new u.Element.RenderedElementBase,u.Element.switch=function(S){this.base=u.Element.RenderedElementBase,this.base(S)},u.Element.switch.prototype=new u.Element.symbol,u.Element.style=function(S){this.base=u.Element.ElementBase,this.base(S);for(var P="",E=0;E<S.childNodes.length;E++)P+=S.childNodes[E].data;P=P.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),P=u.compressSpaces(P);for(var p=P.split("}"),E=0;E<p.length;E++)if(""!=u.trim(p[E]))for(var _=p[E].split("{"),m=_[0].split(","),F=_[1].split(";"),f=0;f<m.length;f++){var H=u.trim(m[f]);if(""!=H){for(var T=u.Styles[H]||{},X=0;X<F.length;X++){var W=F[X].indexOf(":"),h=F[X].substr(0,W),Q=F[X].substr(W+1,F[X].length-W);null!=h&&null!=Q&&(T[u.trim(h)]=new u.Property(u.trim(h),u.trim(Q)))}if(u.Styles[H]=T,u.StylesSpecificity[H]=l(H),"@font-face"==H)for(var i=T["font-family"].value.replace(/"/g,""),a=T.src.value.split(","),s=0;s<a.length;s++)if(a[s].indexOf('format("svg")')>0)for(var k=a[s].indexOf("url"),Y=a[s].indexOf(")",k),x=a[s].substr(k+5,Y-k-6),M=u.parseXml(u.ajax(x)),b=M.getElementsByTagName("font"),j=0;j<b.length;j++){var z=u.CreateElement(b[j]);u.Definitions[i]=z}}}},u.Element.style.prototype=new u.Element.ElementBase,u.Element.use=function(S){this.base=u.Element.RenderedElementBase,this.base(S),this.baseSetContext=this.setContext,this.setContext=function(S){this.baseSetContext(S),this.attribute("x").hasValue()&&S.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&S.translate(0,this.attribute("y").toPixels("y"))};var P=this.getHrefAttribute().getDefinition();this.path=function(S){null!=P&&P.path(S)},this.getBoundingBox=function(){if(null!=P)return P.getBoundingBox()},this.renderChildren=function(S){if(null!=P){var E=P;"symbol"==P.type&&(E=new u.Element.svg,E.type="svg",E.attributes.viewBox=new u.Property("viewBox",P.attribute("viewBox").value),E.attributes.preserveAspectRatio=new u.Property("preserveAspectRatio",P.attribute("preserveAspectRatio").value),E.attributes.overflow=new u.Property("overflow",P.attribute("overflow").value),E.children=P.children),"svg"==E.type&&(this.attribute("width").hasValue()&&(E.attributes.width=new u.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(E.attributes.height=new u.Property("height",this.attribute("height").value)));var p=E.parent;E.parent=null,E.render(S),E.parent=p}}},u.Element.use.prototype=new u.Element.RenderedElementBase,u.Element.mask=function(S){this.base=u.Element.ElementBase,this.base(S),this.apply=function(S,P){var E=this.attribute("x").toPixels("x"),p=this.attribute("y").toPixels("y"),l=this.attribute("width").toPixels("x"),_=this.attribute("height").toPixels("y");if(0==l&&0==_){for(var m=new u.BoundingBox,F=0;F<this.children.length;F++)this.children[F].getBoundingBox&&m.addBoundingBox(this.children[F].getBoundingBox());var E=Math.floor(m.x1),p=Math.floor(m.y1),l=Math.floor(m.width()),_=Math.floor(m.height())}if(l&&_){var f=P.style("mask").value;P.style("mask").value="";var H=document.createElement("canvas");H.width=E+l,H.height=p+_;var T=H.getContext("2d");if(this.renderChildren(T),H.width&&H.height){var X=document.createElement("canvas");X.width=E+l,X.height=p+_;var W=X.getContext("2d");P.render(W),W.globalCompositeOperation="destination-in",W.fillStyle=T.createPattern(H,"no-repeat"),W.fillRect(0,0,E+l,p+_),S.fillStyle=W.createPattern(X,"no-repeat"),S.fillRect(0,0,E+l,p+_),P.style("mask").value=f}}},this.render=function(S){}},u.Element.mask.prototype=new u.Element.ElementBase,u.Element.clipPath=function(S){this.base=u.Element.ElementBase,this.base(S),this.apply=function(S){var P=S.beginPath;S.beginPath=function(){};var E=S.closePath;S.closePath=function(){};var p;this.style("transform",!1,!0).hasValue()&&(p=new u.Transform(this.style("transform",!1,!0).value),p.apply(S)),P.call(S);for(var l=0;l<this.children.length;l++){var _=this.children[l];if(void 0!==_.path){var m=null;_.style("transform",!1,!0).hasValue()&&(m=new u.Transform(_.style("transform",!1,!0).value),m.apply(S)),_.path(S),S.closePath=E,m&&m.unapply(S)}}E.call(S),S.clip(),p&&p.unapply(S),S.beginPath=P,S.closePath=E},this.render=function(S){}},u.Element.clipPath.prototype=new u.Element.ElementBase,u.Element.filter=function(S){this.base=u.Element.ElementBase,this.base(S),this.apply=function(S,P){return},this.render=function(S){}},u.Element.filter.prototype=new u.Element.ElementBase,u.Element.feMorphology=function(S){this.base=u.Element.ElementBase,this.base(S),this.apply=function(S,P,E,p,l){}},u.Element.feMorphology.prototype=new u.Element.ElementBase,u.Element.feComposite=function(S){this.base=u.Element.ElementBase,this.base(S),this.apply=function(S,P,E,p,l){}},u.Element.feComposite.prototype=new u.Element.ElementBase,u.Element.feColorMatrix=function(S){function P(S,P,E,p,l,_){return S[E*p*4+4*P+_]}function E(S,P,E,p,l,_,m){S[E*p*4+4*P+_]=m}function p(S,P){var E=l[S];return E*(E<0?P-255:P)}this.base=u.Element.ElementBase,this.base(S);var l=u.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var _=l[0];l=[.213+.787*_,.715-.715*_,.072-.072*_,0,0,.213-.213*_,.715+.285*_,.072-.072*_,0,0,.213-.213*_,.715-.715*_,.072+.928*_,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var m=l[0]*Math.PI/180,F=function(S,P,E){return S+Math.cos(m)*P+Math.sin(m)*E};l=[F(.213,.787,-.213),F(.715,-.715,-.715),F(.072,-.072,.928),0,0,F(.213,-.213,.143),F(.715,.285,.14),F(.072,-.072,-.283),0,0,F(.213,-.213,-.787),F(.715,-.715,.715),F(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(S,l,_,m,u){if(m&&u){for(var F=S.getImageData(0,0,m,u),_=0;_<u;_++)for(var l=0;l<m;l++){var f=P(F.data,l,_,m,u,0),H=P(F.data,l,_,m,u,1),T=P(F.data,l,_,m,u,2),X=P(F.data,l,_,m,u,3);E(F.data,l,_,m,u,0,p(0,f)+p(1,H)+p(2,T)+p(3,X)+p(4,1)),E(F.data,l,_,m,u,1,p(5,f)+p(6,H)+p(7,T)+p(8,X)+p(9,1)),E(F.data,l,_,m,u,2,p(10,f)+p(11,H)+p(12,T)+p(13,X)+p(14,1)),E(F.data,l,_,m,u,3,p(15,f)+p(16,H)+p(17,T)+p(18,X)+p(19,1))}S.clearRect(0,0,m,u),S.putImageData(F,0,0)}}},u.Element.feColorMatrix.prototype=new u.Element.ElementBase,u.Element.feGaussianBlur=function(S){this.base=u.Element.ElementBase,this.base(S),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(S,P,p,l,_){if(void 0===E.canvasRGBA)return void u.log("ERROR: StackBlur.js must be included for blur to work");S.canvas.id=u.UniqueId(),S.canvas.style.display="none",document.body.appendChild(S.canvas),E.canvasRGBA(S.canvas.id,P,p,l,_,this.blurRadius),document.body.removeChild(S.canvas)}},u.Element.feGaussianBlur.prototype=new u.Element.ElementBase,u.Element.title=function(S){},u.Element.title.prototype=new u.Element.ElementBase,u.Element.desc=function(S){},u.Element.desc.prototype=new u.Element.ElementBase,u.Element.MISSING=function(S){u.log("ERROR: Element '"+S.nodeName+"' not yet implemented.")},u.Element.MISSING.prototype=new u.Element.ElementBase,u.CreateElement=function(S){var P=S.nodeName.replace(/^[^:]+:/,"");P=P.replace(/\-/g,"");var E=null;return E=void 0!==u.Element[P]?new u.Element[P](S):new u.Element.MISSING(S),E.type=S.nodeName,E},u.load=function(S,P){u.loadXml(S,u.ajax(P))},u.loadXml=function(S,P){u.loadXmlDoc(S,u.parseXml(P))},u.loadXmlDoc=function(P,E){u.init(P);var p=function(E){for(var p=P.canvas;p;)E.x-=p.offsetLeft,E.y-=p.offsetTop,p=p.offsetParent;return S.scrollX&&(E.x+=S.scrollX),S.scrollY&&(E.y+=S.scrollY),E};1!=u.opts.ignoreMouse&&(P.canvas.onclick=function(S){var P=p(new u.Point(null!=S?S.clientX:event.clientX,null!=S?S.clientY:event.clientY));u.Mouse.onclick(P.x,P.y)},P.canvas.onmousemove=function(S){var P=p(new u.Point(null!=S?S.clientX:event.clientX,null!=S?S.clientY:event.clientY));u.Mouse.onmousemove(P.x,P.y)});var l=u.CreateElement(E.documentElement);l.root=!0,l.addStylesFromStyleDefinition();var _=!0,m=function(){u.ViewPort.Clear(),P.canvas.parentNode&&u.ViewPort.SetCurrent(P.canvas.parentNode.clientWidth,P.canvas.parentNode.clientHeight),1!=u.opts.ignoreDimensions&&(l.style("width").hasValue()&&(P.canvas.width=l.style("width").toPixels("x"),P.canvas.style.width=P.canvas.width+"px"),l.style("height").hasValue()&&(P.canvas.height=l.style("height").toPixels("y"),P.canvas.style.height=P.canvas.height+"px"));var S=P.canvas.clientWidth||P.canvas.width,p=P.canvas.clientHeight||P.canvas.height;if(1==u.opts.ignoreDimensions&&l.style("width").hasValue()&&l.style("height").hasValue()&&(S=l.style("width").toPixels("x"),p=l.style("height").toPixels("y")),u.ViewPort.SetCurrent(S,p),null!=u.opts.offsetX&&(l.attribute("x",!0).value=u.opts.offsetX),null!=u.opts.offsetY&&(l.attribute("y",!0).value=u.opts.offsetY),null!=u.opts.scaleWidth||null!=u.opts.scaleHeight){var m=null,F=null,f=u.ToNumberArray(l.attribute("viewBox").value);null!=u.opts.scaleWidth&&(l.attribute("width").hasValue()?m=l.attribute("width").toPixels("x")/u.opts.scaleWidth:isNaN(f[2])||(m=f[2]/u.opts.scaleWidth)),null!=u.opts.scaleHeight&&(l.attribute("height").hasValue()?F=l.attribute("height").toPixels("y")/u.opts.scaleHeight:isNaN(f[3])||(F=f[3]/u.opts.scaleHeight)),null==m&&(m=F),null==F&&(F=m),l.attribute("width",!0).value=u.opts.scaleWidth,l.attribute("height",!0).value=u.opts.scaleHeight,l.style("transform",!0,!0).value+=" scale("+1/m+","+1/F+")"}1!=u.opts.ignoreClear&&P.clearRect(0,0,S,p),l.render(P),_&&(_=!1,"function"==typeof u.opts.renderCallback&&u.opts.renderCallback(E))},F=!0;u.ImagesLoaded()&&(F=!1,m()),u.intervalID=setInterval(function(){var S=!1;if(F&&u.ImagesLoaded()&&(F=!1,S=!0),1!=u.opts.ignoreMouse&&(S|=u.Mouse.hasEvents()),1!=u.opts.ignoreAnimation)for(var P=0;P<u.Animations.length;P++)S|=u.Animations[P].update(1e3/u.FRAMERATE);"function"==typeof u.opts.forceRedraw&&1==u.opts.forceRedraw()&&(S=!0),S&&(m(),u.Mouse.runEvents())},1e3/u.FRAMERATE)},u.stop=function(){u.intervalID&&clearInterval(u.intervalID)},u.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(S,P){this.events.push({type:"onclick",x:S,y:P,run:function(S){S.onclick&&S.onclick()}})},this.onmousemove=function(S,P){this.events.push({type:"onmousemove",x:S,y:P,run:function(S){S.onmousemove&&S.onmousemove()}})},this.eventElements=[],this.checkPath=function(S,P){for(var E=0;E<this.events.length;E++){var p=this.events[E];P.isPointInPath&&P.isPointInPath(p.x,p.y)&&(this.eventElements[E]=S)}},this.checkBoundingBox=function(S,P){for(var E=0;E<this.events.length;E++){var p=this.events[E];P.isPointInBox(p.x,p.y)&&(this.eventElements[E]=S)}},this.runEvents=function(){u.ctx.canvas.style.cursor="";for(var S=0;S<this.events.length;S++)for(var P=this.events[S],E=this.eventElements[S];E;)P.run(E),E=E.parent;this.events=[],this.eventElements=[]}},u}var m,u=function(S,P,E){if(null!=S||null!=P||null!=E){"string"==typeof S&&(S=document.getElementById(S)),null!=S.svg&&S.svg.stop();var p=_(E||{});1==S.childNodes.length&&"OBJECT"==S.childNodes[0].nodeName||(S.svg=p);var l=S.getContext("2d");void 0!==P.documentElement?p.loadXmlDoc(l,P):"<"==P.substr(0,1)?p.loadXml(l,P):p.load(l,P)}else for(var m=document.querySelectorAll("svg"),F=0;F<m.length;F++){var f=m[F],H=document.createElement("canvas");H.width=f.clientWidth,H.height=f.clientHeight,f.parentNode.insertBefore(H,f),f.parentNode.removeChild(f);var T=document.createElement("div");T.appendChild(f),u(H,T.innerHTML)}};void 0!==Element.prototype.matches?m=function(S,P){return S.matches(P)}:void 0!==Element.prototype.webkitMatchesSelector?m=function(S,P){return S.webkitMatchesSelector(P)}:void 0!==Element.prototype.mozMatchesSelector?m=function(S,P){return S.mozMatchesSelector(P)}:void 0!==Element.prototype.msMatchesSelector?m=function(S,P){return S.msMatchesSelector(P)}:void 0!==Element.prototype.oMatchesSelector?m=function(S,P){return S.oMatchesSelector(P)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(m=function(S,P){return $(S).is(P)}),void 0===m&&(m=Sizzle.matchesSelector));var F=/(\[[^\]]+\])/g,f=/(#[^\s\+>~\.\[:]+)/g,H=/(\.[^\s\+>~\.\[:]+)/g,T=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,X=/(:[\w-]+\([^\)]*\))/gi,W=/(:[^\s\+>~\.\[:]+)/g,h=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(S,P,E,p,l,_){var m={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:P,offsetY:E,scaleWidth:p,scaleHeight:l};for(var F in _)_.hasOwnProperty(F)&&(m[F]=_[F]);u(this.canvas,S,m)}),u}(P.RGBColor,P.stackBlur)}(void 0!==S?S:this)}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object),function(S,P,E){var p=S.ht,l=p.Default;l.getInternal().addMethod(l,{cadToShape:function(S,P){return new p.DxfViewer(P).toShape(S)},shapeToCad:function(S,P,E){return new p.DxfWriter(E).toDxf(S,P)}}),function(P){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=P();else if("function"==typeof define&&define.amd)define([],P);else{var E;E=void 0!==S?S:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,E.DxfParser=P()}}(function(){var p;return function S(P,E,p){function l(m,u){if(!E[m]){if(!P[m]){var F="function"==typeof require&&require;if(!u&&F)return F(m,!0);if(_)return _(m,!0);var f=new Error("Cannot find module '"+m+"'");throw f.code="MODULE_NOT_FOUND",f}var H=E[m]={exports:{}};P[m][0].call(H.exports,function(S){var E=P[m][1][S];return l(E||S)},H,H.exports,S,P,E,p)}return E[m].exports}for(var _="function"==typeof require&&require,m=0;m<p.length;m++)l(p[m]);return l}({1:[function(S,P,E){P.exports=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215]},{}],2:[function(S,P,E){function p(S){this._pointer=0,this._data=S,this._eof=!1}function l(S,P){return S<=9?P:S>=10&&S<=59?parseFloat(P):S>=60&&S<=99?parseInt(P):S>=100&&S<=109?P:S>=110&&S<=149?parseFloat(P):S>=160&&S<=179?parseInt(P):S>=210&&S<=239?parseFloat(P):S>=270&&S<=289?parseInt(P):S>=290&&S<=299?_(P):S>=300&&S<=369?P:S>=370&&S<=389?parseInt(P):S>=390&&S<=399?P:S>=400&&S<=409?parseInt(P):S>=410&&S<=419?P:S>=420&&S<=429?parseInt(P):S>=430&&S<=439?P:S>=440&&S<=459?parseInt(P):S>=460&&S<=469?parseFloat(P):S>=470&&S<=481?P:999===S?P:S>=1e3&&S<=1009?P:S>=1010&&S<=1059?parseFloat(P):S>=1060&&S<=1071?parseInt(P):(console.log("WARNING: Group code does not have a defined type: %j",{code:S,value:P}),P)}function _(S){if("0"===S)return!1;if("1"===S)return!0;throw TypeError("String '"+S+"' cannot be cast to Boolean type")}p.prototype.next=function(){var S;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return S={code:parseInt(this._data[this._pointer])},this._pointer++,S.value=l(S.code,this._data[this._pointer].trim()),this._pointer++,0===S.code&&"EOF"===S.value&&(this._eof=!0),S},p.prototype.hasNext=function(){return!(this._eof||this._pointer>this._data.length-2)},p.prototype.isEOF=function(){return this._eof},P.exports=p},{}],3:[function(S,p,l){function _(S){S&&S.sanitize!==E&&(this.sanitize=S.sanitize)}function m(S){T.debug("unhandled group "+u(S))}function u(S){return S.code+":"+S.value}function F(S){return H[S]}var f=S("./DxfArrayScanner.js"),H=S("./AutoCadColorIndex"),T=S("loglevel");T.setLevel("error"),_.prototype.parse=function(S,P){throw new Error("read() not implemented. Use readSync()")},_.prototype.parseSync=function(S){return"string"==typeof S?this._parse(S):(console.error("Cannot read dxf source of type `"+typeof S),null)},_.prototype.parseStream=function(S,P){function E(S){_+=S}function p(){try{var S=m._parse(_)}catch(S){return P(S)}P(null,S)}function l(S){P(S)}var _="",m=this;S.on("data",E),S.on("end",p),S.on("error",l)},_.prototype.sanitizeFileName=function(){var S=/[\/\?<>\\:\*\|":]/g,P=/[\x00-\x1f\x80-\x9f]/g,E=/^\.+$/,p=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,l=/[\. ]+$/;return function(_){var m=this.sanitize;return null==m?_:_.replace(S,m).replace(P,m).replace(E,m).replace(p,m).replace(l,m)}}(),_.prototype._parse=function(S){var p,l,_=this,H={},X=0,W=S.split(/\r\n|\r|\n/g);if(p=new f(W),!p.hasNext())throw Error("Empty file");var h=function(S,P){return l.code===S&&l.value===P},Q=function(){var S=null,P=null,E={};for(l=p.next();;){if(h(0,"ENDSEC")){S&&(E[S]=P);break}9===l.code?(S&&(E[S]=P),S=l.value):10===l.code?P={x:l.value}:20===l.code?P.y=l.value:30===l.code?P.z=l.value:P=l.value,l=p.next()}return l=p.next(),E},i=function(){var S,P={};for(l=p.next();"EOF"!==l.value&&!h(0,"ENDSEC");)h(0,"BLOCK")?(T.debug("block {"),S=a(),T.debug("}"),o(S),S.name?P[S.name]=S:T.error('block with handle "'+S.handle+'" is missing a name.')):(m(l),l=p.next());return P},a=function(){var S={};for(l=p.next();"EOF"!==l.value;){switch(l.code){case 1:S.xrefPath=l.value,l=p.next();break;case 2:S.name=_.sanitizeFileName(l.value),l=p.next();break;case 3:S.name2=_.sanitizeFileName(l.value),l=p.next();break;case 5:S.handle=l.value,l=p.next();break;case 8:S.layer=l.value,l=p.next();break;case 10:S.position=g();break;case 67:S.paperSpace=!(!l.value||1!=l.value),l=p.next();break;case 70:0!=l.value&&(S.type=l.value),l=p.next();break;case 100:l=p.next();break;case 330:S.ownerHandle=l.value,l=p.next();break;case 0:if("ENDBLK"==l.value)break;p._pointer-=2,S.entities=j(!0);break;default:m(l),l=p.next()}if(h(0,"ENDBLK")){l=p.next();break}}return S},s=function(){var S={};for(l=p.next();"EOF"!==l.value&&!h(0,"ENDSEC");)if(h(0,"TABLE")){l=p.next();var P=b[l.value];P?(T.debug(l.value+" Table {"),S[b[l.value].tableName]=k(),T.debug("}")):T.debug("Unhandled Table "+l.value)}else l=p.next();return l=p.next(),S},k=function(){var S,E=b[l.value],_={},u=0;for(l=p.next();!h(0,"ENDTAB");)switch(l.code){case 5:_.handle=l.value,l=p.next();break;case 330:_.ownerHandle=l.value,l=p.next();break;case 100:"AcDbSymbolTable"===l.value?l=p.next():(m(l),l=p.next());break;case 70:u=l.value,l=p.next();break;case 0:l.value===E.dxfSymbolName?_[E.tableRecordsProperty]=E.parseTableRecords():(m(l),l=p.next());break;default:m(l),l=p.next()}var F=_[E.tableRecordsProperty];return F&&(F.constructor===Array?S=F.length:"object"==typeof F&&(S=P.keys(F).length),u!==S&&T.warn("Parsed "+S+" "+E.dxfSymbolName+"'s but expected "+u)),l=p.next(),_},Y=function(){var S=[],P={};for(T.debug("ViewPort {"),l=p.next();!h(0,"ENDTAB");)switch(l.code){case 2:P.name=l.value,l=p.next();break;case 10:P.lowerLeftCorner=g();break;case 11:P.upperRightCorner=g();break;case 12:P.center=g();break;case 13:P.snapBasePoint=g();break;case 14:P.snapSpacing=g();break;case 15:P.gridSpacing=g();break;case 16:P.viewDirectionFromTarget=g();break;case 17:P.viewTarget=g();break;case 40:P.viewHeight=l.value,P.aspectRatio!==E&&(P.viewWidth=l.value*P.aspectRatio),l=p.next();break;case 41:P.aspectRatio=l.value,P.viewHeight!==E&&(P.viewWidth=l.value*P.viewHeight),l=p.next();break;case 42:P.lensLength=l.value,l=p.next();break;case 43:P.frontClippingPlane=l.value,l=p.next();break;case 44:P.backClippingPlane=l.value,l=p.next();break;case 45:P.viewHeight=l.value,l=p.next();break;case 50:P.snapRotationAngle=l.value,l=p.next();break;case 51:P.viewTwistAngle=l.value,l=p.next();break;case 79:P.orthographicType=l.value,l=p.next();break;case 110:P.ucsOrigin=g();break;case 111:P.ucsXAxis=g();break;case 112:P.ucsYAxis=g();break;case 110:P.ucsOrigin=g();break;case 281:P.renderMode=l.value,l=p.next();break;case 281:P.defaultLightingType=l.value,l=p.next();break;case 292:P.defaultLightingOn=l.value,l=p.next();break;case 330:P.ownerHandle=l.value,l=p.next();break;case 63:case 421:case 431:P.ambientColor=l.value,l=p.next();break;case 0:"VPORT"===l.value&&(T.debug("}"),S.push(P),T.debug("ViewPort {"),P={},l=p.next());break;default:m(l),l=p.next()}return T.debug("}"),S.push(P),S},x=function(){var S,P,E={},_={};for(T.debug("LType {"),l=p.next();!h(0,"ENDTAB");)switch(l.code){case 2:_.name=l.value,S=l.value,l=p.next();break;case 3:_.description=l.value,l=p.next();break;case 73:P=l.value,P>0&&(_.pattern=[]),l=p.next();break;case 40:_.patternLength=l.value,l=p.next();break;case 49:_.pattern.push(l.value),l=p.next();break;case 0:T.debug("}"),P>0&&P!==_.pattern.length&&T.warn("lengths do not match on LTYPE pattern"),E[S]=_,_={},T.debug("LType {"),l=p.next();break;default:l=p.next()}return T.debug("}"),E[S]=_,E},M=function(){var S,P={},_={};for(T.debug("Layer {"),l=p.next();!h(0,"ENDTAB");)switch(l.code){case 2:_.name=l.value,S=l.value,l=p.next();break;case 62:_.visible=l.value>=0,_.color=F(Math.abs(l.value)),l=p.next();break;case 6:_.lineType=l.value,l=p.next();break;case 0:"LAYER"===l.value&&(T.debug("}"),P[S]=_,T.debug("Layer {"),_={},S=E,l=p.next());break;default:m(l),l=p.next()}return T.debug("}"),P[S]=_,P},b={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:Y},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:x},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:M}},j=function(S){var P=[],E=S?"ENDBLK":"ENDSEC";for(l=p.next();;)if(0===l.code){if(l.value===E)break;var _;if("LWPOLYLINE"===l.value)T.debug("LWPOLYLINE {"),_=B(),T.debug("}");else if("POLYLINE"===l.value)T.debug("POLYLINE {"),_=K(),T.debug("}");else if("LINE"===l.value)T.debug("LINE {"),_=L(),T.debug("}");else if("CIRCLE"===l.value)T.debug("CIRCLE {"),_=e(),T.debug("}");else if("ARC"===l.value)T.debug("ARC {"),_=e(),T.debug("}");else if("ELLIPSE"===l.value)T.debug("ELLIPSE {"),_=r(),T.debug("}");else if("SPLINE"===l.value)T.debug("SPLINE {"),_=d(),T.debug("}");else if("TEXT"===l.value)T.debug("TEXT {"),_=A(),T.debug("}");else if("DIMENSION"===l.value)T.debug("DIMENSION {"),_=N(),T.debug("}");else if("INSERT"===l.value)T.debug("INSERT {"),_=q(),T.debug("}");else if("HATCH"===l.value)T.debug("HATCH {"),_=O(),T.debug("}");else if("SOLID"===l.value)T.debug("SOLID {"),_=Z(),T.debug("}");else if("POINT"===l.value)T.debug("POINT {"),_=C(),T.debug("}");else if("MTEXT"===l.value)T.debug("MTEXT {"),_=$(),T.debug("}");else{if("ATTDEF"!==l.value){T.warn("Unhandled entity "+l.value),l=p.next();continue}T.debug("ATTDEF {"),_=v(),T.debug("}")}o(_),P.push(_)}else l=p.next();return"ENDSEC"==E&&(l=p.next()),P},z=function(S){switch(l.code){case 0:S.type=l.value,l=p.next();break;case 5:S.handle=l.value,l=p.next();break;case 6:S.lineType=l.value,l=p.next();break;case 8:S.layer=l.value,l=p.next();break;case 48:S.lineTypeScale=l.value,l=p.next();break;case 60:S.visible=0===l.value,l=p.next();break;case 62:S.colorIndex=l.value,S.color=F(Math.abs(l.value)),l=p.next();break;case 67:S.inPaperSpace=0!==l.value,l=p.next();break;case 210:S.extrusionDirection=g();break;case 230:S.extrusionDirection={x:0,y:0,z:l.value},l=p.next();break;case 330:S.ownerHandle=l.value,l=p.next();break;case 347:S.materialObjectHandle=l.value,l=p.next();break;case 370:S.lineweight=l.value,l=p.next();break;case 420:S.color=l.value,l=p.next();break;case 100:if("AcDbEntity"==l.value){l=p.next();break}default:m(l),l=p.next()}},c=function(){var S={type:l.value};for(l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.x=l.value,l=p.next();break;case 20:S.y=l.value,l=p.next();break;case 30:S.z=l.value,l=p.next();break;case 40:case 41:case 42:l=p.next();break;case 70:S.curveFittingVertex=0!=(1|l.value),S.curveFitTangent=0!=(2|l.value),S.splineVertex=0!=(8|l.value),S.splineControlPoint=0!=(16|l.value),S.ThreeDPolylineVertex=0!=(32|l.value),S.ThreeDPolylineMesh=0!=(64|l.value),S.polyfaceMeshVertex=0!=(128|l.value),l=p.next();break;case 50:case 71:case 72:case 73:case 74:l=p.next();break;default:z(S)}return S},V=function(){var S={type:l.value};for(l=p.next();"EOF"!=l&&0!=l.code;)z(S);return S},g=function(){var S={},P=l.code;if(S.x=l.value,P+=10,l=p.next(),l.code!=P)throw new Error("Expected code for point value to be "+P+" but got "+l.code+".");return S.y=l.value,P+=10,l=p.next(),l.code!=P?S:(S.z=l.value,l=p.next(),S)},R=function(){var S={},P=l.code;return S.x=l.value,P+=1,l=p.next(),l.code!=P?(p._pointer-=2,S.y=1):S.y=l.value,P+=1,l=p.next(),l.code!=P?(p._pointer-=2,S.z=1):S.z=l.value,l=p.next(),S},G=function(S){if(!S||S<=0)throw Error("n must be greater than 0 verticies");var P,E=[],_=!1,m=!1;for(P=0;P<S;P++){for(var u={};"EOF"!==l&&0!==l.code&&!m;){switch(l.code){case 10:if(_){m=!0;continue}u.x=l.value,_=!0;break;case 20:u.y=l.value;break;case 30:u.z=l.value;break;case 40:u.startWidth=l.value;break;case 41:u.endWidth=l.value;break;case 42:0!=l.value&&(u.bulge=l.value);break;default:if(_){m=!0;continue}continue}l=p.next()}E.push(u),_=!1,m=!1}return E},J=function(){for(var S=[];"EOF"!==l;)if(0===l.code)if("VERTEX"===l.value)S.push(c());else if("SEQEND"===l.value){V();break}return S},$=function(){var S={type:l.value};for(l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 1:S.text=l.value,l=p.next();break;case 3:S.text+=l.value,l=p.next();break;case 10:S.position=g();break;case 40:S.height=l.value,l=p.next();break;case 41:S.width=l.value,l=p.next();break;case 71:S.attachmentPoint=l.value,l=p.next();break;case 72:S.drawingDirection=l.value,l=p.next();break;case 50:S.angle=2*l.value*Math.PI/360,l=p.next();break;case 11:S.directionX=l.value,l=p.next();break;case 21:S.directionY=l.value,l=p.next();break;default:z(S)}return S},v=function(){var S={type:l.value,scale:1,textStyle:"STANDARD"}
;for(l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 1:S.text=l.value,l=p.next();break;case 2:S.tag=l.value,l=p.next();break;case 3:S.prompt=l.value,l=p.next();break;case 7:S.textStyle=l.value,l=p.next();break;case 10:S.x=l.value,l=p.next();break;case 20:S.y=l.value,l=p.next();break;case 30:S.z=l.value,l=p.next();break;case 39:S.thickness=l.value,l=p.next();break;case 40:S.textHeight=l.value,l=p.next();break;case 41:S.scale=l.value,l=p.next();break;case 50:S.rotation=l.value,l=p.next();break;case 51:S.obliqueAngle=l.value,l=p.next();break;case 70:S.invisible=!!(1&l.value),S.constant=!!(2&l.value),S.verificationRequired=!!(4&l.value),S.preset=!!(8&l.value),l=p.next();break;case 71:S.backwards=!!(2&l.value),S.mirrored=!!(4&l.value),l=p.next();break;case 72:S.horizontalJustification=l.value,l=p.next();break;case 73:S.fieldLength=l.value,l=p.next();break;case 74:S.verticalJustification=l.value,l=p.next();break;case 100:l=p.next();break;case 210:S.extrusionDirectionX=l.value,l=p.next();break;case 220:S.extrusionDirectionY=l.value,l=p.next();break;case 230:S.extrusionDirectionZ=l.value,l=p.next();break;default:z(S)}return S},B=function(){var S={type:l.value,vertices:[]},P=0;for(l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 38:S.elevation=l.value,l=p.next();break;case 39:S.depth=l.value,l=p.next();break;case 70:S.shape=1===l.value,l=p.next();break;case 90:P=l.value,l=p.next();break;case 10:S.vertices=G(P);break;case 40:0!==l.value&&(S.startWidth=l.value),l=p.next();break;case 41:0!==l.value&&(S.endWidth=l.value),l=p.next();break;case 43:0!==l.value&&(S.width=l.value),l=p.next();break;default:z(S)}return S},K=function(){var S={type:l.value,vertices:[]};for(l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:case 20:case 30:case 39:l=p.next();break;case 40:0!==l.value&&(S.startWidth=l.value),l=p.next();break;case 41:0!==l.value&&(S.endWidth=l.value),l=p.next();break;case 70:S.shape=1===l.value,l=p.next();break;case 71:case 72:case 73:case 74:case 75:case 100:l=p.next();break;default:z(S)}return S.vertices=J(),S},L=function(){var S={type:l.value,vertices:[]};for(l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.vertices.unshift(g());break;case 11:S.vertices.push(g());break;case 100:if("AcDbLine"==l.value){l=p.next();break}default:z(S)}return S},e=function(){var S,P;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.center=g();break;case 40:S.radius=l.value,l=p.next();break;case 50:S.startAngle=Math.PI/180*l.value,l=p.next();break;case 51:P=Math.PI/180*l.value,P<S.startAngle?S.angleLength=P+2*Math.PI-S.startAngle:S.angleLength=P-S.startAngle,S.endAngle=P,l=p.next();break;default:z(S)}return S},r=function(){var S,P;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.center=g();break;case 11:S.major=g();break;case 40:S.ratio=l.value,l=p.next();break;case 41:S.startAngle=l.value,l=p.next();break;case 42:P=l.value,P<S.startAngle?S.angleLength=P+2*Math.PI-S.startAngle:S.angleLength=P-S.startAngle,S.endAngle=P,l=p.next();break;default:z(S)}return S},q=function(){var S;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 2:S.block=_.sanitizeFileName(l.value),l=p.next();break;case 10:S.center=g();break;case 41:S.scale=R();break;case 50:S.deg=l.value,l=p.next();break;default:z(S)}return S},O=function(){var S;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 2:S.block=_.sanitizeFileName(l.value),l=p.next();break;case 10:S.center=g();break;case 41:S.scale=R();break;case 50:S.deg=l.value,l=p.next();break;default:z(S)}return S},d=function(){var S,P;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.center=g();break;case 11:S.major=g();break;case 40:S.ratio=l.value,l=p.next();break;case 41:S.startAngle=l.value,l=p.next();break;case 42:P=l.value,P<S.startAngle?S.angleLength=P+2*Math.PI-S.startAngle:S.angleLength=P-S.startAngle,S.endAngle=P,l=p.next();break;default:z(S)}return S},A=function(){var S;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.startPoint=g();break;case 11:S.endPoint=g();break;case 40:S.textHeight=l.value,l=p.next();break;case 41:S.xScale=l.value,l=p.next();break;case 1:S.text=l.value,l=p.next();break;case 7:S.font=l.value,l=p.next();break;case 71:S.generationFlags=l.value,l=p.next();break;case 72:S.halign=l.value,l=p.next();break;case 73:S.valign=l.value,l=p.next();break;case 50:S.rotation=2*l.value*Math.PI/360,l=p.next();break;default:z(S)}return S},N=function(){var S;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 2:S.block=_.sanitizeFileName(l.value),l=p.next();break;case 10:S.anchorPoint=g();break;case 11:S.middleOfText=g();break;case 71:S.attachmentPoint=l.value,l=p.next();break;case 42:S.actualMeasurement=l.value,l=p.next();break;case 1:S.text=l.value,l=p.next();break;case 50:S.angle=l.value,l=p.next();break;default:z(S)}return S},Z=function(){var S;for(S={type:l.value},S.points=[],l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.points[0]=g();break;case 11:S.points[1]=g();break;case 12:S.points[2]=g();break;case 13:S.points[3]=g();break;default:z(S)}return S},C=function(){var S;for(S={type:l.value},l=p.next();"EOF"!==l&&0!==l.code;)switch(l.code){case 10:S.position=g();break;case 39:S.thickness=l.value,l=p.next();break;case 100:if("AcDbPoint"==l.value){l=p.next();break}default:z(S)}return S},o=function(S){if(!S)throw new TypeError("entity cannot be undefined or null");S.handle||(S.handle=X++)};return function(){for(l=p.next();!p.isEOF();)if(0===l.code&&"SECTION"===l.value){if(l=p.next(),2!==l.code){console.error("Unexpected code %s after 0:SECTION",u(l)),l=p.next();continue}"HEADER"===l.value?(T.debug("> HEADER"),H.header=Q(),T.debug("<")):"BLOCKS"===l.value?(T.debug("> BLOCKS"),H.blocks=i(),T.debug("<")):"ENTITIES"===l.value?(T.debug("> ENTITIES"),H.entities=j(!1),T.debug("<")):"TABLES"===l.value?(T.debug("> TABLES"),H.tables=s(),T.debug("<")):"EOF"===l.value?T.debug("EOF"):T.warn("Skipping section '%s'",l.value)}else l=p.next()}(),H},p.exports=_},{"./AutoCadColorIndex":1,"./DxfArrayScanner.js":2,loglevel:4}],4:[function(P,l,_){!function(S,E){"object"==typeof l&&l.exports&&"function"==typeof P?l.exports=E():"function"==typeof p&&"object"==typeof p.amd?p(E):S.log=E()}(this,function(){function P(S){return typeof console!==f&&(console[S]!==E?p(console,S):console.log!==E?p(console,"log"):F)}function p(S,P){var E=S[P];if("function"==typeof E.bind)return E.bind(S);try{return Function.prototype.bind.call(E,S)}catch(P){return function(){return Function.prototype.apply.apply(E,[S,arguments])}}}function l(S,P){return function(){typeof console!==f&&(_(P),u[S].apply(u,arguments))}}function _(S){for(var P=0;P<H.length;P++){var E=H[P];u[E]=P<S?F:u.methodFactory(E,S)}}function m(P){var E=(H[P]||"silent").toUpperCase();try{return void(S.localStorage.loglevel=E)}catch(S){}try{S.document.cookie="loglevel="+E+";"}catch(S){}}var u={},F=function(){},f="undefined",H=["trace","debug","info","warn","error"];u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=function(S,E){return P(S)||l(S,E)},u.setLevel=function(S,P){if("string"==typeof S&&u.levels[S.toUpperCase()]!==E&&(S=u.levels[S.toUpperCase()]),!("number"==typeof S&&S>=0&&S<=u.levels.SILENT))throw"log.setLevel() called with invalid level: "+S;if(!1!==P&&m(S),_(S),typeof console===f&&S<u.levels.SILENT)return"No console available for logging"},u.enableAll=function(S){u.setLevel(u.levels.TRACE,S)},u.disableAll=function(S){u.setLevel(u.levels.SILENT,S)};var T=typeof S!==f?S.log:E;return u.noConflict=function(){return typeof S!==f&&S.log===u&&(S.log=T),u},function(){var P;try{P=S.localStorage.loglevel}catch(S){}if(typeof P===f)try{P=/loglevel=([^;]+)/.exec(S.document.cookie)[1]}catch(S){}u.levels[P]===E&&(P="WARN"),u.setLevel(u.levels[P],!1)}(),u})},{}]},{},[3])(3)});var _=p.DxfViewer=function(S){this.init(S)};_.prototype={},_.prototype.constructor=_;var m={LINE:["LINE","POLYLINE","LWPOLYLINE"],CIRCLE:["CIRCLE","ARC"],ELLIPSE:["ELLIPSE"],TEXT:["TEXT","MTEXT"],SOLID:["SOLID"],POINT:["POINT"]};P.defineProperties(_.prototype,{dxf:{get:function(){return this._dxf}}}),_.prototype.init=function(S){var P=this,E=P.options={};S=S||{},E.font=S.font||"Standard",E.textScaleRatio=S.textScaleRatio||1,E.size=S.size,E.scale=S.scale,E.blockSize=S.blockSize||256,E.filter=S.filter,E.defaultColor=S.defaultColor||0,E.edgeLayer=S.edgeLayer,E.showText=S.showText||!0,E.mapColor=S.mapColor,E.circleSegments=S.circleSegments||72,E.browserMinFontSize=S.browserMinFontSize||8,E.useDxfViewport=S.useDxfViewport||!0,!1!==S.sanitize&&(E.sanitize=S.sanitize||"_")},_.prototype.toShape=function(S){var P=this;P.parseFile(S);var E,p,l,_=P._dxf.blocks,m=P.sortBlocks(_);P._blockDef={};for(var u=m.length-1;u>=0;u--)p=m[u],l=_[p],l.entities&&(P._blockDef[p]||(E=P.entitiesToShape(l.entities,l.position,null,!1))&&(E.flag=l.type,P._blockDef[p]=E));return E=P.entitiesToShape(P._dxf.entities,null,P.options.size,!0,P.options.scale),E.sortedBlockName=m,E.blockDef=P._blockDef,E.layers=P._dxf.tables.layer.layers,E},_.prototype.entitiesToShape=function(S,P,E,p,l){var _=this;_._minFontSize=12,_._bound={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0},P=P||{x:0,y:0,z:0};var m,u,F,f=_._models={},H=_._dxf;for(m=0,u=S.length;m<u;m++)F=S[m],_._groupEntity(f,F,H);if(p&&_.options.useDxfViewport){var T=_._dxfViewport;_._bound={xMin:T.x-T.width/2,xMax:T.x+T.width/2,yMin:T.y-T.height/2,yMax:T.y+T.height/2}}_._shiftX=_._bound.xMin,_._shiftY=_._bound.yMax;var X=_._bound.xMax-_._bound.xMin,W=_._bound.yMax-_._bound.yMin;if(!(X<0||W<0)){if(X=X||1,W=W||1,_._bound.pos=P,l)_._scale=l;else{if(E){var h=E/X,Q=E/W;_._scale=Math.min(h,Q)}else _._scale=1;_._scale*=Math.max(1,Math.ceil(_.options.browserMinFontSize/_._minFontSize))}_.shapeComps=[],_.drawLine(),_.drawSolid(),_.drawCircle(),_.drawEllipse(),_.options.showText&&_.drawText(),_.drawBlock();var i={width:X*_._scale,height:W*_._scale,comps:_.shapeComps,scale:_._scale,anchorX:-(_._bound.xMin-P.x)/X,anchorY:(_._bound.yMax-P.y)/W,bound:_._bound};return _._calcBoundExtend(i),i}},_.prototype._calcBoundExtend=function(S){var P=1,E=!1;S.comps.forEach(function(S){P=Math.max(P,S.borderWidth||0),S.borderWidthAbsolute&&(E=!0)}),S.boundExtend=P,E&&(S.boundExtendAbsolute=!0)},_.prototype._bulgesAt=function(S,P){return S[P].bulge},_.prototype._isStraightLine=function(S){return!S||Math.abs(S)<1e-6},_.prototype._getDistance=function(S,P){var E=S.x-P.x,p=S.y-P.y;return Math.sqrt(E*E+p*p)},_.prototype._getBulgeSegment=function(S,P,E){var p=this,l=E<0,_=4*Math.atan(E);if(Math.abs(_)>2*Math.PI-1e-6)return[P];var m={x:(S.x+P.x)/2,y:(S.y+P.y)/2},u=p._getDistance(S,P)/2,F=Math.atan2(P.y-S.y,P.x-S.x),f=Math.abs(u/Math.sin(_/2)),H=Math.abs(f*f-u*u),T=Math.sqrt(H);E>0?F+=Math.PI/2:F-=Math.PI/2,Math.abs(_)>Math.PI&&(T*=-1);var X,F,W=T*Math.cos(F)+m.x,h=T*Math.sin(F)+m.y,Q=Math.atan2(S.y-h,S.x-W),i=Math.atan2(P.y-h,P.x-W),a=[];if(X=2*Math.PI/p.options.circleSegments,F=Q,l){for(;i>Q;)i-=2*Math.PI;for(;F>i;)F-=X,F<i&&(F=i),a.push({x:W+f*Math.cos(F),y:h+f*Math.sin(F)})}else{for(;i<Q;)i+=2*Math.PI;for(;F<i;)F+=X,F>i&&(F=i),a.push({x:W+f*Math.cos(F),y:h+f*Math.sin(F)})}return a},_.prototype.drawLine=function(){var S,P,p,l,_,u,F,f,H,T,X,W,h,Q,i,a,s,k,Y,x,M=this,b=M._models;for(S=m.LINE,l=0,_=S.length;l<_;l++){P=S[l],p=b[P];for(f in p)for(H=p[f],u=0,F=H.length;u<F;u++)if(T=H[u],(X=T.vertices)&&X.length){for(i=M.toLocal(X[0].x,1),a=M.toLocal(X[0].y,2),k={type:"shape",cadType:P,maybeEdge:T.layer===M.options.edgeLayer,borderColor:f,points:[i,a],segments:[1]},x=E,T.startWidth?x=(T.startWidth+(T.endWidth?T.endWidth:T.startWidth))/2:T.width&&(x=T.width),x?k.borderWidth=M.toLocal(x):(k.borderWidthAbsolute=!0,k.borderWidth=1),h=1,Q=X.length;h<Q;h++)W=X[h],s=M._bulgesAt(X,h-1),M._isStraightLine(s)?(k.points.push(M.toLocal(W.x,1),M.toLocal(W.y,2)),k.segments.push(2)):(Y=M._getBulgeSegment(X[h-1],W,s),Y.forEach(function(S){k.points.push(M.toLocal(S.x,1),M.toLocal(S.y,2)),k.segments.push(2)}));T.shape&&(s=M._bulgesAt(X,X.length-1),M._isStraightLine(s)?k.segments.push(5):(Y=M._getBulgeSegment(X[X.length-1],X[0],s),Y.forEach(function(S){k.points.push(M.toLocal(S.x,1),M.toLocal(S.y,2)),k.segments.push(2)}))),k.handle=T.handle,M.shapeComps.push(k)}}},_.prototype.drawBlock=function(){var S,P,E,p,l,_,m,u,F,f,H,T,X=this,W=X._models.BLOCK;if(W)for(S=0,P=W.length;S<P;S++)E=W[S],p=E.block,l=X._blockDef[p],H=E.transform,_=Math.atan2(H.b,H.a),_===Math.PI||0===_?(F=Math.cos(_),m=H.a/F,u=H.d/F):(f=Math.sin(_),m=H.b/f,u=-H.c/f),T={type:"image",cadType:"block",handle:E.handle,name:p,rect:[[X.toLocal(H.tx,1),X.toLocal(H.ty,2)],X.toLocal(l.width/l.scale),X.toLocal(l.height/l.scale)],rotation:_},1===m&&1===u||(T.scaleX=m,T.scaleY=u),X.shapeComps.push(T)},_.prototype.drawSolid=function(){var S,P,E,p,l,_,u,F,f,H,T,X=this,W=X._models;for(S=m.SOLID,p=0,l=S.length;p<l;p++){P=S[p],E=W[P];for(F in E)for(f=E[F],_=0,u=f.length;_<u;_++)H=f[_],T=H.points,X.shapeComps.push({type:"shape",cadType:P,handle:H.handle,background:F,points:[X.toLocal(T[0].x,1),X.toLocal(T[0].y,2),X.toLocal(T[1].x,1),X.toLocal(T[1].y,2),X.toLocal(T[3].x,1),X.toLocal(T[3].y,2),X.toLocal(T[2].x,1),X.toLocal(T[2].y,2)],segments:[1,2,2,2,5]})}},_.prototype.extrusionZNagative=function(S){var P=S.extrusionDirection;return!!P&&Math.abs(P.z+1)<1e-5},_.prototype.drawCircle=function(){var S,P,E,p,l,_,u,F,f,H,T,X,W,h,Q,i,a,s,k,Y,x=this,M=x._models;for(S=m.CIRCLE,p=0,l=S.length;p<l;p++){P=S[p],E=M[P];for(F in E)for(f=E[F],_=0,u=f.length;_<u;_++){if(H=f[_],T=H.startAngle||0,X=H.angleLength||2*Math.PI,W=T+X,h=x.toLocal(H.radius),Q=H.addonAngle||0,i=x.toLocal(H.center.x,1),a=x.toLocal(H.center.y,2),Y=H.xInvert^x.extrusionZNagative(H),k=H.yInvert,k||Y?Y&&k?(T=Math.PI+T,W=Math.PI+W,s=!1):(T=Math.PI*(Y?1:2)-T,W=Math.PI*(Y?1:2)-W,s=!0):s=!1,s=!s,T=2*Math.PI-T-Q,W=2*Math.PI-W-Q,s){var b=T;T=W,W=b}x.shapeComps.push({type:"arc",cadType:P,handle:H.handle,borderColor:F,borderWidth:1,borderWidthAbsolute:!0,rect:[i-h,a-h,2*h,2*h],arcFrom:T,arcTo:W,arcClose:!1})}}},_.prototype.drawText=function(){var S,P,E,p,l,_,u,F,f,H,T,X,W,h,Q,i,a,s,k,Y,x,M,b,j,z,c=this,V=c._models;for(S=m.TEXT,j=c.options.textScaleRatio,p=0,l=S.length;p<l;p++){P=S[p],E=V[P];for(F in E)for(f=E[F],_=0,u=f.length;_<u;_++)if(H=f[_],(T=H.text)&&T.length){if("MTEXT"===P)X=c.toLocal(H.height||12),W=c.toLocal(H.position.x,1),h=c.toLocal(H.position.y,2),Y=H.angle?H.angle:H.directionX?Math.atan2(H.directionY,H.directionX):0,Y+=H.addonAngle||0,b=1,k=H.attachmentPoint||1,a=k%3,s=Math.floor(k/3),s=1===s?"middle":0===s?"top":"bottom",i=0===a?"right":2===a?"center":"left";else{X=c.toLocal(H.textHeight||12);var g=H.endPoint;g||(g=H.startPoint),W=g.x,h=g.y,Y=H.rotation||0,b=H.xScale||1,2===H.generationFlags?Y=2*Math.PI-Y:4===H.generationFlags?Y=Math.PI-Y:6===H.generationFlags&&(Y=Math.PI+Y),W=c.toLocal(W,1),h=c.toLocal(h,2),a=H.halign,s=H.valign,i=2===a?"right":1===a?"center":"left",s=3===s?"top":2===s?"middle":"bottom"}h+=X/4;if(Y=2*Math.PI-Y,Q=X*j+"px "+(H.font||c.options.font),"MTEXT"===P)for(T=T.replace(/\\{/g,"#@#"),T=T.replace(/\\}/g,"#@@"),T=T.replace(/({|})/g,""),T=T.replace(/#@#/g,"{"),T=T.replace(/#@@/g,"}"),T=T.replace(/\\[ACT]\d+;/g,""),(z=T.match(/\\f[^;]*;/))&&(T=T.replace(z[0],""),(z=z[0].match(/\|p(\d+)/))&&(Q=z[0]/10*X*j+"px "+Q)),h-=X/6,x=T.split("\\P"),M=0;M<x.length;M++)c.shapeComps.push({type:"text",cadType:P,handle:H.handle,color:F,text:x[M],rotation:Y,rect:[W,h+M*X*1.5,0,0],align:i,vAlign:s,font:Q});else c.shapeComps.push({type:"text",cadType:P,handle:H.handle,color:F,text:T,scaleX:b,rotation:Y,rect:[W,h,1e-5,1e-5],align:i,vAlign:s,font:Q})}}},_.prototype.drawEllipse=function(){var S,P,E,p,l,_,u,F,f,H,T,X,W,h,Q,i,a,s,k,Y,x,M,b=this,j=b._models;for(S=m.ELLIPSE,p=0,l=S.length;p<l;p++){P=S[p],E=j[P];for(F in E)for(f=E[F],_=0,u=f.length;_<u;_++){if(H=f[_],T=H.major,X=Math.atan2(T.y,T.x),W=b.toLocal(Math.sqrt(T.x*T.x+T.y*T.y)),h=W*H.ratio,Q=H.startAngle||0,i=H.angleLength||2*Math.PI,a=Q+i,s=b.toLocal(H.center.x,1),k=b.toLocal(H.center.y,2),Y=H.xInvert,x=H.yInvert^b.extrusionZNagative(H),x^=1,x||Y?Y&&x?(Q=Math.PI+Q,a=Math.PI+a,M=!1):(Q=Math.PI*(Y?1:2)-Q,a=Math.PI*(Y?1:2)-a,M=!0):M=!1,M){var z=Q;Q=a,a=z}X=2*Math.PI-X,b.shapeComps.push({type:"arc",cadType:P,handle:H.handle,borderColor:F,borderWidth:1,borderWidthAbsolute:!0,rotation:X,rect:[s-W,k-h,2*W,2*h],arcFrom:Q,arcTo:a,arcClose:!1,arcOval:!0})}}},_.prototype._transformPoint=function(S,P,E){if(S){var p=S.x,l=S.y;return E=E||1,{x:p*E*P.a+l*P.c+P.tx,y:p*E*P.b+l*P.d+P.ty}}},_.prototype._groupEntity=function(S,P,E,p,l){var _=this,m=_.getColor(P,E);if(m&&(!_.options.filter||!_.options.filter(P,l))){var u,F,f,H=_._transformPoint,T=P.type;if("DIMENSION"===T||"INSERT"===T){if(!P.block)return;if(_.extrusionZNagative(P))return;var X=E.blocks[P.block];if(!X||!X.entities)return;if(!(f=_._blockDef[P.block]))return void console.log("no entity ",P.block);var W=p||{a:1,b:0,c:0,d:1,tx:0,ty:0};if("INSERT"===T){var h=P.scale?P.scale.x:1,Q=P.scale?P.scale.y:1,i=0,a=1,s=0;if(P.deg&&(i=P.deg*Math.PI/180,i=2*Math.PI-i,a=Math.cos(i),s=Math.sin(i)),p){var k=h*a,Y=h*s,x=-Q*s,M=Q*a,b=P.center.x,j=P.center.y;W={a:p.a*k+p.c*Y,b:p.b*k+p.d*Y,c:p.a*x+p.c*M,d:p.b*x+p.d*M,tx:p.a*b+p.c*j+p.tx,ty:p.b*b+p.d*j+p.ty}}else W={a:h*a,b:h*s,c:-Q*s,d:Q*a,tx:P.center.x,ty:P.center.y}}var z=f.bound,c=(z.pos.x,z.pos.y,H({x:z.xMin,y:z.yMin},W)),V=H({x:z.xMax,y:z.yMax},W),g=H({x:z.xMin,y:z.yMax},W),R=H({x:z.xMax,y:z.yMin},W),G=_._bound;G.xMin=Math.min(G.xMin,c.x,V.x,g.x,R.x),G.yMin=Math.min(G.yMin,c.y,V.y,g.y,R.y),G.xMax=Math.max(G.xMax,c.x,V.x,g.x,R.x),G.yMax=Math.max(G.yMax,c.y,V.y,g.y,R.y);var J;return(J=_._models.BLOCK)||(_._models.BLOCK=J=[]),void J.push({handle:P.handle,block:P.block,transform:W})}(u=S[T])||(u=S[T]={}),(F=u[m])||(F=u[m]=[]);var $=_.extrusionZNagative(P)&&["POINT","LINE","ELLIPSE"].indexOf(T)<0;if(p||$){p||(p={a:1,b:0,c:0,d:1,tx:0,ty:0});var v={};for(var B in P)v[B]=P[B];v.radius&&(v.radius*=Math.sqrt(p.a*p.a+p.b*p.b)),v.textHeight&&(v.textHeight*=Math.sqrt(p.a*p.a+p.b*p.b));var K=$?-1:1;if(v.position=H(v.position,p,K),v.startPoint=H(v.startPoint,p,K),v.center=H(v.center,p,K),"ELLIPSE"===T){var L;L=H({x:P.major.x+P.center.x,y:P.major.y+P.center.y},p,K),v.major={x:L.x-v.center.x,y:L.y-v.center.y},_.extrusionZNagative(P)&&(v.major.x*=-1)}var e;v.vertices&&(e=[],v.vertices.forEach(function(S){var P=H(S,p,K);S.bulge&&(P.bulge=S.bulge),e.push(P)}),v.vertices=e),v.points&&(e=[],v.points.forEach(function(S){var P=H(S,p,K);S.bulge&&(P.bulge=S.bulge),e.push(P)}),v.points=e);var r=Math.atan2(p.b,p.a),q=Math.cos(r);v.yInvert=p.d*q<0,v.xInvert=p.a*q<0,0!==r&&(v.addonAngle=r),P=v}_.mergeBound(P),F.push(P)}},_.prototype.getPointsBound=function(S){for(var P=1/0,E=1/0,p=-1/0,l=-1/0,_=0,m=S.length;_<m;_++){var u=S[_];P=Math.min(P,u.x),E=Math.min(E,u.y),p=Math.max(p,u.x),l=Math.max(l,u.y)}return{xMin:P,yMin:E,xMax:p,yMax:l}},_.prototype.mergeBound=function(S){var P,E,p=this;E=S.type;for(P in m)if(m[P].indexOf(E)>=0)break;var l,_,u,F,f,H,T,X,W,h,Q,i,a,s,k,Y,x,M,b,j,z,c=p.getPointsBound;switch(P){case"LINE":for(l=c(S.vertices),j=S.vertices.length,M=0;M<j;M++)b=S.vertices[M],p._isStraightLine(b.bulge)||(M!==j-1||S.shape)&&(z=c(p._getBulgeSegment(b,S.vertices[(M+1)%j],b.bulge)),l.xMin=Math.min(l.xMin,z.xMin),l.yMin=Math.min(l.yMin,z.yMin),l.xMax=Math.max(l.xMax,z.xMax),l.yMax=Math.max(l.yMax,z.yMax));break;case"SOLID":l=c(S.points);break;case"POINT":if(!S.position)return;_=S.position.x,u=S.position.y,l={xMin:_,yMin:u,xMax:_,yMax:u};break;case"TEXT":if(!S.text||!S.text.length)return;_=S.position?S.position.x:S.startPoint.x,u=S.position?S.position.y:S.startPoint.y,x=S.height||S.textHeight||12,p._minFontSize=Math.min(p._minFontSize,x),l={xMin:_,yMin:u,xMax:_+x*S.text.length,yMax:u+x};break;case"CIRCLE":for(_=S.center.x,u=S.center.y,F=S.radius,f=[],H=S.startAngle||0,T=H+(S.angleLength||2*Math.PI),X=S.xInvert^p.extrusionZNagative(S),W=S.yInvert,h=X?-1:1,Q=W?-1:1,i=H;i<T+Math.PI/30;i+=Math.PI/30)i=Math.min(i,T),f.push({x:_+h*F*Math.cos(i),y:u+Q*F*Math.sin(i)});l=c(f);break;case"ELLIPSE":for(_=S.center.x,u=S.center.y,f=[],a=Math.sqrt(S.major.x*S.major.x+S.major.y*S.major.y),s=a*S.ratio,F=Math.atan2(S.major.y,S.major.x),k=Math.sin(F),Y=Math.cos(F),H=S.startAngle||0,T=H+(S.angleLength||2*Math.PI),X=S.xInvert,W=S.yInvert^p.extrusionZNagative(S),h=X?-1:1,Q=W?-1:1,i=H;i<T+Math.PI/30;i+=Math.PI/30){i=Math.min(i,T);var V=h*a*Math.cos(i),g=Q*s*Math.sin(i);f.push({x:_+(Y*V-k*g),y:u+(k*V+Y*g)})}l=c(f);break;default:return}var R=p._bound;R.xMin=Math.min(R.xMin,l.xMin),R.yMin=Math.min(R.yMin,l.yMin),R.xMax=Math.max(R.xMax,l.xMax),R.yMax=Math.max(R.yMax,l.yMax)},_.prototype.parseFile=function(S){var P=this,E="string"==typeof P.options.sanitize?{sanitize:P.options.sanitize}:null,p=new DxfParser(E),l=p.parseSync(S);P._dxf=l,P._isAc2015="AC1015"===l.header.$ACADVER,P._dxfViewport=P.getCameraParametersFromDxf(l)},_.prototype.toLocal=function(S,P){var E=this;return(2===P?-(S-E._shiftY):1===P?S-E._shiftX:S)*E._scale},_.prototype.getCameraParametersFromDxf=function(S){var P,E,p,l,_,m,u,F,f,H,T,X;if(!P&&S.tables&&S.tables.viewPort){H=S.tables.viewPort.viewPorts;for(f in H)if(T=H[f],X=T.viewDirectionFromTarget,T.center&&(0===T.renderMode||X&&0===X.x&&0===X.y&&1===X.z)){p=T.center,l=T.upperRightCorner,_=T.lowerLeftCorner,P={x:l.x,y:l.y},E={x:_.x,y:_.y},m=T.viewWidth||0,u=T.viewHeight||0,T.viewTarget&&(p={x:p.x+T.viewTarget.x,y:p.y+T.viewTarget.y});break}}return!P&&S.header&&(F=S.header,F.$EXTMIN&&F.$EXTMAX&&(P=F.$EXTMAX,E=F.$EXTMIN)),m=Math.max(m,P.x-E.x),u=Math.max(u,P.y-E.y),p=p||{x:m/2+E.x,y:u/2+E.y},{width:m,height:u,x:p.x,y:p.y}},_.prototype.getColor=function(S,P){var p,l=this;if(S||console.log("no entity",S),P.tables&&P.tables.layer&&(p=P.tables.layer.layers[S.layer]),!p||p.visible){var _;S.color!==E?0===(_=S.color)&&(_=l.options.defaultColor):p&&(_=p.color),_&&16777215!==_||(_=l.options.defaultColor);var _="#"+((1<<24)+_).toString(16).slice(1);return l.options.mapColor&&(_=l.options.mapColor(_)),_}},_.prototype.sortBlocks=function(S){var E,p,l,_,m=P.keys(S),u={};for(E in S)if(p=S[E],p.entities)for(var F=0,f=p.entities.length;F<f;F++)l=p.entities[F],"DIMENSION"!==(_=l.type)&&"INSERT"!==_||l.block&&(u[E]||(u[E]=[]),u[E].push(l.block));for(var H=m.length,T=H,X={},W=new Array(H),h=!1,Q=function(S,P,E){if(E.indexOf(S)>=0)return void(h=!0);if(!X[P]){X[P]=!0;var p=u[S],l=p?p.length:0;if(l){var _=E.concat(S);do{var F=p[--l];if(Q(F,m.indexOf(F),_),h)break}while(l)}W[--H]=S}};T--;)X[T]||Q(m[T],T,[]);return h?[]:W}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);var ME=function(S){function P(E,p){var l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];$P(this,P);var _=KP(this,S.call(this,p));return _.editor=E,_.modifiable=l,_.dragToIndexEnabled=!0,_.addTopPainter(_.$1$.bind(_)),_.modifiable||(_.handleDragAndDrop=null),_}return BP(P,S),P.prototype.getLabelColor=function(P){return P!==this.draggingData||this.isSelected(P)?S.prototype.getLabelColor.call(this,P):rP.config.color_select},P.prototype.isDroppable=function(S,P){return!1},P.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},P.prototype._endDrag=function(S,P){},P.prototype._endCrossDrag=function(S,P){},P.prototype.$1$=function(S){S.texureImage2D=!0;var P=void 0;if(this._dragInfo&&this._dragInfo.inView?P=this._dragInfo:this._crossDragInfo&&(P=this._crossDragInfo),P){var E=this.getWidth(),p=this.getRowHeight(),l=P.type,_=P.parent,m=_?this.getRowDatas().indexOf(_):-1,u=rP.config.color_select_dark;if(P.refData){if(D(S,u,0,m*p,E,p,2),"up"===l||"down"===l){var F=P.x,f=P.y;S.beginPath(),S.arc(F-3,f,3,0,2*Math.PI,!0),S.moveTo(F,f),S.lineTo(E,f),S.lineWidth=2,S.strokeStyle=u,S.stroke()}}else{var H=this.getViewRect();D(S,u,H.x,H.y,H.width,H.height,2)}}},P.prototype._dragging=function(S,P){var E=this.getRowHeight(),p=this.lp(S),l=p.y/E,_=Math.floor(l);if(_>this.getRowSize()-1)P.refData=null,P.type="parent",P.parent=null;else{var m=p.y-_*E;this.dragToIndexEnabled?P.type=m<.25*E?"up":m>.75*E?"down":"parent":P.type="parent";var u=P.refData=this.getRowDatas().get(_);"up"===P.type?(P.parent=u.getParent(),P.x=(this.getLevel(u)+1)*this.getIndent(),P.y=_*E):"down"===P.type?(this.getToggleIcon(u)===this.getExpandIcon()?(P.parent=u,P.x=(this.getLevel(u)+2)*this.getIndent()):(P.parent=u.getParent(),P.x=(this.getLevel(u)+1)*this.getIndent()),P.y=(_+1)*E):P.parent=u}this.autoScroll(S),this.redraw()},P.prototype.$2$=function(){var S="";if(this.draggingData&&(S=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var P=this.sm().size();S+=P>1?" (+"+P+") ":""}return S},P.prototype.handleDragAndDrop=function(S,P){if("prepare"===P)return void this._clearDragInfo();"begin"===P&&(this._dragInfo={tip:this.$2$(),view:this});var E=this._dragInfo;if(E){var p=this.editor.dnd;if("begin"===P||"between"===P){return this.getView().contains(b(S))?(E.inView=!0,this._dragging(S,E),p.clearDropView(S,E)):(E.inView&&this.redraw(),E.inView=!1,p.crossDrag(S,E)),void p.showTip(E.tip,S)}return"end"===P?(E.inView?this._endDrag(S,E):p.crossDrop(S,E),void this._clearDragInfo()):"cancel"===P?(E.inView||p.crossCancel(S,E),void this._clearDragInfo()):void 0}},P.prototype.handleCrossDrag=function(S,P,E){return"exit"===P||"cancel"===P?(this._crossDragInfo=null,void this.redraw()):"enter"===P||"over"===P?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(S,this._crossDragInfo)):"drop"===P?(this._endCrossDrag(S,E),this._crossDragInfo=null,void this.redraw()):void 0},P.prototype.isEditable=function(S){return!1},P.prototype.rename=function(S,P){S.setName(P)},P.prototype.handleDataDoubleSelect=function(S,P){if(this.modifiable&&this.isEditable(P)){var E=this.getLevel(P);E+=this.getIcon(P)?2:1,this.lp(S).x>E*this.getIndent()&&this.beginEditing(P)}},P.prototype.getEditingLabel=function(S){return this.getLabel(S)},P.prototype.beginEditing=function(S){var P=this;this.cancelEditing(),this.makeVisible(S),this.validate();var E=this.getLevel(S);E+=this.getIcon(S)?2:1;var p=this.getIndent()*E,l=this.ty()+this.getRowIndex(S)*this.getRowHeight(),_=Math.max(1,this.getWidth()-p),m=this.getRowHeight();this._currentEditor=new ht.widget.TextField,this._currentEditor.data=S;var u=this._currentEditor.getElement(),F=this.getEditingLabel(S);u.value=null==F?"":F,u.onblur=function(S){P.endEditing()},u.onkeydown=function(S){i(S)?P.endEditing():a(S)&&P.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),K(this._currentEditor,p,l,_,m),this._currentEditor.setFocus(),ht.Default.callLater(u.select,u)},P.prototype.endEditing=function(){var S=this._currentEditor;S&&(this.rename(S.data,S.getValue()),delete this._currentEditor,e(S.getView()),this.redraw())},P.prototype.cancelEditing=function(){var S=this._currentEditor;S&&(delete this._currentEditor,e(S.getView()),this.redraw())},P}(xE);rP.DNDTree=ME;var bE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E.editor,E.dataModel,p));return l.explorer=E,l.dragToIndexEnabled=!1,l}return BP(P,S),P.prototype.getLabel=function(S){return l("url:"+S.url,!0)||this.getEditingLabel(S)},P.prototype.getEditingLabel=function(S){return S.getName()},P.prototype.handleBackgroundClick=function(S){},P.prototype.handleDelete=function(){this.modifiable&&rP.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},P.prototype.isDroppable=function(S,P){return!(!this.modifiable||P.view!==this.explorer.list)||P.view===this.editor.dndFromOutside},P.prototype._endCrossDrag=function(S,P){var E=this;if(this._crossDragInfo){var p=P.view,l=this._crossDragInfo.parent;l||(l=this.explorer.rootNode),p===this.explorer.list?p.isSelected(p.draggingData)?p.sm().toSelection().each(function(S){E.editor.moveFile(S,l)}):this.editor.moveFile(p.draggingData,l):p===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(S,l)}},P.prototype._endDrag=function(S,P){var E=this,p=P.parent;if(p||(p=this.explorer.rootNode),this.isSelected(this.draggingData)){this.getTopRowOrderSelection().each(function(S){E.editor.moveFile(S,p)})}else this.editor.moveFile(this.draggingData,p),this.sm().ss(this.draggingData);p&&this.expand(p)},P.prototype.isEditable=function(S){return S!==this.explorer.rootNode},P.prototype.beginEditing=function(P){var E={data:P,url:P.url};this.editor.fireEvent("fileRenaming",E),E.preventDefault||S.prototype.beginEditing.call(this,P)},P.prototype.rename=function(S,P){this.editor.renameFile(S,P)&&(S.s("label")?S.s("label",P):S.setName(P))},P.prototype.getIcon=function(S){return void 0!==S.getIcon()?S.getIcon():S.fileType===AP?this.hasExpandedChild(S)?"editor.direxpanded":"editor.dircollapsed":S.fileType===dP?"editor.root.state":null},P}(ME),jE=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this,E));return p._lastSelectDataTime=Date.now(),p}return BP(P,S),P.prototype.isVScrollable=function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},P.prototype.isV=function(S){var P=this.gv.getViewRect();return this.isVScrollable()&&(P.x+P.width-this.gv.lp(S).x)*this.gv.getZoom()<ht.Default.scrollBarInteractiveSize},P.prototype.clear=function(S){S&&this._dragging&&!this._dragCancel&&this.gv.handleDragAndDrop(S,"end"),this.gv.draggingData&&(this.gv.draggingData.iv(),this.gv.draggingData=null,this.gv.redraw()),this._dragging=this._dragCancel=this._clientPoint=null},P.prototype.handle_mousedown=function(S){this.handle_touchstart(S)},P.prototype.handle_touchstart=function(S){if(!this.isV(S)&&!rS(S.target)){U(S),this.clear(S),this._clientPoint=M(S);var P=this.gv.getDataAt(S);k(S)?P?(this.gv.draggingData=P,P.iv(),this.gv.redraw(),this.gv.handleDragAndDrop(S,"prepare"),x(this,S)):this.gv.sm().cs():(P&&this.handleSelection(S,P),this.clear(S))}},P.prototype.handle_mouseup=function(S){this.handle_touchend(S)},P.prototype.handle_touchend=function(S){if(this._clientPoint&&!this._dragging){var P=this.gv.getDataAt(S);P&&this.handleSelection(S,P)}this.clear(S)},P.prototype.handleWindowMouseMove=function(S){this.handleWindowTouchMove(S)},P.prototype.handleWindowMouseUp=function(S){this.handleWindowTouchEnd(S)},P.prototype.handleWindowTouchMove=function(S){U(S),this._dragging?this._dragCancel||this.gv.handleDragAndDrop(S,"between"):this._clientPoint&&this.gv.draggingData&&c(M(S),this._clientPoint)>2&&(this._dragging=!0,this.gv.handleDragAndDrop(S,"begin"))},P.prototype.handleWindowTouchEnd=function(S){U(S),this.clear(S)},P.prototype.handleSelection=function(S,P){var E=this.gv.sm();if(O(S))this.gv.isSelected(P)?E.removeSelection(P):E.appendSelection(P);else if(q(S)){var p=E.ld();if(p)for(var l=this.gv.nodes,_=l.indexOf(p),m=l.indexOf(P);_!==m;)_+=m>_?1:-1,E.as(l[_]);else E.ss(P)}else if(k(S)){var u=Date.now();if(E.contains(P)){var F=u-this._lastSelectDataTime;F>500&&F<1500&&this.gv.handleDataDoubleSelect(S,P)}E.ss(P),this._lastSelectDataTime=u}else E.contains(P)||E.ss(P)},P.prototype.handle_keydown=function(S){if(!rS(S.target))if(a(S))this._dragging&&!this._dragCancel&&(this.gv.handleDragAndDrop(S,"cancel"),this._dragCancel=!0);else if(W(S)||Q(S)||X(S)||h(S)){var P=this.gv.sm(),E=this.gv.nodes,p=P.ld();if(E.length){var l=void 0;if(p){var _=E.indexOf(p);W(S)||X(S)?0!==_&&(l=E[_-1]):_!==E.length-1&&(l=E[_+1])}else l=E[0];l&&(q(S)?P.as(l):P.ss(l))}}},P}(ht.graph.Interactor),zE=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this,E.editor,E.dm));return p.displayView=E,p.graphView=E.graphView,p.nodeIcon=KS(p),p.initMenu(),E.dm.addDataPropertyChangeListener(function(S){var P=S.data;(P instanceof ht.Shape||P instanceof ht.Edge)&&(P.editorIcon=null)}),p}return BP(P,S),P.prototype.getBorderColor=function(S){return null},P.prototype.handleDelete=function(){this.removeSelection()},P.prototype.onDataDoubleClicked=function(S,P){P.altKey?this.graphView.fitData(S,!0,rP.config.fitPadding):this.graphView.makeCenter(S,!0)},
P.prototype.onPropertyChanged=function(P){"filter"===P.property&&(this.visibleMap=null,this.ivm()),S.prototype.onPropertyChanged.call(this,P)},P.prototype.handleDataPropertyChange=function(P){!this._filter||"name"!==P.property&&"displayName"!==P.property?S.prototype.handleDataPropertyChange.call(this,P):(this.visibleMap=null,this.ivm())},P.prototype.checkVisible=function(S){if(!this._filter)return!0;var P=this.getLabel(S);return null!=P&&(P=(P+"").toLowerCase(),P.indexOf(this._filter)>=0)},P.prototype.validateModel=function(){var P=this;this._filter&&!this.visibleMap&&(this.visibleMap={},this.getDataModel().each(function(S){if(P.checkVisible(S)){P.visibleMap[S._id]=!0;for(var E=S.getParent();E&&!P.visibleMap[E._id];)P.visibleMap[E._id]=!0,E=E.getParent()}})),S.prototype.validateModel.call(this)},P.prototype.isVisible=function(S){return!S._refGraph&&(!this._filter||this.visibleMap&&this.visibleMap[S._id])},P.prototype.validate=function(){this.graphView.validate(),S.prototype.validate.call(this)},P.prototype.getLabel=function(S){return null==S.toLabel()&&S.s("editor.folder")?l("ht.Folder"):S.toLabel()||l(S.getClassName())},P.prototype.getIcon=function(S){return S instanceof ht.SubGraph?"editor.subgraph":S instanceof ht.Group?"editor.group":S instanceof ht.RefGraph||S instanceof ht.Text?S.getIcon():S instanceof ht.Block?"editor.block":S instanceof ht.Shape?(S.editorIcon||(S.editorIcon=eS(S)),S.editorIcon):S instanceof ht.Edge?(S.editorIcon||(S.editorIcon=LS(this,S)),S.editorIcon):S instanceof ht.Node?this.nodeIcon:S.s("editor.folder")?this.hasExpandedChild(S)?"editor.direxpanded":"editor.dircollapsed":null},P.prototype.isDroppable=function(S,P){return P.view===this.editor.symbols.getFileListView()||(P.view===this.editor.assets.getFileListView()||P.view===this.editor.displays.getFileListView())},P.prototype._endCrossDrag=function(S,P){var E=this;if(this._crossDragInfo){this.editor.beginTransaction();var p=[],l=P.view,_=this._crossDragInfo.type,m=this._crossDragInfo.parent,u=this._crossDragInfo.refData;l!==this.editor.symbols.getFileListView()&&l!==this.editor.assets.getFileListView()||l.toDraggingDatas("down"===_).forEach(function(S){var P=new ht.Node;P.setImage(S.url),P.setDisplayName(v(S.getName())),p.push(P),E.displayView.addData(P,!0),E.editor.gv.$64$([P]),E._dropData(P,_,m,u)}),l===this.editor.displays.getFileListView()&&l.toDraggingDatas("down"===_).forEach(function(S){if(S.url!==E.editor.url){var P=new ht.RefGraph;P.setRef(S.url),P.setDisplayName(v(S.getName())),p.push(P),E.displayView.addData(P,!0),E._dropData(P,_,m,u)}}),p.length&&this.sm().ss(p),this.editor.endTransaction()}},P.prototype._endDrag=function(S,P){var E=this;this.editor.beginTransaction();var p=P.type,l=P.parent,_=P.refData;if(this.isSelected(this.draggingData)){var m=this.getTopRowOrderSelection();"down"===p&&m.reverse(),m.each(function(S){E._dropData(S,p,l,_)})}else this._dropData(this.draggingData,p,l,_),this.sm().ss(this.draggingData);l&&this.expand(l),this.editor.endTransaction()},P.prototype._dropData=function(S,P,E,p){if(S.setParent(E),"down"===P||"up"===P){var l=E?E.getChildren():this.dm().getRoots(),_=l.indexOf(p);"down"===P&&_++,l.indexOf(S)<_&&_--,this.dm().moveTo(S,_)}else E||this.dm().moveToBottom(S)},P.prototype.isEditable=function(S){return!0},P.prototype.rename=function(S,P){S.setDisplayName(P)},P.prototype.initMenu=function(){var S=this,P=function(){for(var P=S.editor.selection,E=0;E<P.length;E++)if(P[E].s("editor.folder"))return!0;return!1};this.menu=new WE;var E=[{id:"folder",label:l("editor.folder"),action:function(){S.editor.folder()},visible:function(){return!!S.editor.ld}},{id:"unfolder",label:l("editor.unfolder"),action:function(){S.editor.unfolder()},visible:P},{separator:!0,visible:function(){return!!S.editor.ld}},{id:"copy",label:l("editor.copy"),action:function(){S.editor.copy()},visible:function(){return!!S.editor.ld}},{id:"paste",label:l("editor.paste"),action:function(){S.editor.paste()},visible:function(){return S.editor.hasCopyInfo()}},{id:"delete",label:l("editor.delete"),action:function(){S.editor.delete()},visible:function(){return!!S.editor.ld}},{separator:!0,visible:function(){return!!S.editor.ld}},{id:"bringToFront",label:l("editor.bringtofront"),action:function(){S.editor.bringToFront()},visible:function(){return!!S.editor.ld}},{id:"bringForward",label:l("editor.bringforward"),action:function(){S.editor.bringForward()},visible:function(){return!!S.editor.ld}},{id:"sendBackward",label:l("editor.sendbackward"),action:function(){S.editor.sendBackward()},visible:function(){return!!S.editor.ld}},{id:"sendToBack",label:l("editor.sendtoback"),action:function(){S.editor.sendToBack()},visible:function(){return!!S.editor.ld}},{separator:!0,visible:function(){return!!S.editor.ld}},{id:"expandAll",label:l("editor.expandall"),action:function(){S.expandAll()}},{id:"collapseAll",label:l("editor.collapseall"),action:function(){S.collapseAll()}}];this.menu.setItems(E),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},P.prototype.onClosed=function(){_(this.editor.menus,this.menu)},P}(ME);I(zE,{ms_ac:["filter"]});var cE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E.dataModel));return l.explorer=E,l.modifiable=p,l.editor=E.editor,l.getHScrollBar().style.display="none",l.setMaxFileSize(rP.config.imageSize),l.setPannable(!1),l.setInteractors([new ht.graph.ScrollBarInteractor(l),new jE(l),new ht.graph.DefaultInteractor(l),new ht.graph.TouchInteractor(l,{editable:!1})]),l}return BP(P,S),P.prototype.getLabel=function(S){return l("url:"+S.url,!0)||this.getEditingLabel(S)},P.prototype.getEditingLabel=function(S){return S.s("label")||S.getName()},P.prototype.rename=function(S,P){this.editor.renameFile(S,P)&&(S.s("label")?S.s("label",P):S.setName(P))},P.prototype.handleDelete=function(){rP.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},P.prototype.beginEditing=function(S){var P=this,E={data:S,url:S.url};if(this.editor.fireEvent("fileRenaming",E),!E.preventDefault){this.cancelEditing(),this.makeVisible(S),this.validate();var p=this.getDataUI(S),l=!1,_=void 0;if(p&&p.labelInfo&&p.labelInfo.rect?_=p.labelInfo.rect:S.fileType===AP&&(_=S.getRect(),l=!0),_){var m=void 0,u=void 0,F=void 0,f=void 0;if(l)m=_.x,u=_.y,F=_.width,f=_.height;else if(this._layoutType===nP)m=this._rowHeight,u=S.p().y-this._rowHeight/2,F=this.getWidth()-m,f=this._rowHeight;else{var H=p.labelInfo.rect||S.getRect();m=S.p().x-S.getWidth()/2,u=H.y,F=S.getWidth(),f=H.height}u+=this.ty(),this._currentEditor=new ht.widget.TextField,this._currentEditor.data=S;var T=this._currentEditor.getElement(),X=this.getEditingLabel(S);T.value=null==X?"":X,T.onblur=function(S){P.endEditing()},T.onkeydown=function(S){i(S)?P.endEditing():a(S)&&P.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),K(this._currentEditor,m,u,F,f),this._currentEditor.setFocus(),ht.Default.callLater(T.select,T)}}},P.prototype.endEditing=function(){var S=this._currentEditor;S&&(this.rename(S.data,S.getValue()),delete this._currentEditor,e(S.getView()),this.redraw())},P.prototype.cancelEditing=function(){var S=this._currentEditor;S&&(delete this._currentEditor,e(S.getView()),this.redraw())},P.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},P.prototype.handleDragAndDrop=function(S,P){if("prepare"===P)return void this._clearDragInfo();"begin"===P&&(this._dragInfo={tip:this.$2$(),view:this});var E=this._dragInfo;if(E){var p=this.editor.dnd;if("begin"===P||"between"===P){return this.getView().contains(b(S))?(E.inView=!0,this._dragging(S,E),p.clearDropView(S,E)):(E.inView&&this.redraw(),E.inView=!1,p.crossDrag(S,E)),void p.showTip(E.tip,S)}return"end"===P?(E.inView?this._endDrag(S,E):p.crossDrop(S,E),void this._clearDragInfo()):"cancel"===P?(E.inView||p.crossCancel(S,E),void this._clearDragInfo()):void 0}},P.prototype._dragging=function(S,P){var E=this.getDataAt(S);this.modifiable&&E&&E.fileType===AP?P.targetData=E:P.targetData=null,this.autoScroll(S),this.redraw()},P.prototype.$2$=function(){var S="";if(this.draggingData&&(S=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var P=this.sm().size();S+=P>1?" (+"+P+") ":""}return S},P.prototype._endDrag=function(S,P){},P.prototype.handleSelectionChange=function(P){S.prototype.handleSelectionChange.call(this,P),this.redraw()},P.prototype.handleCrossDrag=function(S,P,E){return"exit"===P||"cancel"===P?(this._crossDragInfo=null,void this.redraw()):"enter"===P||"over"===P?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(S,this._crossDragInfo)):"drop"===P?(this._endCrossDrag(S,E),this._crossDragInfo=null,void this.redraw()):void 0},P.prototype._endCrossDrag=function(S,P){if(this._crossDragInfo){var E=this._crossDragInfo.targetData;if(E&&E.fileType===AP||(E=this.dm().sm().ld()),E){var p=P.view;"displays"===this.explorer.rootDir&&p instanceof zE&&this.handleDisplayTreeDrop(p,E),p===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(S,E)}}},P}(hE);I(cE,{ms_ac:["layoutType","fileSize","fileGap","rowHeight","maxFileSize"],_fileRect:{x:0,y:0,width:0,height:0},_layoutType:IP,_fileSize:50,_fileGap:6,_rowHeight:21,_maxFileSize:200});var VE={layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0},gE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E,p));return l.nodes=[],l.doLayoutBind=l.doLayout.bind(l),l.dm().sm().ms(function(){l.sm().cs(),l.doLayoutLater()}),l.dm().mm(function(){l.doLayoutLater()}),l.addInteractorListener(l.handleInteraction.bind(l)),l.addBottomPainter(l.paintBottom.bind(l)),l.addTopPainter(l.paintTop.bind(l)),l}return BP(P,S),P.prototype.getDataAt=function(P){if(this._layoutType===nP){var E=Math.floor(this.lp(P).y/this._rowHeight);return this.nodes[E]}return S.prototype.getDataAt.call(this,P)},P.prototype.paintBottom=function(S){var P=this,E=this._rowHeight,p=this.getWidth();this.nodes.forEach(function(l){if(P.isSelected(l))if(P._layoutType===nP)S.beginPath(),S.rect(0,l.p().y-E/2,p,E),S.fillStyle=rP.config.color_select,S.fill();else{var _=l.getRect();D(S,rP.config.color_select,_.x-2,_.y-2,_.width+4,_.height+4,1)}})},P.prototype.paintTop=function(S){S.texureImage2D=!0;var P=void 0;if(this._dragInfo&&this._dragInfo.inView?P=this._dragInfo:this._crossDragInfo&&(P=this._crossDragInfo),P){var E=rP.config.color_select_dark,p=P.targetData;if(S.texureImage2D=!0,p)if(this._layoutType===nP){var l=p.p().y-this._rowHeight/2,_=this.getWidth(),m=this._rowHeight;D(S,E,0,l,_,m,2)}else{var u=p.getRect();S.beginPath(),S.rect(u.x,u.y,u.width,u.height),S.lineWidth=2,S.strokeStyle=rP.config.color_select_dark,S.stroke()}else{var F=this.getViewRect();D(S,E,F.x,F.y,F.width,F.height,2)}}},P.prototype.toDraggingDatas=function(S){var P=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(S){S.fileType!==AP&&P.push(S)}),S&&P.reverse()):this.draggingData.fileType!==AP&&P.push(this.draggingData),P},P.prototype.isDroppable=function(S,P){return"displays"===this.explorer.rootDir&&P.view instanceof zE||P.view===this.editor.dndFromOutside},P.prototype._endDrag=function(S,P){var E=this,p=P.targetData;p&&(this.isSelected(this.draggingData)?this.sm().toSelection().each(function(S){E.editor.moveFile(S,p)}):this.editor.moveFile(this.draggingData,p))},P.prototype.handleDisplayTreeDrop=function(S,P){var E=this,p=void 0;p=S.isSelected(S.draggingData)?S.getTopRowOrderSelection().toArray():[S.draggingData];var _={};p.forEach(function(S){n(S,_)});var m=new ht.JSONSerializer(S.getDataModel(),!0);m.isSerializable=function(S){return _[S._id]};var u=m.serialize();qS(l("editor.inputnewdisplayname")+" ["+P.url+"]",S.getLabel(S.draggingData),{nullable:!1,trim:!0,maxLength:rP.config.maxFileNameLength},function(S,p){if("ok"===p){pS(S)||(S+=".json");var l=P.url+"/"+S,m={path:l,content:u};E.editor.request("upload",m,function(S){if(!0===S){var P=E.editor.gv,p=P.isVisible;P.isVisible=function(S){return p.call(P,S)&&_[S._id]},E.editor.saveImage(P,l.substr(0,l.length-5)+".png"),P.isVisible=p,P.redraw()}E.editor.fireEvent("displayViewSaved",{url:l})})}})},P.prototype.handleDataDoubleSelect=function(S,P){var E=this.lp(S);if(this._layoutType===nP)E.x>this._rowHeight&&this.beginEditing(P);else{var p=this.getDataUI(P);p&&p.labelInfo&&p.labelInfo.rect&&ht.Default.containsPoint(p.labelInfo.rect,E)&&this.beginEditing(P)}},P.prototype.getLabelColor=function(S){return S!==this.draggingData||this.isSelected(S)?this._layoutType===nP?this.isSelected(S)?rP.config.color_light:ht.Default.labelColor:this.isSelected(S)?rP.config.color_select:ht.Default.labelColor:rP.config.color_select},P.prototype.handleInteraction=function(S){var P=S.kind,E=S.data,p=S.event;if("doubleClickData"===P)1===this.sm().size()&&(E.fileType===AP?this.dm().sm().ss(E):this.editor.open(E,q(p)));else if("doubleClickBackground"===S.kind){var l=this.dm().sm().ld();l&&l.getParent()&&this.dm().sm().ss(l.getParent())}},P.prototype.handleScroll=function(S,P){U(S),q(S)?P>0?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1)):(wP||S.wheelDelta!==S.wheelDeltaX)&&(P=wP?-S.detail:S.wheelDelta/40,this.translate(0,20*P))},P.prototype.handlePinch=function(S,P,E){E<P?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1))},P.prototype.onPropertyChanged=function(S){cE.prototype.onPropertyChanged.apply(this,arguments),VE[S.property]&&this.doLayoutLater()},P.prototype.isVisible=function(S){var P=this.dm().sm().ld();return!(!P||S.getParent()!==P)&&S.fileType!==OP},P.prototype.isMovable=function(){return!1},P.prototype.onValidated=function(){this._lastWidth===this.getWidth()&&this._lastHeight===this.getHeight()||this.doLayoutLater()},P.prototype.adjustTranslateX=function(){return 0},P.prototype.adjustTranslateY=function(S){var P=this.getHeight()-this._fileRect.height;return S<P&&(S=P),S>0?0:Math.round(S)},P.prototype.getContentRect=function(){return this._fileRect},P.prototype.doLayoutLater=function(){this._doLayoutLater||(this._doLayoutLater=!0,requestAnimationFrame(this.doLayoutBind))},P.prototype.doLayout=function(){var S=this;this._doLayoutLater=!1,this.redraw();var P=this.nodes=[];this.dm().getDatas().each(function(E){S.isVisible(E)&&P.push(E)});var E=this._lastWidth=this.getWidth();this._lastHeight=this.getHeight();var p=this._fileGap;if(this._layoutType===nP){for(var l=this._rowHeight,_=Math.max(l-4,2),m=0;m<P.length;m++){var u=P[m];u.setPosition(p+_/2,l*m+2+_/2),u.setSize(_,_),u.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0})}this._fileRect={x:0,y:0,width:E,height:l*P.length}}else{for(var F=this._fileSize,f=F+p,H=F+p+16,T=p,X=p,W=0,h=0;h<P.length;h++){var Q=P[h];Q.setPosition(T+F/2,X+F/2),Q.setSize(F,F),Q.s({"label.position":31,"label.offset.x":0,"label.offset.y":2,"label.max":F}),(W+2)*f+p>E?(T=p,h!==P.length-1&&(X+=H),W=0):(T+=f,W++)}this._fileRect={x:0,y:0,width:E,height:X+H}}this.tx(this.tx()),this.ty(this.ty()),this.showScrollBar()},P}(cE),RE=function(S){function P(E,p,l,_){$P(this,P);var m=KP(this,S.call(this));m.setSize(20,20),m._id=m.url=p?p+"/"+l:l,m.path=p,m.value=_,m.rootDir=E;var u=OP,F=void 0,f="editor.unknown";return m.s({"select.width":0,pixelPerfect:!1,"image.stretch":"centerUniform"}),""===p?(u=dP,f="editor.root.state"):HS(_)?fS(_.fileType)?(u=_.fileType,F=_.fileIcon,f=_.fileImage||F,f||_.fileType!==AP||(f="editor.dir"),m.a(_.attrs),m.s(_.styles)):(u=AP,f="editor.dir"):ES(l)&&"assets"===E?(u=NP,f=uS(l)?"editor.dxf.state":lS(l)?"editor.sound.state":_S(l)?"editor.video.state":m.url):pS(l)&&"displays"===E?(u=CP,f=FS(m.url),m.s("label",v(l))):pS(l)&&"symbols"===E?(u=ZP,f=FS(m.url),m.s("label",v(l))):pS(l)&&"components"===E?(u=oP,f=FS(m.url),m.s("label",v(l))):pS(l)&&"scenes"===E?(u=yP,f=FS(m.url),m.s("label",v(l))):pS(l)&&"models"===E&&(u=DP,f=FS(m.url),m.s("label",v(l))),m.fileType=u,m.setIcon(F),m.setImage(f),m.setName(l),m}return BP(P,S),P}(ht.Node);ht.Default.setCompType("accordion-title-comp",function(S,P,E,p,l){var _=p.__hover,m=P.x,u=P.y,F=P.width,f=P.height,H=l.getLabel(p),T=l.getFileGap();S.save(),(_||l.isSelected(p))&&(S.fillStyle=rP.config.color_hover,S.fillRect(m,u,F,f)),S.fillStyle=rP.config.color_select,S.fillRect(m+T,u+(f-8)/2,8,8),H&&ht.Default.drawText(S,H,"bold 14px Arial","black",m+T+8+8,u,200,f,"left","middle"),S.restore()}),ht.Default.setImage("accordion-title",{width:160,height:24,fitSize:!0,pixelPerfect:!1,interactive:!0,boundExtend:2,onDown:function(S,P,E,p,l,_){ht.Default.isLeftButton(S)&&(P.expanded=!P.expanded,E.ivm())},onEnter:function(S,P,E,p,l,_){P.__hover=!0,P.iv()},onLeave:function(S,P,E,p,l,_){P.__hover=!1,P.iv()},comps:[{type:"accordion-title-comp",displayName:"clock-pointer",rect:[0,0,160,24]}]});var GE={layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,filePadding:!0,titleHeight:!0},JE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E,p));return l.setFileGap(10),l.nodes=[],l.dirs=[],l.bottomRects=[],l.addViewListener(function(S){"beginValidate"===S.kind&&l.doLayout()}),l.setSelectionModelShared(!1),l.dm().sm().ms(function(){l.sm().cs()}),l._layouted=!1,l.mi(l.handleInteraction.bind(l)),l.addBottomPainter(l.paintBottom.bind(l)),l.addTopPainter(l.paintTop.bind(l)),l}return BP(P,S),P.prototype.paintBottom=function(S){var P=this,E=this._rowHeight,p=this.getWidth();this.nodes.forEach(function(l){if(P._layoutType===nP)P.isSelected(l)&&(S.beginPath(),S.rect(0,l.p().y-E/2,p,E),S.fillStyle=rP.config.color_select,S.fill());else{var _=P.isSelected(l)?rP.config.color_select:rP.config.color_mask,m=l.getRect(),u=m.x,F=m.y,f=m.width,H=m.height,T=P._filePadding;D(S,_,u-T,F-T,f+2*T,H+2*T,1)}}),this.bottomRects.forEach(function(P){var E=P.x,p=P.y,l=P.width,_=P.height;S.beginPath(),S.lineWidth=2,S.strokeStyle=rP.config.color_hover,S.moveTo(E+10,p+_/2),S.lineTo(E+l-10,p+_/2),S.stroke()})},P.prototype.isDroppable=function(S,P){return"displays"===this.explorer.rootDir&&P.view instanceof zE||P.view===this.editor.dndFromOutside},P.prototype.handleDragAndDrop=function(P,E){var p=this.draggingData;p&&p.fileType!==AP&&S.prototype.handleDragAndDrop.call(this,P,E)},P.prototype.isLabelVisible=function(S){return S.fileType!==AP},P.prototype.paintTop=function(S){S.texureImage2D=!0;var P=void 0;if(this._dragInfo&&this._dragInfo.inView?P=this._dragInfo:this._crossDragInfo&&(P=this._crossDragInfo),P){var E=rP.config.color_select_dark,p=P.targetData;if(S.texureImage2D=!0,p){var l=p.getRect();S.beginPath(),S.rect(l.x,l.y,l.width,l.height),S.lineWidth=2,S.strokeStyle=rP.config.color_select_dark,S.stroke()}else{var _=this.getViewRect();D(S,E,_.x,_.y,_.width,_.height,2)}}},P.prototype.getDataAt=function(P){if(this._layoutType!==nP)return S.prototype.getDataAt.call(this,P);var E=S.prototype.getDataAt.call(this,P);if(E)return E;for(var p=this.lp(P).y,l=0;l<this.nodes.length;l++){var _=this.nodes[l],m=_.getY(),u=this._rowHeight,F=m-u/2,f=m+u/2;if(p>=F&&p<f)return _}},P.prototype.handleInteraction=function(S){var P=S.kind,E=S.data,p=S.event;"doubleClickData"===P&&1===this.sm().size()&&this.editor.open(E,q(p))},P.prototype.handleDataDoubleSelect=function(S,P){var E=this.lp(S);if(P.fileType!==AP)if(this._layoutType===nP)E.x>this._rowHeight&&this.beginEditing(P);else{var p=this.getDataUI(P);p&&p.labelInfo&&p.labelInfo.rect&&ht.Default.containsPoint(p.labelInfo.rect,E)&&this.beginEditing(P)}},P.prototype.getLabelColor=function(S){return S!==this.draggingData||this.isSelected(S)?this._layoutType===nP?this.isSelected(S)?rP.config.color_light:ht.Default.labelColor:this.isSelected(S)?rP.config.color_select:ht.Default.labelColor:rP.config.color_select},P.prototype.isVisible=function(S){if(!this._layouted)return!1;var P=this.explorer.rootDir,E=S.getParent();return!(S.fileType===OP||!E)&&(!(this._visibleFunc&&!this._visibleFunc(S))&&(E.url===P&&S.fileType===AP||!(!E.getParent()||E.getParent().url!==P||S.fileType===AP)&&!!E.expanded))},P.prototype.adjustTranslateX=function(S){return 0},P.prototype.adjustTranslateY=function(S){if(!this.contentHeight)return 0;var P=this.getViewRect(),E=P.height-this.contentHeight;return S>=0||E>=0?0:S>E?S:E},P.prototype.getImage=function(S){if(S.getImage)return S.fileType===AP?"accordion-title":S.getImage()},P.prototype.doLayout=function(){var S=this;if(this._lastWidth!==this.getWidth()||this._lastHeight!==this.getHeight()||this._lastFileSize!==this.getFileSize()){this._doLayoutLater=!1,this.redraw();var P=this.dirs=[],E=this.nodes=[],p=this.bottomRects=[];this.dm().each(function(E){S.isVisible(E)&&E.fileType===AP&&P.push(E)});var l=this._lastWidth=this.getWidth(),_=this._titleHeight,m=0;this._lastHeight=this.getHeight(),this._lastFileSize=this._fileSize,this._expandIds&&(this.dirs.forEach(function(P){P.expanded=S._expandIds.indexOf(P.getId())>=0}),delete this._expandIds),P.forEach(function(P){P.setAnchor(0,0),P.p(0,m),P.setSize(l,_),P.s("label",null),m+=_;var u=[];P.getChildren().each(function(P){S.isVisible(P)&&(u.push(P),E.push(P))}),m=S.layoutChildren(u,m),P.expanded&&(p.push({x:0,y:m,width:l,height:16}),m+=16)}),this.contentHeight=m,this._layouted=!0}},P.prototype.layoutChildren=function(S,P){if(!S||0===S.length)return P;var E=this._fileGap;if(this._layoutType===nP){var p=this._rowHeight,l=Math.max(p-4,15);return S.forEach(function(S,_){S.setPosition(E+l/2,P+2+l/2),S.setSize(l,l),S.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0}),P+=p}),P}var _=this.getWidth(),m=this._fileSize,u=this._filePadding,F=m+2*u,f=E,H=P+E,T=0,X=m+E+2*u,W=m+E+16+2*u;return S.forEach(function(P,p){P.setPosition(f+F/2,H+F/2),P.setSize(m,m),P.s({"label.position":31,"label.offset.x":0,"label.offset.y":2+u,"label.max":F}),(T+2)*X+E>_?(f=E,p!==S.length-1&&(H+=W),T=0):(f+=X,T++)}),H+W},P.prototype.handleScroll=function(S){var P=wP?-S.detail:S.wheelDelta/10;(wP||S.wheelDelta!==S.wheelDeltaX)&&this.translate(0,P)},P.prototype.adjustZoom=function(){return 1},P.prototype.onPropertyChanged=function(P){S.prototype.onPropertyChanged.call(this,P);var E=P.property;"dataModel"!==E&&"fileSize"!==E||this.doLayout()},P.prototype._endDrag=function(S,P){var E=this,p=P.targetData;p&&p.fileType===AP&&(this.isSelected(this.draggingData)?this.sm().toSelection().each(function(S){E.editor.moveFile(S,p)}):this.editor.moveFile(this.draggingData,p),this.doLayout(),this.redraw())},P.prototype.toDraggingDatas=function(S){var P=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(S){S.fileType!==AP&&P.push(S)}),S&&P.reverse()):this.draggingData.fileType!==AP&&P.push(this.draggingData),P},P.prototype.invalidateModel=function(){this._lastWidth=null,this.iv()},P.prototype.ivm=function(){this.invalidateModel()},P.prototype.getContentRect=function(){return{x:0,y:0,width:this.getWidth(),height:this.contentHeight||0}},P.prototype.onPropertyChanged=function(P){S.prototype.onPropertyChanged.apply(this,arguments),GE[P.property]&&this.ivm()},vP(P,[{key:"expandIds",get:function(){var S=[];return this.dirs.forEach(function(P){P.expanded&&S.push(P.getId())}),S},set:function(S){this._expandIds=S,this._lastWidth=null}}]),P}(cE);I(JE,{ms_ac:["filePadding","titleHeight"],_filePadding:6,_titleHeight:36});var $E=function(S){function P(E,p){var l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];$P(this,P);var _=KP(this,S.call(this));_.editor=E,_.rootDir=p,_.modifiable=l,_.copyFileInfos=[],_.dataModel=new ht.DataModel,_.dataModel.setAutoAdjustIndex(!1);var m=_.mode=rP.config.explorerMode;m===UP&&(_.accordion=new JE(_,l)),_.tree=new bE(_,l),_.list=new gE(_,l),_.controlPane=new eP,_.controlPane.addRow([{id:"url",textField:{editable:!1}},{id:"slider",slider:{min:1,max:_.getFileListView().getMaxFileSize(),step:1,onValueChanged:function(S,P){_.getFileListView().setFileSize(P),_.getFileListView().setLayoutType(P>16?IP:nP)}}}],[.1,ht.Default.isTouchable?70:50]);var u=_.controlPane.getItemById("slider").element;return u.getToolTip=function(){},_.getFileListView().mp(function(S){"fileSize"===S.property&&u.setValue(S.newValue)}),_.bottomPane=new XE,_.bottomPane.setCenterView(_.getFileListView()),_.bottomPane.setBottomView(_.controlPane),_.bottomPane.setBottomHeight(ht.Default.widgetRowHeight+8),_.setOrientation("vertical"),m===UP?(_.setLeftView(_.bottomPane),_.setPosition(1),_.accordion.sm().ms(function(){_.$52$(_.accordion)}),_.accordion.setFileSize(rP.config.fileSize),_.setDraggable(!1)):(_.setLeftView(_.tree),_.setRightView(_.bottomPane),_.setPosition(rP.config.explorerSplitViewPosition),_.list.setSelectionModelShared(!1),_.list.sm().ms(function(){_.$52$(_.list)}),_.tree.setVisibleFunc(function(S){return S.fileType===AP||S.fileType===dP}),_.list.setFileSize(rP.config.fileSize)),_.tree.menu=new WE,_.treeMenuItems=[],_.initTreeMenu(_.tree.menu,_.treeMenuItems),_.tree.menu.setItems(_.treeMenuItems),_.tree.menu.addTo(_.tree.getView()),_.editor.menus.push(_.tree.menu),_.list.menu=new WE,_.listMenuItems=[],_.initListMenu(_.list.menu,_.listMenuItems),_.list.menu.setItems(_.listMenuItems),_.list.menu.addTo(_.list.getView()),_.editor.menus.push(_.list.menu),_.isAccordionMode()&&(_.accordion.menu=new WE,_.accordionMenuItems=[],_.initAccordionMenu(_.accordion.menu,_.accordionMenuItems),_.accordion.menu.setItems(_.accordionMenuItems),_.accordion.menu.addTo(_.accordion.getView()),_.editor.menus.push(_.accordion.menu)),_}return BP(P,S),P.prototype.$52$=function(S){var P=S.sm().ld();this.controlPane.v("url",P?P.url:"")},P.prototype.isAccordionMode=function(){return this.mode===UP},P.prototype.parse=function(S){var P=void 0,E=void 0,p=void 0,l=void 0;this.mode===UP?(E=this.accordion.expandIds,P=this.accordion.ty()):(P=this.tree.ty(),E=this.tree.expandIds,p=this.tree.selectionIds,l=this.tree.dm().size()),this.dataModel.clear();var _=this.rootNode=new RE(this.rootDir,"",this.rootDir);this.dataModel.add(_);var m=void 0;S.fileType===AP||S.fileType===dP?(_.a(S.attrs),_.s(S.styles),S.fileIcon&&(_.setIcon(S.fileIcon),_.setImage(S.fileIcon)),m=S.children):m=S;for(var u in m)this.parseChildren(_,u,m[u]);var F=this.dataModel.getDatas(),f={};F.toArray().forEach(function(S,P){f[S._id]=P}),F.sort(function(S,P){return S.fileType===dP?-1:P.fileType===dP?1:S.fileType===AP&&P.fileType!==AP?-1:S.fileType!==AP&&P.fileType===AP?1:f[S._id]-f[P._id]}),this.mode===UP?(this.accordion.expandIds=E,this.accordion.ty(P)):(this.tree.expandIds=E,this.tree.selectionIds=p,this.tree.ty(P),0===l&&(this.tree.expand(this.rootNode),this.tree.sm().ss(this.rootNode)));var H={explorer:this};this.editor.fireEvent("explorerUpdated",H)},P.prototype.parseChildren=function(S,P,E){var p=new RE(this.rootDir,S.url,P,E);p.setParent(S),this.dataModel.add(p);var l=void 0;E.fileType===AP?l=E.children:p.fileType===AP&&(l=E);for(var _ in l)this.parseChildren(p,_,l[_]);return p},P.prototype.deleteSelection=function(S){var P=this,E=[];if(S.sm().getTopSelection().forEach(function(S){var p={data:S,url:S.url};P.editor.fireEvent("fileDeleting",p),p.preventDefault||E.push(S)}),E.length){var p=S.getLabel(E[0])||E[0].getName(),_=l("editor.delete")+" ["+p+"]";E.length>1&&(_+=" ("+E.length+")"),OS(_,l("editor.deleteselection"),function(){P.editor.removeFiles(E)},function(){})}},P.prototype.$53$=function(S){var P=this;S.push("separator"),S.push({id:"expandAll",label:l("editor.expandall"),action:function(){P.tree.expandAll()}}),S.push({id:"collapseAll",label:l("editor.collapseall"),action:function(){P.tree.collapseAll()}})},P.prototype.addDeleteItem=function(S,P){var E=this;this.modifiable&&S.push({id:"delete",label:l("editor.delete"),action:function(){E.deleteSelection(P)},visible:function(){return!!P.sm().ld()}})},P.prototype.addNewFolderItem=function(S,P){var E=this;S.push({id:"newFolder",label:l("editor.newfolder"),action:function(){E.editor.newFolder(P)}})},P.prototype.addLocateTreeFileItem=function(S){var P=this;rP.config.locateFileEnabled&&S.push({id:"locateFile",label:l("editor.locatefile"),action:function(){var S=P.tree.sm().ld()||P.rootNode;P.editor.locate(S)}})},P.prototype.addLocateListFileItem=function(S){var P=this;rP.config.locateFileEnabled&&S.push({id:"locateFile",label:l("editor.locatefile"),action:function(){var S=P.ld||P.tree.sm().ld()||P.rootNode;P.editor.locate(S)}})},P.prototype.$55$=function(S){var P=this;S.push({id:"open",label:l("editor.open"),action:function(){P.editor.open(P.ld)},visible:function(){var S=P.ld;return!!S&&(S.fileType===CP||S.fileType===ZP||S.fileType===oP||S.fileType===yP)}})},P.prototype.addExportItem=function(S){var P=this;S.push({id:"export",label:l("editor.export"),action:function(){var S=[],E=P.getFileListView().sm();E.size()>0&&(E.each(function(P){S.push(P.url)}),P.editor.request("export",S))},visible:function(){var S=P.getFileListView().sm().ld();return!!S&&(S.fileType===CP||S.fileType===ZP||S.fileType===oP||S.fileType===yP)}})},P.prototype.addRenameItem=function(S,P){var E=this;this.modifiable&&S.push({id:"rename",label:l("editor.rename"),action:function(){var S=P.sm().ld();S&&S!==E.rootNode&&P.beginEditing(S)},visible:function(){var S=P.sm().ld();return!(!S||S===E.rootNode)}})},P.prototype.addInsertItem=function(S){var P=this;S.push({id:"insert",label:l("editor.insert"),action:function(){P.editor.$100$(P.getFileListView().sm().ld())},visible:function(){var S=P.getFileListView().sm().ld();return!!S&&(!!P.editor.gv&&(P.editor.url!==S.url&&(S.fileType===oP?!!P.editor.symbolView:S.fileType===ZP||S.fileType===NP)))}})},P.prototype.addCopyItem=function(S){var P=this;S.push({id:"copy",label:l("editor.copy"),action:function(){P.copyFiles()},visible:function(){var S=P.getFileListView().sm().ld();return!(!S||S===P.rootNode)}})},P.prototype.addPasteItem=function(S){var P=this;S.push({id:"paste",label:l("editor.paste"),action:function(){P.pasteFiles()},visible:function(){return!P.isAccordionMode()||!!P.ld}})},P.prototype.copyFiles=function(){var S=this;this.copyFileInfos.length=0,this.getFileListView().sm().each(function(P){if(P.fileType!==dP&&P.fileType!==AP&&P.fileType!==OP){var E={url:P.url,name:P.getName()};S.copyFileInfos.push(E),S.loadFileInfo(E)}})},P.prototype.loadFileInfo=function(S){var P=S.url;if(this.editor.requestBase64(P,function(P){S.content=P}),pS(P)){var E=FS(P);this.dataModel.getDataById(E)&&this.editor.requestBase64(E,function(P){S.image=P})}},P.prototype.pasteFiles=function(){var S=this;this.copyFileInfos.forEach(function(P){if(P.content){var E=P.url,p=void 0,l=2,_=S.currentDir+"/"+v(P.name),m=E.substring(E.lastIndexOf("."),E.length);for(p=_+m;S.dataModel.getDataById(p);)p=_+" "+l+++m;var u={path:p,content:P.content};S.editor.request("upload",u),P.image&&(u.path=FS(p),u.content=P.image,S.editor.request("upload",u))}})},P.prototype.enableDroppableToSymbolView=function(){var S=this.list;this.mode===UP&&(S=this.accordion),S.isDroppableToSymbolView=!0},P.prototype.enableDroppableToDisplayView=function(){var S=this.list;this.mode===UP&&(S=this.accordion),S.isDroppableToDisplayView=!0},P.prototype.getFileListView=function(){return this.mode===UP?this.accordion:this.list},P.prototype.initTreeMenu=function(S,P){},P.prototype.initListMenu=function(S,P){},P.prototype.initAccordionMenu=function(S,P){},vP(P,[{key:"currentDir",get:function(){var S=void 0;return this.isAccordionMode()?(S=this.ld,S&&S.fileType!==AP&&(S=S.getParent()),S?S.url:this.accordion.dirs[this.accordion.dirs.length-1].url):(S=this.tree.sm().ld(),S?S.url:this.rootDir)}},{key:"ld",get:function(){return this.getFileListView().sm().ld()}}]),P}(aE);rP.Explorer=$E;var vE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E,"displays",p));return l.enableDroppableToDisplayView(),l}return BP(P,S),P.prototype.initTreeMenu=function(S,P){this.addLocateTreeFileItem(P),this.addNewFolderItem(P,this.tree),this.addNewDisplayItem(P),
this.addRenameItem(P,this.tree),this.addDeleteItem(P,this.tree),this.$53$(P)},P.prototype.initListMenu=function(S,P){this.$55$(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.list),this.addNewDisplayItem(P),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.list),this.addDeleteItem(P,this.list),this.addExportItem(P)},P.prototype.initAccordionMenu=function(S,P){this.$55$(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.accordion),this.addNewDisplayItem(P),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.accordion),this.addDeleteItem(P,this.accordion),this.addExportItem(P)},P.prototype.addNewDisplayItem=function(S){var P=this;S.push({id:"newDisplayView",label:l("editor.newdisplayview"),action:function(){P.editor.newDisplayView(),P.editor.save()},visible:function(){if(P.isAccordionMode()){var S=P.accordion.sm().ld();return S&&S.fileType===AP}return!0}})},P}($E),BE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E,"symbols",p));return l.enableDroppableToDisplayView(),l.enableDroppableToSymbolView(),l}return BP(P,S),P.prototype.initTreeMenu=function(S,P){this.addLocateTreeFileItem(P),this.addNewFolderItem(P,this.tree),this.addNewSymbolItem(P),this.addRenameItem(P,this.tree),this.addDeleteItem(P,this.tree),this.$53$(P)},P.prototype.initListMenu=function(S,P){this.$55$(P),this.addInsertItem(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.list),this.addNewSymbolItem(P),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.list),this.addDeleteItem(P,this.list),this.addExportItem(P)},P.prototype.initAccordionMenu=function(S,P){this.$55$(P),this.addInsertItem(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.accordion),this.addNewSymbolItem(P),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.accordion),this.addDeleteItem(P,this.accordion),this.addExportItem(P)},P.prototype.addNewSymbolItem=function(S){var P=this;S.push({id:"newSymbolView",label:l("editor.newsymbolview"),action:function(){P.editor.newSymbolView(),P.editor.save()}})},P}($E),KE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E,"components",p));return l.enableDroppableToSymbolView(),l}return BP(P,S),P.prototype.initTreeMenu=function(S,P){this.addLocateTreeFileItem(P),this.addNewFolderItem(P,this.tree),this.addNewComponentItem(P),this.addRenameItem(P,this.tree),this.addDeleteItem(P,this.tree),this.$53$(P)},P.prototype.initListMenu=function(S,P){this.$55$(P),this.addInsertItem(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.list),this.addNewComponentItem(P),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.list),this.addDeleteItem(P,this.list),this.addExportItem(P)},P.prototype.initAccordionMenu=function(S,P){this.$55$(P),this.addInsertItem(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.accordion),this.addNewComponentItem(P),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.accordion),this.addDeleteItem(P,this.accordion),this.addExportItem(P)},P.prototype.addNewComponentItem=function(S){var P=this;S.push({id:"newComponent",label:l("editor.newcomponent"),action:function(){P.editor.newComponent()}})},P}($E),LE=function(S){function P(E){var p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];$P(this,P);var l=KP(this,S.call(this,E,"assets",p));return l.enableDroppableToDisplayView(),l.enableDroppableToSymbolView(),l}return BP(P,S),P.prototype.initTreeMenu=function(S,P){this.addLocateTreeFileItem(P),this.addNewFolderItem(P,this.tree),this.addRenameItem(P,this.tree),this.addDeleteItem(P,this.tree),this.$53$(P)},P.prototype.initListMenu=function(S,P){this.addInsertItem(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.list),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.list),this.addDeleteItem(P,this.list),this.$54$(P)},P.prototype.initAccordionMenu=function(S,P){this.addInsertItem(P),this.addLocateListFileItem(P),this.addNewFolderItem(P,this.accordion),this.addCopyItem(P),this.addPasteItem(P),this.addRenameItem(P,this.accordion),this.addDeleteItem(P,this.accordion),this.$54$(P)},P.prototype.$54$=function(S){var P=this;S.push("separator"),S.push({id:"convertToDisplay",label:l("editor.converttodisplay"),action:function(){P.editor.open(P.getFileListView().sm().ld(),!1)},visible:function(){var S=P.getFileListView().sm().ld();return!!S&&(mS(S.url)||uS(S.url))}}),S.push({id:"convertToSymbol",label:l("editor.converttosymbol"),action:function(){P.editor.open(P.getFileListView().sm().ld(),!0)},visible:function(){var S=P.getFileListView().sm().ld();return!!S&&(mS(S.url)||uS(S.url))}})},P}($E),eE=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p}return BP(P,S),P.prototype.$6$=function(S){this.setGraphView(this.editor.gv)},P}(iE),rE=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editView=E,p.editor=E.editor,p._topCanvas=A(),p._topDiv=N(),p._view.insertBefore(p._topCanvas,p._scrollBarDiv),p._view.insertBefore(p._topDiv,p._scrollBarDiv);var l=[];return p.menu=new WE(l),p.initMenuItems(l),p.menu.addTo(p.getView()),p.editor.menus.push(p.menu),p.addTopPainter(function(S){return S.texureImage2D=!0}),p}return BP(P,S),P.prototype.$57$=function(S){var P=this;S.push({id:"copy",label:l("editor.copy"),action:function(){P.editor.copy()},visible:function(){return!!P.editor.ld}}),S.push({id:"paste",label:l("editor.paste"),action:function(){P.editor.paste()},visible:function(){return P.editor.hasCopyInfo()}})},P.prototype.$56$=function(S){var P=this;S.push({separator:!0,visible:function(){return!!P.editor.ld}}),S.push({id:"bringToFront",label:l("editor.bringtofront"),action:function(){P.editor.bringToFront()},visible:function(){return!!P.editor.ld}}),S.push({id:"bringForward",label:l("editor.bringforward"),action:function(){P.editor.bringForward()},visible:function(){return!!P.editor.ld}}),S.push({id:"sendBackward",label:l("editor.sendbackward"),action:function(){P.editor.sendBackward()},visible:function(){return!!P.editor.ld}}),S.push({id:"sendToBack",label:l("editor.sendtoback"),action:function(){P.editor.sendToBack()},visible:function(){return!!P.editor.ld}})},P.prototype.initMenuItems=function(S){},P.prototype.onClosed=function(){_(this.editor.menus,this.menu)},P.prototype.$58$=function(S){return S&&this.copyMap[S._id]?S._id:S},P.prototype.$50$=function(S,P){return S instanceof ht.Data?this.dm().contains(S)?S:void 0:P[S]},P.prototype.getSelectWidth=function(S){return!this.isEditable(S)||S instanceof ht.Edge?S.s("select.width"):0},P.prototype.onSelectionChanged=function(S){if(1===this.sm().size()&&("set"===S.kind||"append"===S.kind)){var P=this.sm().ld();P&&document.activeElement===this.getView()&&this._dataModel.isAutoAdjustIndex()&&this.adjustIndex(P)}},P.prototype.getContentRect=function(){var P=S.prototype.getContentRect.call(this);return P.width&&P.height||(P={x:0,y:0,width:this.dm().a("width")||100,height:this.dm().a("height")||100,empty:!0}),P},P.prototype.isDroppable=function(S,P){return!1},P.prototype.$59$=function(S){if(this.dragImage){var P=rP.config.dragImageSize,E=j(S);this.dragImage.style.left=E.x-P/2+"px",this.dragImage.style.top=E.y-P/2+"px"}},P.prototype.removeDragImage=function(){this.dragImage&&(e(this.dragImage),this.dragImage=null)},P.prototype.handleCrossDrag=function(S,P,E){var p=this,l=E.view,_=l.draggingData;if("enter"===P){if(this._topDiv.style.border="solid "+rP.config.color_select_dark+" 2px",!this.dragImage&&_&&(_.fileType===NP||_.fileType===ZP||_.fileType===CP||_.fileType===oP||_.a("dragImage"))){var m=_.a("dragImage")||_.getImage();if(ht.Default.getImage(m)!==ht.Default.getImage("editor.unknown")){var u=rP.config.dragImageSize;this.dragImage=ht.Default.toCanvas(m,u,u,"centerUniform",_,E.view,null,ht.Default.devicePixelRatio),this.$59$(S),this.dragImage.style.opacity=rP.config.dragImageOpacity,this.dragImage.className="ht-editor-dnd-image",ht.Default.appendToScreen(this.dragImage)}}}else if("exit"===P||"cancel"===P)this._topDiv.style.border="",this.removeDragImage();else if("over"===P)this.$59$(S);else if("drop"===P)if(this._topDiv.style.border="",_){this.removeDragImage();var F=this.lp(S);l.isSelected(_)?l.sm().toSelection().each(function(P){l.handleDropToEditView?l.handleDropToEditView(p.editView,P,F,S):p.editor.$100$(P,F)}):l.handleDropToEditView?l.handleDropToEditView(this.editView,_,F,S):this.editor.$100$(_,F)}else l===this.editor.dndFromOutside&&this.editor.dropLocalFileOnGraphView(S)},P}(hE),qE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P.prototype.initMenuItems=function(S){this.$57$(S),this.$56$(S),this.addBlockItems(S)},P.prototype.isDroppable=function(S,P){return!!P.view.isDroppableToDisplayView},P.prototype.isSelectable=function(P){return!P._refGraph&&S.prototype.isSelectable.call(this,P)},P.prototype.addBlockItems=function(S){var P=this,E=function(){return P.sm().size()>0},p=function(){for(var S=0;S<P.sm().size();S++){var E=P.sm().getSelection().get(S);if(E instanceof ht.Block&&!(E instanceof ht.RefGraph))return!0}return!1};S.push({separator:!0,visible:function(){return E()||p()}}),S.push({id:"block",label:l("editor.block"),action:function(){P.editor.block()},visible:E}),S.push({id:"unblock",label:l("editor.unblock"),action:function(){P.editor.unblock()},visible:p})},P}(rE),OE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.defaultValueMap={},_.parse(E,p,l),_}return BP(P,S),P.prototype.toLabel=function(){return this.getDisplayName()||this.s("type")||l("editor.comptype.comp")},P.prototype.getClass=function(){return P},P.prototype.getStyle=function(P,E){var p=S.prototype.getStyle.call(this,P,E);return void 0===p&&(p=this.defaultValueMap[P]),p},P.prototype.$61$=function(S){this.properties&&(this.properties=null),this.disableDirty=!0,this.defaultValueMap={};var P=this.s("type"),E=ht.Default.getCompType(P);if(E){this.$60$=null;var p={cache:E,width:{value:100,isSafeFunc:!0,func:function(S){return S._width}},height:{value:100,isSafeFunc:!0,func:function(S){return S._height}},comps:[{type:{func:function(S){return S.compType},isSafeFunc:!0}}]};if(!E.width||this._width>0||this.setWidth(E.width),!E.height||this._height>0||this.setHeight(E.height),E.properties){this.properties=E.properties;for(var l in this.properties){var _=this.properties[l];p.comps[0][l]={func:"style@"+l},S?jS(this,l,S[l],_.defaultValue):void 0===this.s(l)&&jS(this,l,void 0,_.defaultValue),this.defaultValueMap[l]=_.defaultValue}}var m=rP.config.customProperties.comp;m&&m.length&&m.forEach(function(S){var P=S.property;p.comps[0][P]={func:"style@"+P}}),this.setImage(p),this.ivLater()}else this.$60$=S,"editor.comp"!==this.getImage()&&(this.setImage("editor.comp"),this.ivLater());this.disableDirty=!1},P.prototype.ivLater=function(){var S=this;ht.Default.callLater(function(){S.disableDirty=!0,S.iv(),S.disableDirty=!1})},P.prototype.onStyleChanged=function(P,E,p){S.prototype.onStyleChanged.call(this,P,E,p),"type"===P&&this.$61$(this.parsingComp)},P.prototype.parse=function(S,P,E){S&&(this.parsingComp=S,jS(this,"type",S.type),this.$61$(S),MS(this,S,P,E),this.parsingComp=null)},P.prototype.toJSON=function(){var S={};if(sS(this,S,"type","type",void 0),bS(this,S),this.properties)for(var P in this.properties){var E=this.properties[P];sS(this,S,P,P,E.defaultValue)}return S},vP(P,[{key:"compType",get:function(){var S=this.s("type");return this.$60$?this.$61$(this.$60$):S&&ht.Default.getCompType(S)!==this.getImage().cache&&this.$61$(),S}}]),P}(ht.Node),dE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.s({border_color:rP.config.color_dark,border_width:1}),_.setImage("border_image"),_.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.border")},P.prototype.parse=function(S,P,E){S&&(jS(this,"type",S.type,"border"),jS(this,"border_color",S.color,rP.config.color_dark),jS(this,"border_width",S.width,1),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"type","type",void 0),sS(this,S,"border_color","color",void 0),sS(this,S,"border_width","width",void 0),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("type")}}]),P}(ht.Node),AE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.setSize(100,100),_.setImage("pieChart_image"),_.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.hollw":!1,"chart.start.angle":0,"chart.values":[],"chart.colors":void 0}),_.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.piechart")},P.prototype.parse=function(S,P,E){S&&(jS(this,"chart.type",S.type,"pieChart"),jS(this,"chart.label",S.label,!1),jS(this,"chart.label.color",S.labelColor,ht.Default.labelColor),jS(this,"chart.label.font",S.labelFont,ht.Default.labelFont),jS(this,"chart.hollow",S.hollow,!1),jS(this,"chart.start.angle",S.startAngle,0),jS(this,"chart.values",S.values,[]),jS(this,"chart.colors",S.colors,void 0),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"chart.type","type",void 0),sS(this,S,"chart.label","label",!1),sS(this,S,"chart.label.color","labelColor",ht.Default.labelColor),sS(this,S,"chart.label.font","labelFont",ht.Default.labelFont),sS(this,S,"chart.hollow","hollow",!1),sS(this,S,"chart.start.angle","startAngle",0),sS(this,S,"chart.values","values",[]),sS(this,S,"chart.colors","colors",void 0),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("chart.type")}}]),P}(ht.Node),NE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.setSize(100,100),_.setImage("columnChart_image"),_.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0}),_.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.columnchart")},P.prototype.parse=function(S,P,E){S&&(jS(this,"chart.type",S.type,void 0),jS(this,"chart.label",S.label,!1),jS(this,"chart.label.color",S.labelColor,ht.Default.labelColor),jS(this,"chart.label.font",S.labelFont,ht.Default.labelFont),jS(this,"chart.series",S.series,[]),jS(this,"chart.min.value",S.minValue,0),jS(this,"chart.max.value",S.maxValue,void 0),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"chart.type","type",void 0),sS(this,S,"chart.label","label",!1),sS(this,S,"chart.label.color","labelColor",ht.Default.labelColor),sS(this,S,"chart.label.font","labelFont",ht.Default.labelFont),sS(this,S,"chart.series","series",[]),sS(this,S,"chart.min.value","minValue",0),sS(this,S,"chart.max.value","maxValue",void 0),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("chart.type")}}]),P}(ht.Node),ZE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.setSize(100,100),_.setImage("lineChart_image"),_.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0,"chart.line.point":!1,"chart.line.width":2,"chart.line.3d":!1}),_.parse(E,p,l),_}return BP(P,S),P.prototype.getClass=function(){return P},P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.linechart")},P.prototype.parse=function(S,P,E){S&&(jS(this,"chart.type",S.type,void 0),jS(this,"chart.label",S.label,!1),jS(this,"chart.label.color",S.labelColor,ht.Default.labelColor),jS(this,"chart.label.font",S.labelFont,ht.Default.labelFont),jS(this,"chart.series",S.series,[]),jS(this,"chart.min.value",S.minValue,0),jS(this,"chart.max.value",S.maxValue,void 0),jS(this,"chart.line.point",S.linePoint,!1),jS(this,"chart.line.width",S.lineWidth,2),jS(this,"chart.line.3d",S.line3d,!1),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return sS(this,S,"chart.type","type",void 0),sS(this,S,"chart.label","label",!1),sS(this,S,"chart.label.color","labelColor",ht.Default.labelColor),sS(this,S,"chart.label.font","labelFont",ht.Default.labelFont),sS(this,S,"chart.series","series",[]),sS(this,S,"chart.min.value","minValue",0),sS(this,S,"chart.max.value","maxValue",void 0),sS(this,S,"chart.line.point","linePoint",!1),sS(this,S,"chart.line.width","lineWidth",2),sS(this,S,"chart.line.3d","line3d",!1),bS(this,S),S},vP(P,[{key:"compType",get:function(){return this.s("chart.type")}}]),P}(ht.Node),CE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this,E.getView().graphView));return _.tab=E,_.editView=E.getView(),_.editor=_.editView.editor,_.clazz=p,_.type=l,_}return BP(P,S),P.prototype.beginTransaction=function(){this._isBeginTransaction||(this._isBeginTransaction=!0,this.dm.beginTransaction())},P.prototype.endTransaction=function(){this._isBeginTransaction&&(this._isBeginTransaction=!1,this.dm.endTransaction())},P.prototype.getDataAt=function(S){return this.gv.getDataAt(S)},P.prototype.getNodeAt=function(S){var P=this.getDataAt(S);return P instanceof ht.Node?P:null},P.prototype.setUp=function(){S.prototype.setUp.call(this),this.sm.cs()},P.prototype.$0$=function(S){},P.prototype.drawRect=function(S,P,E,p){P=this.toRect(P),p&&(S.fillStyle=p),E&&(S.strokeStyle=E),S.lineWidth=1,S.beginPath(),S.rect(P.x,P.y,P.width,P.height),S.stroke(),p&&S.fill(),E&&S.stroke()},P.prototype.drawPoint=function(S,P,E,p,l){P=this.toPoint(P),l&&(S.fillStyle=l),p&&(S.strokeStyle=p),S.lineWidth=1,S.beginPath(),S.arc(P.x,P.y,E,0,2*Math.PI,!0),l&&S.fill(),p&&S.stroke()},P.prototype.drawPoints=function(S,P,E,p,l){for(var _=0;_<P.length;_++)this.drawPoint(S,P[_],E,p,l)},P.prototype.drawLine=function(S,P,E,p){P=this.toPoint(P),E=this.toPoint(E),S.lineWidth=1,S.strokeStyle=p,S.beginPath(),S.moveTo(P.x,P.y),S.lineTo(E.x,E.y),S.stroke()},P.prototype.toRect=function(S){var P=this.zoom;return{x:S.x*P+this.tx,y:S.y*P+this.ty,width:S.width*P,height:S.height*P}},P.prototype.toPoint=function(S){return{x:S.x*this.zoom+this.tx,y:S.y*this.zoom+this.ty}},P.prototype.add=function(S){this.editView.addData(S)},P.prototype.remove=function(S){this.dm.remove(S)},P.prototype.lp=function(S){return this.gv.lp(S)},vP(P,[{key:"dm",get:function(){return this.gv.dm()}},{key:"sm",get:function(){return this.gv.dm().sm()}},{key:"zoom",get:function(){return this.gv.getZoom()}},{key:"tx",get:function(){return this.gv.tx()}},{key:"ty",get:function(){return this.gv.ty()}}]),P}(ht.graph.Interactor),oE=function(S){function P(E,p,l){return $P(this,P),KP(this,S.call(this,E,p,l))}return BP(P,S),P.prototype.tearDown=function(){S.prototype.tearDown.call(this),this.node=this.p1=this.p2=null},P.prototype.$49$=function(S){this.node?this.remove(this.node):this.editView.$5$("edit")},P.prototype.handle_mousedown=function(S){this.handle_touchstart(S)},P.prototype.handle_touchstart=function(S){U(S),k(S)&&(this.gv.setFocus(S),this.p1=this.lp(S),this.startDragging(S))},P.prototype.handleWindowMouseMove=function(S){this.handleWindowTouchMove(S)},P.prototype.handleWindowMouseUp=function(S){this.handleWindowTouchEnd(S)},P.prototype.handleWindowTouchMove=function(S){if(U(S),this.p1){this.p2=this.lp(S);var P=V(this.p1,this.p2);if(this.node)this.node.setRect(P);else{if(!P.width||!P.height)return;this.beginTransaction(),this.createNode(P,!1)}}},P.prototype.handleWindowTouchEnd=function(S){if(U(S),this.endTransaction(),!this.node&&this.p1&&this.createNode({x:this.p1.x-25,y:this.p1.y-25,width:50,height:50},!0),this.node){var P="display"===this.editView.type?"dataCreated":"compCreated",E={data:this.node};E["display"===this.editView.type?"displayView":"symbolView"]=this.editView,this.editor.fireEvent(P,E)}rP.config.continuousCreating?this.node=this.p1=this.p2=null:this.editView.$5$("edit")},P.prototype.createNode=function(S,P){TS(this.type)?this.node=this.type(S,P):this.node=new this.clazz,P?this.node.setPosition(S.x+S.width/2,S.y+S.height/2):this.node.setRect(S),this.node.setParent(this.editView.graphView.getCurrentSubGraph()),this.dm.add(this.node),this.dm.sm().ss(this.node),this.editView.graphView.setFocus()},P.prototype.$0$=function(S){this.node&&this.drawRect(S,this.node.getRect(),rP.config.color_data_border)},P}(CE),DE=function(S){function P(E,p,l){return $P(this,P),KP(this,S.call(this,E,p,l))}return BP(P,S),P.prototype.tearDown=function(){S.prototype.tearDown.call(this),this.draggingPoint=this.n1=this.n2=null},P.prototype.$49$=function(S){this.n1?(this.draggingPoint=this.n1=this.n2=null,this.editView.validateCanvas()):this.editView.$5$("edit")},P.prototype.$0$=function(S){if(this.n1&&(this.drawRect(S,this.gv.getNodeRect(this.n1),rP.config.color_data_border),this.draggingPoint&&this.drawLine(S,this.n1.p(),this.draggingPoint,rP.config.color_data_border)),this.n2){var P=this.gv.getNodeRect(this.n2);this.n1!==this.n2&&this.drawRect(S,P,rP.config.color_data_border);var E=this.toPoint({x:P.x,y:P.y});S.beginPath(),S.moveTo(E.x,E.y-15-3),S.lineTo(E.x+10,E.y-15-3),S.lineTo(E.x+10,E.y-3),S.lineTo(E.x+5,E.y-7-3),S.moveTo(E.x+10,E.y-3),S.lineTo(E.x+15,E.y-7-3),S.lineWidth=1,S.strokeStyle=rP.config.color_data_border,S.stroke()}},P.prototype.handle_mousemove=function(S){if(U(S),!this.draggingPoint){var P=this.getNodeAt(S);P!==this.n1&&(this.n1=P,this.editView.validateCanvas())}},P.prototype.handle_mousedown=function(S){this.handle_touchstart(S)},P.prototype.handle_touchstart=function(S){U(S),k(S)&&(this.gv.setFocus(S),this.draggingPoint||(this.n1=this.getNodeAt(S),this.n1&&(this.draggingPoint=this.lp(S),this.startDragging(S))))},P.prototype.handleWindowMouseMove=function(S){this.handleWindowTouchMove(S)},P.prototype.handleWindowMouseUp=function(S){this.handleWindowTouchEnd(S)},P.prototype.handleWindowTouchMove=function(S){var P=this.getNodeAt(S);this.draggingPoint=this.lp(S),this.autoScroll(S),(rP.config.edgeLoop||this.n1!==P)&&(this.n2=P),this.editView.validateCanvas()},P.prototype.handleWindowTouchEnd=function(S){if(this.n1&&this.n2){var P=void 0;fS(this.type)?(P=new this.clazz(this.n1,this.n2),P.s("edge.type",this.type)):P=TS(this.type)?this.type(this.n1,this.n2):new this.clazz(this.n1,this.n2),this.add(P),rP.config.continuousCreating||this.editView.$5$("edit")}this.draggingPoint=this.n1=this.n2=null,this.editView.validateCanvas()},P}(CE),yE=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this,E,p,l));return _.points=[],_.segments=[],_.nextPoint=null,_}return BP(P,S),P.prototype.tearDown=function(){S.prototype.tearDown.call(this),this.points=[],this.segments=[],this.nextPoint=null,this.isBreak=!1},P.prototype.$49$=function(S){this.isBreak?this.createShape():(this.preCtrl=null,this.isBreak=!0,this.editView.validateCanvas())},P.prototype.createShape=function(){if(this.points.length>1){var S=void 0;TS(this.type)?S=this.type(this.points,this.segments):(S=new this.clazz,S.setPoints(this.points),S.setSegments(this.segments)),this.add(S)}this.editView.$5$("edit"),this.editor.pointsEditingMode=!0},P.prototype.handle_mousedown=function(S){this.handle_touchstart(S)},P.prototype.handle_touchstart=function(S){if(U(S),k(S)){if(this.gv.setFocus(S),Y(S))this.createShape();else{var P=this.judgeNextPoint(S,!0);if(this.points.length){var E=this.points[this.points.length-1];if(Math.abs(E.x-P.x)<.01&&Math.abs(E.y-P.y)<.01)return}this.preCtrl?(this.points.push(this.preCtrl),this.points.push(P),this.points.push(P),this.segments.push(4),this.preCtrl=null):(this.isBreak?(this.segments.push(1),this.isBreak=!1):this.segments.push(this.points.length>0?2:1),this.points.push(P)),this.nextPoint=this.lp(S),this.editView.validateCanvas()}this.downPoint=this.lp(S),this.startDragging(S),this._dragging=!0}},P.prototype.judgeNextPoint=function(S,P){var E=this.lp(S);if(this._dragging||this.isBreak&&!P)return null;if(ht.Default.isShiftDown()&&this.points.length>0){var p=this.points[this.points.length-1],l=E.x-p.x,_=E.y-p.y,m=Math.atan2(_,l),u=ht.Default.getDistance(p,E),F=m%(Math.PI/4);return m-=F,Math.abs(F)>Math.PI/8&&(F>0?m+=Math.PI/4:m-=Math.PI/4),{x:p.x+Math.cos(m)*u,y:p.y+Math.sin(m)*u}}var f=this.gv.getEditInteractor(),H=f.gridGuide.findClosest(E);return H&&(H.x&&(E.x+=H.x),H.y&&(E.y+=H.y)),E},P.prototype.handle_mousemove=function(S){this.nextPoint=this.judgeNextPoint(S),this.editView.validateCanvas()},P.prototype.handle_touchend=function(S){},P.prototype.handle_mouseup=function(S){this.handle_touchend(S)},P.prototype.handleWindowTouchMove=function(S){return this.handleWindowMouseMove(S)},P.prototype.updateCtrl=function(S){var P=this.points.length,E=this.points[P-1],p=this.downPoint,l=this.lp(S),_=this.gv.getZoom(),m=ht.Default.getDistance(p,l),u=this.segments[this.segments.length-1];if(m*_>5){if(ht.Default.isShiftDown()){var F=Math.abs;F(E.x-l.x)>=F(E.y-l.y)?l.y=E.y:l.x=E.x}else{var f=this.gv.getEditInteractor(),H=f.gridGuide.findClosest(l);H&&(H.x&&(l.x+=H.x),H.y&&(l.y+=H.y))}var T={x:2*E.x-l.x,y:2*E.y-l.y};4===u?this.points[P-2]=T:1!==u&&(this.segments.pop(),this.segments.push(4),this.points.splice(P-1,0,T),this.points.push(this.points[P-1])),this.preCtrl=l}else 4===u&&(this.points[P-2]=this.points[P-1],this.preCtrl=null)},P.prototype.handleWindowMouseMove=function(S){0!==this.points.length&&(this.updateCtrl(S),this.editView.validateCanvas())},P.prototype.handleWindowTouchEnd=function(S){return this.handleWindowMouseUp(S)},P.prototype.handleWindowMouseUp=function(S){0!==this.points.length&&(this._dragging=!1,this.updateCtrl(S),this.nextPoint=this.judgeNextPoint(S,!0))},P.prototype.$0$=function(S){var P=[];S.beginPath();for(var E=0,p=void 0,l=void 0,_=void 0,m=0;m<this.segments.length;m++){var u=this.segments[m];1===u?(p=this.toPoint(this.points[E++]),S.moveTo(p.x,p.y)):2===u?(p=this.toPoint(this.points[E++]),S.lineTo(p.x,p.y)):3===u?(p=this.toPoint(this.points[E++]),l=this.toPoint(this.points[E++]),S.quadraticCurveTo(p.x,p.y,l.x,l.y)):4===u?(p=this.toPoint(this.points[E++]),l=this.toPoint(this.points[E++]),_=this.toPoint(this.points[E++]),S.bezierCurveTo(p.x,p.y,l.x,l.y,_.x,_.y)):5===u&&S.closePath(),P.push(this.points[E-1])}var F=this.preCtrl;if(this.nextPoint)if(F)p=this.toPoint(F),l=this.toPoint(this.nextPoint),_=this.toPoint(this.nextPoint),S.bezierCurveTo(p.x,p.y,l.x,l.y,_.x,_.y);else{var f=this.toPoint(this.nextPoint);S.lineTo(f.x,f.y)}if(S.strokeStyle=rP.config.color_data_border,S.lineWidth=1,S.stroke(),this.drawPoints(S,P,4,rP.config.color_data_border,rP.config.color_data_background),F){var H=this.points[this.points.length-1],T=this.gv.getZoom(),X=3/T,W=6/T,h={x:2*H.x-F.x,y:2*H.y-F.y};this.drawLine(S,F,h,rP.config.color_data_border),this.drawRect(S,{x:h.x-X,y:h.y-X,width:W,height:W},rP.config.color_data_border,rP.config.color_data_background),this.drawRect(S,{x:F.x-X,y:F.y-X,width:W,height:W},rP.config.color_data_border,rP.config.color_data_background)}},P}(CE),IE={width:!0,height:!0,position:!0,rotation:!0,anchor:!0,scale:!0,expanded:!0},nE={border:dE,rect:mE,circle:mE,oval:mE,roundRect:mE,star:mE,triangle:mE,hexagon:mE,pentagon:mE,diamond:mE,rightTriangle:mE,parallelogram:mE,trapezoid:mE,polygon:mE,arc:mE,image:FE,shape:uE,text:fE,pieChart:AE,oneDimensionalColumnChart:NE,columnChart:NE,lineChart:ZE,comp:OE},UE=function(){function S(P,E,p,l){var _=this;$P(this,S),this.editor=P,this.tab=E,this.type=l,E.setView(this);var m=this.graphView=new p(this);this._view=d(!0,this),m.addViewListener(function(S){"validate"===S.kind&&_.validateCanvas()}),this._hRuler=A(),this._vRuler=A(),this._view.appendChild(m.getView()),this.$5$("edit"),m.isInteractive=function(){return!1},m.addPropertyChangeListener(function(){_.iv()}),m.addInteractorListener(function(S){_.handleInteractorEvent(S)}),this.dm.sm().addSelectionChangeListener(function(S){_.iv()}),this.dm.addDataModelChangeListener(function(S){_.handleDataModelChanged(S)}),this.dm.addDataPropertyChangeListener(function(S){_.handleDataPropertyChanged(S)}),this.dm.addPropertyChangeListener(function(S){_.handleDataModelPropertyChanged(S)}),this.dm.addHierarchyChangeListener(function(S){_.handleHierarchyChanged(S)}),this.dm.layout=function(S,P){_._autoLayout||(_._autoLayout=new ht.layout.AutoLayout(m)),_._autoLayout.options=P||{};var E=_.graphView.getZoom(),p=_.graphView.tx(),l=_.graphView.ty();_.dm.beginTransaction(),_._autoLayout.setAnimate(rP.config.animate);var u=function(){var S=_.graphView.getZoom(),P=_.graphView.tx(),m=_.graphView.ty(),u={undo:function(){_.graphView.setZoom(E),_.graphView.tx(p),_.graphView.ty(l)},redo:function(){_.graphView.setZoom(S),_.graphView.tx(P),_.graphView.ty(m)}};_.dm.addHistory(u),_.dm.endTransaction()};_._autoLayout.layout(S,function(){rP.config.animate?m.fitContent({finishFunc:u}):(m.fitContent(!1,rP.config.fitPadding),u())})},this.graphView.setEditable(!0),this.graphView.getInteractors().each(function(S){S.keep=!0}),this.setRulerEnabled(this.editor.isRulerEnabled()),this.init()}return S.prototype.handleInteractorEvent=function(S){"prepareMove"!==S.kind&&"prepareEdit"!==S.kind||!S.event.altKey||(this.editor.copy(),this.editor.paste(!0),this.editor.gv.validate())},S.prototype.handleDataModelChanged=function(S){this.dirty=!0},S.prototype.handleDataPropertyChanged=function(S){S.data.disableDirty||this.graphView.fpImageLoaded||"*"!==S.property&&(IE[S.property]&&this.iv(),this.dirty=!0)},S.prototype.handleHierarchyChanged=function(S){this.dirty=!0},S.prototype.handleDataModelPropertyChanged=function(S){var P=S.property,E=S.newValue;null!=E&&("a:gridBlockSize"===P?this.graphView.getEditInteractor().setStyle("gridBlockSize",E):"a:gridThickLinesEvery"===P?this.graphView.getEditInteractor().setStyle("gridThickLinesEvery",E):"a:gridThickColor"===P?this.graphView.getEditInteractor().setStyle("gridThickColor",E):"a:gridLightColor"===P?this.graphView.getEditInteractor().setStyle("gridLightColor",E):"a:gridAngle"===P?this.graphView.getEditInteractor().setStyle("gridAngle",E):"a:gridRotation"===P?this.graphView.getEditInteractor().setStyle("gridRotation",E):"a:gridZoomThreshold"===P&&this.graphView.getEditInteractor().setStyle("gridZoomThreshold",E)),"a:connectActionType"===P?this.graphView.setCurrentConnectActionType(E):"a:rotateAsClock"===P&&this.graphView.getEditInteractor().setStyle("rotateAsClock",E),this.dirty=!0,this.validateCanvas()},S.prototype.onPropertyChanged=function(S){"rulerEnabled"===S.property&&(this.graphView.getEditInteractor().alignmentGuideEnabled=S.newValue),this.iv()},S.prototype.parse=function(S,P){(S||P)&&(this.url=S,P?this.update(P):r(S,this.update.bind(this)))},S.prototype.update=function(S,P){var E=this;if(S)if(P){var p=G(this.content),l=S,_={undo:function(){E._updateImpl(p,!0)},redo:function(){E._updateImpl(l,!0)}};this.dm.disableHistoryManager(),this._updateImpl(S,P),this.dm.enableHistoryManager(),this.dm.addHistory(_)}else this.dm.disableHistoryManager(),this._updateImpl(S,P),this.dm.enableHistoryManager(),this.dm.clearHistoryManager()},S.prototype._saveNew=function(S,P,E,p){var _=this,m=function(E,m){if("ok"===m){var u=pS(E)?v(E):E,F=p+"/"+u+".json";_.editor.getFileNode(F)?OS(l("editor.filenameconflict"),F,function(){S&&S()}):(_.tab.setName(u),_.url=F,_.tab.setTag(_.url),_.editor.dataView.updateUrl(),_._saveImpl(P))}else S&&S()},u={name:void 0};if("display"===this.type?(u.displayView=this,this.editor.fireEvent("displayViewNewNameInputing",u)):"symbol"===this.type&&(u.symbolView=this,this.editor.fireEvent("symbolViewNewNameInputing",u)),u.preventDefault)return!1;u.name?m(u.name,"ok"):qS(E,this.tab.getName(),{nullable:!1,trim:!0,maxLength:rP.config.maxFileNameLength},m)},S.prototype._saveAs=function(S,P){this.tab.setName(B(P)),this.url=P,this.tab.setTag(this.url),this.editor.dataView.updateUrl(),this._saveImpl(S)},S.prototype._saveImpl=function(S){var P=this,E=this.url,p={url:E}
;if("display"===this.type?(rP.config.settingDefaultValueBeforeSaving&&this.dm.each(function(S){if(S instanceof ht.Node){var P=ht.Default.getImage(S.getImage());P&&P.dataBindings&&P.dataBindings.forEach(function(P){var E=S.getAttrObject(),p=P.defaultValue;if(void 0!==p){var l=P.attr;E&&void 0!==E[l]||S.a(l,p)}})}}),p.displayView=this,this.editor.fireEvent("displayViewSaving",p)):"symbol"===this.type&&(p.symbolView=this,this.editor.fireEvent("symbolViewSaving",p)),p.preventDefault)return!1;p={path:p.url,content:G(this.content)},this.editor.request("upload",p,function(p){!0===p&&P.editor.saveImage(P.dm.a("snapshotURL")||P.graphView,E.substr(0,E.length-5)+".png",function(){P.dirty=!1}),S&&S(),P.editor.showMessage(l("editor.savedsuccessfully"),"normal",1e3)})},S.prototype.$65$=function(S,P){this.tab.getTag()&&-1===P.indexOf("?")&&(P+="?tag="+encodeURI(this.tab.getTag()));var E={url:P};if("display"===this.type?(E.displayView=this,this.editor.fireEvent("displayViewPreviewing",E)):"symbol"===this.type&&(E.symbolView=this,this.editor.fireEvent("symbolViewPreviewing",E)),E.preventDefault)return!1;P=E.url,window.open(P,P);var p=this.content;p.title=this.tab.getName(),E={path:S,content:G(p)},this.editor.request("upload",E,function(S){})},S.prototype.$4$=function(){return this._interactionState},S.prototype.$5$=function(S,P,E){var p=this,l=this._interactionState;if(l!==S){this._interactionState=S,this.editor.pointsEditingMode=!1;var _=[];if(this.graphView.getInteractors().each(function(P){P.keep?P.disabled="edit"!==S:_.push(P)}),_.forEach(function(S){S.tearDown(),p.graphView.getInteractors().remove(S)}),"edit"!==S){var m=fS(P)?this.$63$(P,E):this.$62$(P,E);m.setUp(),this.graphView.getInteractors().add(m)}this.graphView.invalidateSelection(),this.editor.mainToolbar.iv(),this.fp("interactionState",l,S),this.validateCanvas()}},S.prototype.$62$=function(S,P){var E=new S;return E instanceof ht.Shape?new yE(this.tab,null,function(E,p){var l=new S;return l.setPoints(E),l.setSegments(p),P&&P(l),l}):E instanceof ht.Edge?new DE(this.tab,null,function(S,E){var p=new ht.Edge(S,E);return P&&P(p),p}):E instanceof ht.Node?new oE(this.tab,null,function(E,p){var l=new S;return P&&P(l,E,p),l}):void 0},S.prototype.createComp=function(S){},S.prototype.$63$=function(S,P){var E=nE[S];return"shape"===S?new yE(this.tab,null,function(S,p){var l={type:"shape",background:null,borderColor:rP.config.color_data_border,borderWidth:1};P&&P(l,S,p);var _=new E(l);return _.setPoints(S),_.setSegments(p),_}):new oE(this.tab,null,function(p,_){var m=void 0;return m="arc"===S?{type:S,rect:[p.x,p.y,p.width,p.height],background:rP.config.color_data_background,borderWidth:1,borderColor:rP.config.color_data_border,arcFrom:0,arcTo:4.1888}:"border"===S?{type:S,rect:[p.x,p.y,p.width,p.height],border:1,color:rP.config.color_data_border}:"text"===S?{type:S,rect:[p.x,p.y,p.width,p.height],text:l("editor.text")}:"comp"===S||"image"===S?_?{rect:[p.x+p.width/2,p.y+p.height/2,-1,-1]}:{rect:[p.x,p.y,p.width,p.height]}:"pieChart"===S?{type:"pieChart",values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}:"oneDimensionalColumnChart"===S?{type:"columnChart",series:[{values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}]}:"columnChart"===S?{type:"columnChart",series:[{values:[30,40,60,70,80],color:"#7EB6EA"},{values:[20,40,50,80,90],color:"#434348"}]}:"lineChart"===S?{type:"lineChart",series:[{values:[10,40,30,60,70],color:"#7EB6EA"}]}:{type:S,rect:[p.x,p.y,p.width,p.height],background:rP.config.color_data_background,borderWidth:1,borderColor:rP.config.color_data_border},P&&P(m,p,_),new E(m)})},S.prototype.init=function(){this.clear()},S.prototype.resetGrid=function(){},S.prototype.clear=function(){this.dm.setName(void 0),this.dm.setBackground(void 0),this.dm.setHierarchicalRendering(!1),this.dm.setLayers(void 0),this.dm.clear(),this.dm.setAttrObject(void 0),this.resetGrid()},S.prototype.onClosed=function(){this.graphView.onClosed()},S.prototype.addData=function(S){var P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l="display"===this.type?"dataCreated":"compCreated",_={data:S};if(_["display"===this.type?"displayView":"symbolView"]=this,E)return void this.editor.fireEvent(l,_);this.dm.beginTransaction(),P||S.getParent()||S.setParent(this.graphView.getCurrentSubGraph()),this.dm.add(S),P||(p||this.dm.sm().ss(S),this.graphView.setFocus()),this.editor.fireEvent(l,_),this.dm.endTransaction()},S.prototype.validateCanvas=function(){var S=this.graphView._topCanvas,P=y(S);P.clearRect(0,0,S.clientWidth,S.clientHeight),this.graphView.getInteractors().each(function(S){S.$0$&&S.$0$(P)}),this.$0$(P),P.restore()},S.prototype.redraw=function(){this._lastWidth=this._lastHeight=null,this.iv()},S.prototype.validateImpl=function(){var S=this._rulerSize,P=this._rulerEnabled,E=this.getWidth(),p=this.getHeight();if(E!==this._lastWidth||p!==this._lastHeight||S!==this._lastRulerSize||P!==this._lastRulerEnabled){if(this._lastWidth=E,this._lastHeight=p,this._lastRulerSize=S,this._lastRulerEnabled=P,P){this._hRuler.parentNode||(this._view.appendChild(this._hRuler),this._view.appendChild(this._vRuler));var l=Math.max(0,E-S),_=Math.max(0,p-S);K(this._hRuler,S,0,l,S),K(this._vRuler,0,S,S,_),K(this.graphView,S,S,l,_),K(this.graphView._topDiv,0,0,l,_),L(this.graphView._topCanvas,l,_),L(this._hRuler,l,S),L(this._vRuler,S,_)}else this._hRuler.parentNode&&(e(this._hRuler),e(this._vRuler)),K(this.graphView,0,0,E,p),K(this.graphView._topDiv,0,0,E,p),L(this.graphView._topCanvas,E,p);this.validateCanvas()}this._hRuler.style.background=this._rulerBackground,this._vRuler.style.background=this._rulerBackground,this.drawRuler()},S.prototype.$0$=function(S){var P=this.graphView.getZoom(),E=this.graphView.tx(),p=this.graphView.ty(),l=Math.round(this.dm.a("width")||0)*P,_=Math.round(this.dm.a("height")||0)*P,m=this.graphView.getWidth(),u=this.graphView.getHeight();l>0&&_>0&&m>0&&u>0&&(S.beginPath(),E&&S.rect(0,0,E,u),p&&m-E&&S.rect(E,0,m-E,p),m-E-l&&_&&S.rect(E+l,p,m-E-l,_),m-E&&u-p-_&&S.rect(E,p+_,m-E,u-p-_),S.fillStyle=rP.config.color_mask,S.fill())},S.prototype.drawVerticalText=function(S,P,E){S.save(),S.translate(11,E+11),S.rotate(-Math.PI/2),C(S,P,this._rulerFont,this._rulerColor,11,-11,0,this._rulerSize,"right"),S.restore()},S.prototype.drawRuler=function(){if(this._rulerEnabled){var S,P,E,p,l,_,m=this._rulerFont,u=this._rulerSize,F=this._rulerColor,f=this.graphView,H=f.getUnionNodeRect(f.sm().getSelection()),T=f.getZoom(),X=Math.log(T)/Math.log(10),W=Math.floor(X),h=100/Math.pow(10,W)*T,Q=h/10,i=W>1?40+10*(W-1):40,a=Math.round(f.tx()),s=Math.round(f.ty()),k={x:-a,y:-s,width:f.getWidth(),height:f.getHeight()},Y=Math.floor(k.x/h),x=Math.ceil((k.x+k.width)/h),M=Math.floor(k.y/h),b=Math.ceil((k.y+k.height)/h);for(y(this._hRuler,0,0,1,{x:0,y:0,width:k.width,height:u}).restore(),p=y(this._hRuler,a,0,1),p.lineWidth=1,p.strokeStyle=F,H&&(p.beginPath(),p.rect(H.x*T,0,H.width*T,u),p.fillStyle=rP.config.color_line,p.fill()),p.beginPath(),S=Y;S<=x;S++)l=S*h,_=W>1?(l/T).toFixed(W-1):Math.round(l/T),l=Math.round(l),p.moveTo(l,u),p.lineTo(l,0),C(p,_,m,F,l,0,1,u,"left");for(p.stroke(),p.beginPath(),S=Y;S<=x;S++)for(E=1;E<10;E++)l=S*h+E*Q,_=W>1?(l/T).toFixed(W-1):Math.round(l/T),l=Math.round(l),p.moveTo(l,u),5===E?(p.lineTo(l,u-10),C(p,_,m,F,l,0,1,u,"left")):(p.lineTo(l,u-4),Q>i&&C(p,_,m,F,l,0,1,u,"left"));for(p.stroke(),p.restore(),y(this._vRuler,0,0,1,{x:0,y:0,width:u,height:k.height}).restore(),p=y(this._vRuler,0,s,1),p.lineWidth=1,p.strokeStyle=F,H&&(p.beginPath(),p.rect(0,H.y*T,u,H.height*T),p.fillStyle=rP.config.color_line,p.fill()),p.beginPath(),P=M;P<=b;P++)l=P*h,_=W>1?(l/T).toFixed(W-1):Math.round(l/T),l=Math.round(l),p.moveTo(u,l),p.lineTo(0,l),this.drawVerticalText(p,_,l);for(p.stroke(),p.beginPath(),P=M;P<=b;P++)for(E=1;E<10;E++)l=P*h+E*Q,_=W>1?(l/T).toFixed(W-1):Math.round(l/T),l=Math.round(l),p.moveTo(u,l),5===E?(p.lineTo(u-10,l),this.drawVerticalText(p,_,l)):(p.lineTo(u-4,l),Q>i&&this.drawVerticalText(p,_,l));p.stroke(),p.restore()}},vP(S,[{key:"dm",get:function(){return this.graphView.dm()}},{key:"dirty",get:function(){return this.tab.a("dirty")},set:function(S){ht.Default.loadingRefGraph||this.tab.a("dirty",S)}}]),S}();I(UE,{ms_v:1,ms_fire:1,ms_ac:["rulerEnabled","rulerBackground","rulerFont","rulerColor","rulerSize","guideColor"],_rulerFont:rP.config.smallFont,_rulerBackground:rP.config.color_pane,_rulerColor:rP.config.color_dark,_rulerSize:rP.config.rulerSize,_guideColor:rP.config.color_transparent,_interactionState:void 0}),rP.EditView=UE;var tE=function(S){function P(E,p,l,_){$P(this,P);var m=KP(this,S.call(this,E,p,qE,"display"));return m.displayTree=m.list=new zE(m),m.graphView.getEditInteractor().gridEnabled=m.editor.isGridEnabled(),m.dirty=!1,m.dm.enableHistoryManager(rP.config.maxUndoRedoSteps),m.parse(l,_),l?m.editor.fireEvent("displayViewOpened",{displayView:m,url:l,json:_}):m.editor.fireEvent("displayViewCreated",{displayView:m,json:_}),m}return BP(P,S),P.prototype.init=function(){S.prototype.init.call(this),this.dm.setHierarchicalRendering(!0)},P.prototype.onClosed=function(){S.prototype.onClosed.call(this),this.displayTree.onClosed()},P.prototype.handleDataModelChanged=function(S){"add"!==S.kind||this.isDeserializing||S.data.setLayer(this.editor.currentLayer),this.dirty=!0},P.prototype._updateImpl=function(S,P){var p=this,l=J(S);if(this.clear(),this.isDeserializing=!0,this.dm.deserialize(l),this.isDeserializing=!1,this.dirty=!!P,!P)if(l.contentRect){var _=E(l.contentRect);ht.Default.grow(_,rP.config.fitPadding),this.graphView.getWidth()&&this.graphView.getHeight()?this.graphView.fitRect(_,rP.config.animate):setTimeout(function(){p.graphView.fitRect(_,rP.config.animate)},500)}else this.graphView.fitContent(rP.config.animate,rP.config.fitPadding)},P.prototype.reload=function(){if(this.url){var S={displayView:this,url:this.url};if(this.editor.fireEvent("displayViewReloading",S),S.preventDefault)return!1;this.parse(this.url)}},P.prototype.save=function(S,P){var E=this,p=function(){S&&S(),E.editor.fireEvent("displayViewSaved",{displayView:E,url:E.url}),E.editor.selectFileNode(E.url)};if(P)this._saveAs(p,P);else if(this.url)this._saveImpl(p);else{var _=this.editor.displays.currentDir,m=l("editor.inputnewdisplayname");this._saveNew(S,p,m,_)}},P.prototype.clear=function(){S.prototype.clear.call(this),this.dm.a("connectActionType",rP.config.displayConnectActionType),this.dm.a("rotateAsClock",rP.config.rotateAsClock)},P.prototype.resetGrid=function(){this.dm.a("gridBlockSize",rP.config.displayGridBlockSize),this.dm.a("gridThickLinesEvery",rP.config.displayGridThickLinesEvery),this.dm.a("gridThickColor",rP.config.displayGridThickColor),this.dm.a("gridLightColor",rP.config.displayGridLightColor),this.dm.a("gridAngle",rP.config.displayGridAngle),this.dm.a("gridRotation",rP.config.displayGridRotation),this.dm.a("gridZoomThreshold",rP.config.displayGridZoomThreshold)},P.prototype.preview=function(){this.$65$("previews/display.json",this.dm.a("previewURL")||rP.config.displayPreviewURL)},vP(P,[{key:"content",get:function(){var S=this.dm,P=S.toJSON();S.a("connectActionType")===rP.config.displayConnectActionType&&delete P.connectActionType,S.a("rotateAsClock")===rP.config.rotateAsClock&&delete P.rotateAsClock,S.a("gridBlockSize")===rP.config.displayGridBlockSize&&delete P.a.gridBlockSize,S.a("gridThickLinesEvery")===rP.config.displayGridThickLinesEvery&&delete P.a.gridThickLinesEvery,S.a("gridThickColor")===rP.config.displayGridThickColor&&delete P.a.gridThickColor,S.a("gridLightColor")===rP.config.displayGridLightColor&&delete P.a.gridLightColor,S.a("gridAngle")===rP.config.displayGridAngle&&delete P.a.gridAngle,S.a("gridRotation")===rP.config.displayGridRotation&&delete P.a.gridRotation,S.a("gridZoomThreshold")===rP.config.displayGridZoomThreshold&&delete P.a.gridZoomThreshold,S.a("xAlignmentGuides")&&!S.a("xAlignmentGuides").length&&delete P.a.xAlignmentGuides,S.a("yAlignmentGuides")&&!S.a("yAlignmentGuides").length&&delete P.a.yAlignmentGuides;var E=this.graphView.getContentRect();return S.a("width")>0&&S.a("height")>0&&(P.contentRect={x:0,y:0,width:S.a("width"),height:S.a("height")}),S.size()&&E&&E.width&&E.height&&(P.contentRect=E),P}}]),P}(UE),wE=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P.prototype.setDataModel=function(S){var P=this,E=P._dataModel,p=P._selectionModel;E!==S&&(E&&(E.umm(P.handleDataModelChange,P),E.umd(P.handleDataPropertyChange,P),E.removeIndexChangeListener(P.handleIndexChange,P),p||E.sm().ums(P.handleSelectionChange,P)),P._dataModel=S,S.mm(P.handleDataModelChange,P),S.md(P.handleDataPropertyChange,P),S.addIndexChangeListener(P.handleIndexChange,P),p?p._setDataModel(S):S.sm().ms(P.handleSelectionChange,P),P.fp("dataModel",E,S))},P.prototype.handleIndexChange=function(S){this.ivm()},P.prototype.handleDataPropertyChange=function(S){this.invalidateData(S.data)},P.prototype.validateModel=function(){var S=this;S._rows.clear(),S._rowMap={};var P=S._rows=S._dataModel.toDatas(S.isVisible,S),E=0,p=S.getCurrentSortFunc(),l=P.size();for(p&&P.sort(p);E<l;E++)S._rowMap[P.get(E)._id]=E},P}(QE),Sp=function(S){function P(E,p){$P(this,P);var l=KP(this,S.call(this,p));return l.editor=E,l.editable=!0,l.addTopPainter(l.$1$.bind(l)),l}return BP(P,S),P.prototype.isDroppable=function(S,P){return!1},P.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},P.prototype._endDrag=function(S,P){},P.prototype._endCrossDrag=function(S,P){},P.prototype.$1$=function(S){S.texureImage2D=!0;var P=void 0;if(this._dragInfo&&this._dragInfo.inView?P=this._dragInfo:this._crossDragInfo&&(P=this._crossDragInfo),P){var E=this.getWidth(),p=(this.getRowHeight(),P.type,rP.config.color_select_dark);if(P.refData){var l=P.y;S.beginPath(),S.arc(4,l,3,0,2*Math.PI,!0),S.moveTo(7,l),S.lineTo(E,l),S.lineWidth=2,S.strokeStyle=p,S.stroke()}else{var _=this.getViewRect();D(S,p,_.x,_.y,_.width,_.height,2)}}},P.prototype._dragging=function(S,P){var E=this.getRowHeight(),p=this.lp(S),l=p.y/E,_=Math.floor(l);_>this.getRowSize()-1?(P.refData=null,P.type=null,P.parent=null):(P.refData=this.getRowDatas().get(_),p.y-_*E<.5*E?(P.type="up",P.y=_*E):(P.type="down",P.y=(_+1)*E)),this.autoScroll(S),this.redraw()},P.prototype.$2$=function(){var S="";if(this.draggingData&&(S=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var P=this.sm().size();S+=P>1?" (+"+P+") ":""}return S},P.prototype.handleDragAndDrop=function(S,P){if("prepare"===P)return void this._clearDragInfo();"begin"===P&&(this._dragInfo={tip:this.$2$(),view:this});var E=this._dragInfo;if(E){var p=this.editor.dnd;if("begin"===P||"between"===P){return this.getView().contains(b(S))?(E.inView=!0,this._dragging(S,E),p.clearDropView(S,E)):(E.inView&&this.redraw(),E.inView=!1,p.crossDrag(S,E)),void p.showTip(E.tip,S)}return"end"===P?(E.inView?this._endDrag(S,E):p.crossDrop(S,E),void this._clearDragInfo()):"cancel"===P?(E.inView||p.crossCancel(S,E),void this._clearDragInfo()):void 0}},P.prototype.handleCrossDrag=function(S,P,E){return"exit"===P||"cancel"===P?(this._crossDragInfo=null,void this.redraw()):"enter"===P||"over"===P?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(S,this._crossDragInfo)):"drop"===P?(this._endCrossDrag(S,E),this._crossDragInfo=null,void this.redraw()):void 0},P.prototype.isEditable=function(S){return!1},P.prototype.rename=function(S,P){S.setName(P)},P.prototype.handleDataDoubleSelect=function(S,P){if(this.isEditable(P)){var E=this.getIcon(P)?this.getIndent():0;this.lp(S).x>E&&this.beginEditing(P)}},P.prototype.beginEditing=function(S){var P=this;this.cancelEditing(),this.makeVisible(S),this.validate();var E=this.getIcon(S)?this.getIndent():0,p=this.ty()+this.getRowIndex(S)*this.getRowHeight(),l=Math.max(1,this.getWidth()-E),_=this.getRowHeight();this._currentEditor=new ht.widget.TextField,this._currentEditor.data=S;var m=this._currentEditor.getElement(),u=this.getLabel(S);m.value=null==u?"":u,m.onblur=function(S){P.endEditing()},m.onkeydown=function(S){i(S)?P.endEditing():a(S)&&P.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),K(this._currentEditor,E,p,l,_),this._currentEditor.setFocus(),ht.Default.callLater(m.select,m)},P.prototype.endEditing=function(){var S=this._currentEditor;S&&(this.rename(S.data,S.getValue()),delete this._currentEditor,e(S.getView()),this.redraw())},P.prototype.cancelEditing=function(){var S=this._currentEditor;S&&(delete this._currentEditor,e(S.getView()),this.redraw())},P}(wE);rP.DNDIndexList=Sp;var Pp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this,E.editor,E.dm));return p.graphView=E.graphView,p.nodeIcon=KS(p),p.initMenu(),E.dm.addDataPropertyChangeListener(function(S){S.data.editorIcon=null}),p}return BP(P,S),P.prototype.handleDelete=function(){this.removeSelection()},P.prototype.onDataDoubleClicked=function(S,P){P.altKey?this.graphView.fitData(S,!0,rP.config.fitPadding):this.graphView.makeCenter(S,!0)},P.prototype.onPropertyChanged=function(P){"filter"===P.property&&this.ivm(),S.prototype.onPropertyChanged.call(this,P)},P.prototype.handleDataPropertyChange=function(P){!this._filter||"displayName"!==P.property&&"s:text"!==P.property&&"s:type"!==P.property&&"s:image"!==P.property?S.prototype.handleDataPropertyChange.call(this,P):this.ivm()},P.prototype.isVisible=function(S){if(!this._filter)return!0;var P=this.getLabel(S);return null!=P&&(P=(P+"").toLowerCase(),P.indexOf(this._filter)>=0)},P.prototype.validate=function(){this.graphView.validate(),S.prototype.validate.call(this)},P.prototype.getIcon=function(S){return S instanceof TE?"editor.restore.state":S instanceof ht.Text?S.getIcon():S instanceof ht.Shape?(S.editorIcon||(S.editorIcon=eS(S)),S.editorIcon):S instanceof ht.Node?this.nodeIcon:null},P.prototype.isDroppable=function(S,P){return!1},P.prototype._endCrossDrag=function(S,P){},P.prototype._endDrag=function(S,P){var E=this;this.editor.beginTransaction();var p=P.type,l=P.refData;if(this.isSelected(this.draggingData)){var _=this.getRowOrderSelection();"down"===p&&_.reverse(),_.each(function(S){E._dropData(S,p,l)})}else this._dropData(this.draggingData,p,l),this.sm().ss(this.draggingData);this.editor.endTransaction()},P.prototype._dropData=function(S,P,E){if(E){var p=this.dm().getDatas(),l=p.indexOf(E);"down"===P&&l++,p.indexOf(S)<l&&l--,this.dm().moveToIndex(S,l)}else this.dm().bringToFront(S)},P.prototype.isEditable=function(S){return!0},P.prototype.rename=function(S,P){S.setDisplayName(P)},P.prototype.initMenu=function(){var S=this;this.menu=new WE;var P=[{id:"copy",label:l("editor.copy"),action:function(){S.editor.copy()},visible:function(){return!!S.editor.ld}},{id:"paste",label:l("editor.paste"),action:function(){S.editor.paste()},visible:function(){return S.editor.hasCopyInfo()}},{id:"delete",label:l("editor.delete"),action:function(){S.editor.delete()},visible:function(){return!!S.editor.ld}},"separator",{id:"bringToFront",label:l("editor.bringtofront"),action:function(){S.editor.bringToFront()},visible:function(){return!!S.editor.ld}},{id:"bringForward",label:l("editor.bringforward"),action:function(){S.editor.bringForward()},visible:function(){return!!S.editor.ld}},{id:"sendBackward",label:l("editor.sendbackward"),action:function(){S.editor.sendBackward()},visible:function(){return!!S.editor.ld}},{id:"sendToBack",label:l("editor.sendtoback"),action:function(){S.editor.sendToBack()},visible:function(){return!!S.editor.ld}}];this.menu.setItems(P),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},P.prototype.onClosed=function(){_(this.editor.menus,this.menu)},P}(Sp);I(Pp,{ms_ac:["filter"]});var Ep=function(S){function P(E){return $P(this,P),KP(this,S.call(this,E))}return BP(P,S),P.prototype.isDroppable=function(S,P){return!!P.view.isDroppableToSymbolView},P.prototype.initMenuItems=function(S){this.$57$(S),this.$56$(S)},P}(rE),pp=function(S){function P(E,p,l){$P(this,P);var _=KP(this,S.call(this));return _.setIcon("editor.func"),_.setImage("editor.func"),_.parse(E,p,l),_}return BP(P,S),P.prototype.toLabel=function(){return this.getDisplayName()||l("editor.comptype.func")},P.prototype.getClass=function(){return P},P.prototype.parse=function(S,P,E){S&&(this.a("type",S.type),MS(this,S,P,E))},P.prototype.toJSON=function(){var S={};return S.type=this.a("type"),bS(this,S),S},vP(P,[{key:"compType",get:function(){return"function"}}]),P}(ht.Node),lp={rect:mE,circle:mE,oval:mE,roundRect:mE,star:mE,triangle:mE,hexagon:mE,pentagon:mE,diamond:mE,rightTriangle:mE,parallelogram:mE,trapezoid:mE,polygon:mE,arc:mE,image:FE,shape:uE,text:fE,border:dE,pieChart:AE,columnChart:NE,percentageColumnChart:NE,stackedColumnChart:NE,lineChart:ZE,clip:HE,restore:TE,endClip:TE};rP.toDatas=function(S,P){var E=[];return S.forEach(function(S){var p=aP(S);if(p){var l=QP(p),_=iP(l,P);_&&E.push(_)}}),E};var _p=function(S){function P(E,p,l,_){$P(this,P);var m=KP(this,S.call(this,E,p,Ep,"symbol"));m.graphView.vectorDataBindingDisabled=!0,m.graphView.getLabel=function(){return null},m.graphView.setVisibleFunc(function(S){return!(S instanceof TE)}),m.list=m.symbolList=new Pp(m),m.dm.a({name:void 0,comps:[],width:100,height:100,boundExtend:0,fitSize:!1,scrollable:!1,interactive:!1,disableSelectedBorder:!1,pixelPerfect:!0,clip:!1,visible:!0,color:void 0,blendMode:"multiply",opacity:1});var u=rP.config.customProperties.symbol;return u&&u.length&&u.forEach(function(S){m.dm.a(S.property,S.defaultValue)}),m.graphView.getEditInteractor().gridEnabled=m.editor.isGridEnabled(),m.dm.addIndexChangeListener(function(){m.dirty=!0}),m.dirty=!1,m.dm.enableHistoryManager(rP.config.maxUndoRedoSteps),m.parse(l,_),l?m.editor.fireEvent("symbolViewOpened",{symbolView:m,url:l,json:_}):m.editor.fireEvent("symbolViewCreated",{symbolView:m,json:_}),m}return BP(P,S),P.prototype.clear=function(){S.prototype.clear.call(this),this.dm.a("connectActionType",rP.config.symbolConnectActionType),this.dm.setAutoAdjustIndex(!1)},P.prototype.onClosed=function(){S.prototype.onClosed.call(this),this.list.onClosed()},P.prototype._updateImpl=function(S,P){var E=this,p=this.dm,l=J(S);this.clear(),p.setBackground(l.background),p.a("previewURL",l.previewURL),p.a("snapshotURL",l.snapshotURL),p.dataBindings=l.dataBindings,null!=l.gridBlockSize&&this.dm.a("gridBlockSize",l.gridBlockSize),null!=l.gridThickLinesEvery&&this.dm.a("gridThickLinesEvery",l.gridThickLinesEvery),null!=l.gridThickColor&&this.dm.a("gridThickColor",l.gridThickColor),null!=l.gridLightColor&&this.dm.a("gridLightColor",l.gridLightColor),null!=l.gridAngle&&this.dm.a("gridAngle",l.gridAngle),null!=l.gridRotation&&this.dm.a("gridRotation",l.gridRotation),null!=l.gridZoomThreshold&&this.dm.a("gridZoomThreshold",l.gridZoomThreshold),l.hasOwnProperty("connectActionType")&&this.dm.a("connectActionType",l.connectActionType),l.hasOwnProperty("rotateAsClock")&&this.dm.a("rotateAsClock",l.rotateAsClock),qP.forEach(function(S){p.a(S,l[S])}),p.a({name:l.name,renderHTML:l.renderHTML,comps:JS(l.comps,[]),width:JS(l.width,100),height:JS(l.height,100),boundExtend:JS(l.boundExtend,0),fitSize:JS(l.fitSize,!1),scrollable:JS(l.scrollable,!1),interactive:JS(l.interactive,!1),disableSelectedBorder:JS(l.disableSelectedBorder,!1),pixelPerfect:JS(l.pixelPerfect,!0),clip:JS(l.clip,!1),visible:JS(l.visible,!0),color:JS(l.color,void 0),blendMode:JS(l.blendMode,"multiply"),opacity:JS(l.opacity,1),comps_func:$S(l.comps),width_func:$S(l.width),height_func:$S(l.height),fitSize_func:$S(l.fitSize),scrollable_func:$S(l.scrollable),interactive_func:$S(l.interactive),disableSelectedBorder_func:$S(l.disableSelectedBorder),pixelPerfect_func:$S(l.pixelPerfect),visible_func:$S(l.visible),color_func:$S(l.color),blendMode_func:$S(l.blendMode),opacity_func:$S(l.opacity)});var _=rP.config.customProperties.symbol;_&&_.length&&_.forEach(function(S){p.a(S.property,JS(l[S.property],S.defaultValue))}),p.a("comps").forEach(function(S){aP(S,E)}),this.dirty=!!P,P||this.graphView.fitContent(rP.config.animate,rP.config.fitPadding)},P.prototype.reload=function(){if(this.url){var S={symbolView:this,url:this.url};if(this.editor.fireEvent("symbolViewReloading",S),S.preventDefault)return!1;this.parse(this.url)}},P.prototype.save=function(S,P){var E=this,p=function(){S&&S(),E.editor.fireEvent("symbolViewSaved",{symbolView:E,url:E.url}),E.editor.selectFileNode(E.url)};if(P)this._saveAs(p,P);else if(this.url)this._saveImpl(p);else{var _=this.editor.symbols.currentDir,m=l("editor.inputnewsymbolname");this._saveNew(S,p,m,_)}},P.prototype.addValue=function(S,P,E){var p=this.dm.a(P);xS(S,P,this.dm.a(P+"_func"),p,E)},P.prototype.resetGrid=function(){this.dm.a("gridBlockSize",rP.config.symbolGridBlockSize),this.dm.a("gridThickLinesEvery",rP.config.symbolGridThickLinesEvery),this.dm.a("gridThickColor",rP.config.symbolGridThickColor),this.dm.a("gridLightColor",rP.config.symbolGridLightColor),this.dm.a("gridAngle",rP.config.symbolGridAngle),this.dm.a("gridRotation",rP.config.symbolGridRotation),this.dm.a("gridZoomThreshold",rP.config.symbolGridZoomThreshold)},P.prototype.preview=function(){this.$65$("previews/symbol.json",this.dm.a("previewURL")||rP.config.symbolPreviewURL)},vP(P,[{key:"content",get:function(){var S=this,P=this.graphView.getEditInteractor(),E=(P.gridGuide,this.dm),p={};E.getBackground()&&(p.background=E.getBackground()),E.dataBindings&&(p.dataBindings=E.dataBindings),E.a("previewURL")&&(p.previewURL=E.a("previewURL")),E.a("snapshotURL")&&(p.snapshotURL=E.a("snapshotURL")),E.a("connectActionType")!==rP.config.symbolConnectActionType&&(p.connectActionType=E.a("connectActionType")),E.a("rotateAsClock")!==rP.config.rotateAsClock&&(p.rotateAsClock=E.a("rotateAsClock")),E.a("gridBlockSize")!==rP.config.symbolGridBlockSize&&(p.gridBlockSize=E.a("gridBlockSize")),E.a("gridThickLinesEvery")!==rP.config.symbolGridThickLinesEvery&&(p.gridThickLinesEvery=E.a("gridThickLinesEvery")),E.a("gridThickColor")!==rP.config.symbolGridThickColor&&(p.gridThickColor=E.a("gridThickColor")),E.a("gridLightColor")!==rP.config.symbolGridLightColor&&(p.gridLightColor=E.a("gridLightColor")),E.a("gridAngle")!==rP.config.symbolGridAngle&&(p.gridAngle=E.a("gridAngle")),E.a("gridRotation")!==rP.config.symbolGridRotation&&(p.gridRotation=E.a("gridRotation")),E.a("gridZoomThreshold")!==rP.config.symbolGridZoomThreshold&&(p.gridZoomThreshold=E.a("gridZoomThreshold")),E.a("xAlignmentGuides")&&E.a("xAlignmentGuides").length&&(p.xAlignmentGuides=E.a("xAlignmentGuides")),E.a("yAlignmentGuides")&&E.a("yAlignmentGuides").length&&(p.yAlignmentGuides=E.a("yAlignmentGuides")),qP.forEach(function(S){E.a(S)&&(p[S]=E.a(S))}),E.a("renderHTML")&&(p.renderHTML=E.a("renderHTML")),this.addValue(p,"width"),this.addValue(p,"height"),this.addValue(p,"boundExtend",0),this.addValue(p,"fitSize",!1),this.addValue(p,"scrollable",!1),this.addValue(p,"interactive",!1),this.addValue(p,"disableSelectedBorder",!1),this.addValue(p,"pixelPerfect",!0),this.addValue(p,"name"),this.addValue(p,"clip",!1),this.addValue(p,"visible",!0),this.addValue(p,"color"),this.addValue(p,"blendMode","multiply"),this.addValue(p,"opacity",1);var l=rP.config.customProperties.symbol;l&&l.length&&l.forEach(function(P){S.addValue(p,P.property,P.defaultValue)});var _=[];return E.a("comps_func")?p.comps={values:_,func:E.a("comps_func")}:p.comps=_,E.each(function(S){_.push(S.toJSON())}),p}}]),P}(UE),mp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.getTabModel().sm().ms(function(){p.editor.$6$(p.currentTab)}),p.menu=new WE([{id:"closeTab",label:l("editor.closetab"),action:function(){p.closeTab()}},{id:"closeOtherTabs",label:l("editor.closeothertabs"),action:function(){p.closeOtherTabs()}},{id:"closeTabsToTheRight",label:l("editor.closetabstotheright"),action:function(){p.closeTabsToTheRight()}}]),p.menu.beforeShow=function(S){p._rightClickTab=p.getTabAt(S)},p.menu.addTo(p.getTitleDiv()),p.editor.menus.push(p.menu),p}return BP(P,S),P.prototype.drawCloseIcon=function(P,E,p,l){P.a("dirty")?(E.fillStyle=p,E.beginPath(),E.arc(l.x+l.width/2,l.y+l.height/2,3,0,2*Math.PI,!0),E.fill()):S.prototype.drawCloseIcon.call(this,P,E,p,l)},P.prototype.open=function(S){if(S){var P=S.fileType,E=P===CP,p=P===ZP;if(E||p){var l=S.url,_=this.getTabModel().getDataByTag(l);_||(_=new ht.Tab,_.setTag(l),_.setIcon(E?"editor.display":"editor.symbol"),_.setClosable(!0),_.setName(v(S.getName())),E?new tE(this.editor,_,l):new _p(this.editor,_,l),this.editor.addTab(_)),this.getTabModel().sm().ss(_)}}},P.prototype.newDisplayView=function(S){var P=new ht.Tab;P.setClosable(!0),P.setIcon("editor.display"),P.setName(S||l("editor.untitled"));var E=new tE(this.editor,P);return this.editor.addTab(P,!0),E},P.prototype.newSymbolView=function(S){var P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],E=new ht.Tab;E.setClosable(!0),E.setIcon("editor.symbol"),E.setName(S||l("editor.untitled"));var p=new _p(this.editor,E);return this.editor.addTab(E,!0),P&&this.editor.zoomToFit(),p},P.prototype.$101$=function(){this.getTabModel().each(function(S){S.getView().graphView.invalidateAll()})},P.prototype.reload=function(){this.currentTab&&this.currentTab.getView().reload()},P.prototype.save=function(S,P){this.currentTab&&this.currentTab.getView().save(S,P)},P.prototype.preview=function(){this.currentTab&&this.currentTab.getView().preview()},P.prototype.selectTab=function(S){S&&this.getTabModel().sm().ss(S)},P.prototype.onTabClosing=function(S,P){return this.closeTab(S),!1},P.prototype.closeTab=function(S){(S=S||this._rightClickTab||this.currentTab)&&this.closeTabs([S])},P.prototype.closeOtherTabs=function(){var S=this._rightClickTab||this.currentTab;this.closeTabs(this.tabs.filter(function(P){return P!==S}))},P.prototype.closeTabsToTheRight=function(){var S=this._rightClickTab||this.currentTab;if(S){var P=this.tabs.indexOf(S);this.closeTabs(this.tabs.slice(P+1))}},P.prototype.closeTabs=function(S,P){var E=this,p=void 0,l=function(_){if("cancel"!==_&&S.length){var m=S.shift(0);void 0===p&&(p=E.tabs.indexOf(m)-1),E.$66$(m,l)}else{P&&P();var u=E.tabs.length;!E.currentTab&&u&&((void 0===p||p<0)&&(p=0),p>u-1&&(p=u-1),E.selectTab(E.tabs[p]))}};l(),this._rightClickTab=null},P.prototype.removeTab=function(S){S.getView().onClosed(),this.getTabModel().remove(S),this.editor.fireEvent("tabClosed",{tab:S})},P.prototype.$66$=function(S,P){var E=this,p=S.getView();if(p.dirty){var _=[{label:l("editor.notsave"),action:function(){m.hide(),E.removeTab(S),P&&P("notSave")}},{label:l("editor.save"),action:function(){p.save(function(){m.hide(),E.removeTab(S),P&&P("save")})}},{label:l("editor.cancel"),action:function(){m.hide(),P&&P("cancel")}}],m=new LP({title:S.getName(),contentPadding:20,width:260,draggable:!0,content:"<p>"+l("editor.savechange")+"</p>",buttons:_});m.$49$=_[2].action,m.$48$=_[1].action,m.show()}else this.removeTab(S),P&&P()},vP(P,[{key:"currentTab",get:function(){return this.getTabModel().sm().ld()}},{key:"tabs",get:function(){return this.getTabModel().getRoots().toArray()}}]),P}(kE),up=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p.buttons={};var l=[];l.push(p.createItem("distributeHorizontal")),l.push(p.createItem("distributeVertical")),l.push(p.createItem("alignLeft")),l.push(p.createItem("alignHorizontal")),l.push(p.createItem("alignRight")),l.push(p.createItem("alignTop")),l.push(p.createItem("alignVertical")),l.push(p.createItem("alignBottom")),p.addSearchItem(l);var _=22,u=[_,_,_,_,_,_,_,_,.1];return m(rP.config.compactFilter)||(p.addCompactItem(l),u.push(_)),p.addRow(l,u),p.updateItems(),p}return BP(P,S),P.prototype.createItem=function(S){var P=this,E="editor.align."+S.toLocaleLowerCase();return this.buttons[S]=NS(null,l(E),E,function(){P[S]()})},P.prototype.updateItems=function(){var S=this.buttons;if(this.dataModel){var P=[];this.dataModel.sm().each(function(S){
S instanceof ht.Node&&P.push(S)}),P.length>2?(S.distributeHorizontal.setDisabled(!1),S.distributeVertical.setDisabled(!1),S.alignLeft.setDisabled(!1),S.alignHorizontal.setDisabled(!1),S.alignRight.setDisabled(!1),S.alignTop.setDisabled(!1),S.alignVertical.setDisabled(!1),S.alignBottom.setDisabled(!1)):P.length>1?(S.distributeHorizontal.setDisabled(!0),S.distributeVertical.setDisabled(!0),S.alignLeft.setDisabled(!1),S.alignHorizontal.setDisabled(!1),S.alignRight.setDisabled(!1),S.alignTop.setDisabled(!1),S.alignVertical.setDisabled(!1),S.alignBottom.setDisabled(!1)):(S.distributeHorizontal.setDisabled(!0),S.distributeVertical.setDisabled(!0),S.alignLeft.setDisabled(!0),S.alignHorizontal.setDisabled(!0),S.alignRight.setDisabled(!0),S.alignTop.setDisabled(!0),S.alignVertical.setDisabled(!0),S.alignBottom.setDisabled(!0))}else S.distributeHorizontal.setDisabled(!0),S.distributeVertical.setDisabled(!0),S.alignLeft.setDisabled(!0),S.alignHorizontal.setDisabled(!0),S.alignRight.setDisabled(!0),S.alignTop.setDisabled(!0),S.alignVertical.setDisabled(!0),S.alignBottom.setDisabled(!0)},P.prototype.$6$=function(S){this.dataModel&&this.dataModel.sm().ums(this.updateItems,this),S?(this.dataModel=S.getView().dm,this.dataModel.sm().ms(this.updateItems,this)):this.dataModel=null,this.updateItems()},P.prototype.getUnionRect=function(S){return this.editor.gv?this.editor.gv.getUnionNodeRect(S):null},P.prototype.isSelected=function(S){return this.dataModel&&this.dataModel.sm().contains(S)},P.prototype.hasSelectedGroupParent=function(S){return S instanceof ht.Group&&(!!this.isSelected(S)||this.hasSelectedGroupParent(S.getParent()))},P.prototype.hasSelectedHost=function(S){var P=this,E=function(p){return p!==S&&(p instanceof ht.Node&&(!!P.isSelected(p)||E(p.getHost())))};return E(S.getHost())},P.prototype.distributeHorizontal=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);if(S&&E){P.sort(function(P,E){return S.getNodeRect(P).x-S.getNodeRect(E).x});var p={},l=0;P.forEach(function(P){var E=S.getNodeRect(P);p[P._id]=E,l+=E.width});var _=(E.width-l)/(P.length-1),m=E.x;P.forEach(function(P){var E=S.getNodeRect(P);P.translate(m-E.x,0),m+=E.width+_})}this.editor.endTransaction()},P.prototype.distributeVertical=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);if(S&&E){P.sort(function(P,E){return S.getNodeRect(P).y-S.getNodeRect(E).y});var p={},l=0;P.forEach(function(P){var E=S.getNodeRect(P);p[P._id]=E,l+=E.height});var _=(E.height-l)/(P.length-1),m=E.y;P.forEach(function(P){var E=S.getNodeRect(P);P.translate(0,m-E.y),m+=E.height+_})}this.editor.endTransaction()},P.prototype.alignLeft=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);S&&E&&P.forEach(function(P){var p=S.getNodeRect(P);P.translate(E.x-p.x,0)}),this.editor.endTransaction()},P.prototype.alignHorizontal=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);S&&E&&P.forEach(function(P){var p=S.getNodeRect(P);P.translate(E.x+E.width/2-p.x-p.width/2,0)}),this.editor.endTransaction()},P.prototype.alignRight=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);S&&E&&P.forEach(function(P){var p=S.getNodeRect(P);P.translate(E.x+E.width-p.x-p.width,0)}),this.editor.endTransaction()},P.prototype.alignTop=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);S&&E&&P.forEach(function(P){var p=S.getNodeRect(P);P.translate(0,E.y-p.y)}),this.editor.endTransaction()},P.prototype.alignVertical=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);S&&E&&P.forEach(function(P){var p=S.getNodeRect(P);P.translate(0,E.y+E.height/2-p.y-p.height/2)}),this.editor.endTransaction()},P.prototype.alignBottom=function(){this.editor.beginTransaction();var S=this.editor.gv,P=this.selection,E=this.getUnionRect(P);S&&E&&P.forEach(function(P){var p=S.getNodeRect(P);P.translate(0,E.y+E.height-p.y-p.height)}),this.editor.endTransaction()},P.prototype.addSearchItem=function(S){var P=this;this.searchField=new ht.widget.TextField;var E=this.searchField.getElement();E.onkeyup=function(S){a(S)&&(E.value=""),P.editor.filterProperties()},S.push(this.searchField)},P.prototype.addCompactItem=function(S){var P=this,E=ZS("editor.filter",function(){return P.editor.inspectorCompact}),p=function(){P.editor.inspectorCompact=!P.editor.inspectorCompact};S.push(NS(null,l("editor.inspectorcompact"),E,p))},vP(P,[{key:"selection",get:function(){var S=this,P=[];return this.dataModel&&this.dataModel.sm().each(function(E){E instanceof ht.Node&&(S.hasSelectedGroupParent(E.getParent())||S.hasSelectedHost(E)||P.push(E))}),P}},{key:"filter",get:function(){return this.searchField.getElement().value}}]),P}(eP);rP.InspectorTool=up;var Fp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.initForm(),p.visible=!1,p.$6$(),p.oopsImageJSON=ht.Default.getImage("editor.oops"),p.oopsImage=ht.Default.toCanvas(p.oopsImageJSON,p.oopsImageJSON.width,p.oopsImageJSON.height,"fill",null,null,null,ht.Default.devicePixelRatio).toDataURL(),p}return BP(P,S),P.prototype.initForm=function(){var S=this;this.addRow([{id:"content",textArea:{}}],[.1],.1),this.addRow([{id:"url",textField:{editable:!1}},{id:"edit",button:{onClicked:function(){S.editing=!S.editing}}},{id:"commit",button:{label:l("editor.commit"),onClicked:function(){S.currentView.update(S.content,!0),S.editing=!1}}}],[.1,50,50]),this.getView().style.background=rP.config.color_pane,this.textArea=this.getViewById("content").getElement(),this.editing=!1},P.prototype.$67$=function(){var S=this;this.visible&&!this.editing&&(this._updateContentLater||(this._updateContentLater=!0,setTimeout(function(){S.updateContent()},100)))},P.prototype.updateContent=function(){this.visible&&!this.editing&&(this._updateContentLater=!1,this.content=this.currentView?G(this.currentView.content):"")},P.prototype.updateUrl=function(){this.v("url",this.tab&&this.tab.getTag()||"")},P.prototype.$6$=function(S){this.editing=!1,this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.$67$,this),this.dataModel.removeDataPropertyChangeListener(this.$67$,this),this.dataModel.removePropertyChangeListener(this.$67$,this)),S?(this.currentView=S.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.$67$,this),this.dataModel.addDataPropertyChangeListener(this.$67$,this),this.dataModel.addPropertyChangeListener(this.$67$,this),this.setDisabled(!1)):(this.currentView=null,this.dataModel=null,this.setDisabled(!0)),this.tab=S,this.updateUrl(),this.$67$()},vP(P,[{key:"editing",get:function(){return this._editing},set:function(S){this._editing!==S&&(this._editing=S,this.getViewById("edit").setLabel(l(S?"editor.cancel":"editor.edit")),this.getViewById("commit").setDisabled(!S),this.getViewById("content").setEditable(S),S||this.$67$())}},{key:"visible",get:function(){return this._visible},set:function(S){this._visible!==S&&(this._visible=S,S?this.updateContent():this.editing||(this.content=""))}},{key:"content",get:function(){return this.v("content")},set:function(S){if(S&&S.length>rP.config.maxStringLength){S="Oops, tooooo long!",this.setDisabled(!0,this.oopsImage);var P=this.oopsImageJSON.width,E=this.oopsImageJSON.height;this.getDisabledDiv().style.backgroundSize=P+"px "+E+"px"}else this.setDisabled(!1);this.v("content",S)}}]),P}(eP),fp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.centerPane=new XE,p.setCenterView(p.centerPane),p.controlPane=new eP,p.controlPane.addRow([{id:"filter",textField:{}}],[.1,ht.Default.isTouchable?32:18]),p.setBottomView(p.controlPane),p.setBottomHeight(ht.Default.widgetRowHeight+8),p.input=p.controlPane.getViewById("filter").getElement(),p.input.onkeyup=function(S){p.list&&(a(S)&&(p.input.value=""),p.list.setFilter(p.input.value))},p}return BP(P,S),P.prototype.$6$=function(S){this.tab=S,this.list=S?S.getView().list:null,this.controlPane.v("filter",this.list?this.list.getFilter()||"":"")},vP(P,[{key:"list",get:function(){return this.centerPane.getCenterView()},set:function(S){this.centerPane.setCenterView(S)}}]),P}(XE),Hp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p._layerNames=[],p.setDisabled(!0),p.tableModel=new ht.DataModel,p.tablePane=new sE(p.tableModel),p.tableView=p.tablePane.getTableView(),p.tableView.setEditable(!0),p.tablePane.getView().style.border=rP.config.color_line+" solid 1px",p.tablePane.addColumns([p.$74$("name",l("editor.name"),100),p.$74$("visible",l("editor.visible"),50),p.$74$("selectable",l("editor.selectable"),50),p.$74$("movable",l("editor.movable"),50),p.$74$("editable",l("editor.editable"),50)]),p.addRow([p.tablePane],[.1],.1),p.addRow([{button:{icon:"editor.add",toolTip:l("editor.add"),onClicked:function(){p.addLayer(ht.Data.prototype._layer,!0,!0,!0,!0),p.updateLayers()}}},{button:{icon:"editor.delete",toolTip:l("editor.delete"),onClicked:function(){p.tableView.sm().size()&&(p.tableView.removeSelection(),p.updateLayers())}}},null,{button:{icon:"editor.top",toolTip:l("editor.bringtofront"),onClicked:function(){p.tableView.sm().size()&&(p.tableModel.moveSelectionToTop(),p.updateLayers())}}},{button:{icon:"editor.up",toolTip:l("editor.bringforward"),onClicked:function(){p.tableView.sm().size()&&(p.tableModel.moveSelectionUp(),p.updateLayers())}}},{button:{icon:"editor.down",toolTip:l("editor.sendbackward"),onClicked:function(){p.tableView.sm().size()&&(p.tableModel.moveSelectionDown(),p.updateLayers())}}},{button:{icon:"editor.bottom",toolTip:l("editor.sendtoback"),onClicked:function(){p.tableView.sm().size()&&(p.tableModel.moveSelectionToBottom(),p.updateLayers())}}}],[20,20,.1,20,20,20,20]),p}return BP(P,S),P.prototype.addLayer=function(S,P,E,p,l){!1!==P&&(P=!0),!1!==E&&(E=!0),!1!==p&&(p=!0),!1!==l&&(l=!0);var _=new ht.Data;_.a({name:S,visible:P,selectable:E,movable:p,editable:l}),this.tableModel.add(_)},P.prototype.$74$=function(S,P,E){var p=this;return{name:S,tag:S,accessType:"attr",width:E,displayName:P,align:"center",editable:!0,setValue:function(P,E,l){l!==P.a(S)&&(P.a(S,l),p.updateLayers())}}},P.prototype.$6$=function(S){this.dataModel&&this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this);var P=this.editor.displayView;P?(this.dataModel=P.dm,this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.setDisabled(!1)):(this.dataModel=null,this.setDisabled(!0)),this.updateTable()},P.prototype.handleDataModelPropertyChange=function(S){var P=this;if("layers"===S.property){this.updateTable(),this._layerNames=[];var E=this.dataModel.getLayers();E&&E.forEach(function(S){P._layerNames.push(HS(S)?S.name:S)}),this.editor.inspector&&this.editor.inspector.$35$()}},P.prototype.updateLayers=function(){if(this.dataModel){var S=this.tableModel.size()?[]:null;S&&this.tableModel.getRoots().forEach(function(P){S.push({name:P.a("name"),visible:P.a("visible"),selectable:P.a("selectable"),movable:P.a("movable"),editable:P.a("editable")})}),this.isSettingLayers=!0,this.dataModel.setLayers(S),this.isSettingLayers=!1}},P.prototype.updateTable=function(){var S=this;if(!this.isSettingLayers&&(this.tableModel.clear(),this.dataModel)){var P=this.dataModel.getLayers();P&&P.forEach(function(P){HS(P)?S.addLayer(P.name,P.visible,P.selectable,P.movable,P.editable):S.addLayer(P,!0,!0,!0,!0)})}},vP(P,[{key:"currentLayer",get:function(){var S=this.tableModel.sm().ld();if(S)return S.a("name");var P=this.tableModel.getRoots();return P.size()?(S=P.get(P.size()-1),S.a("name")):ht.Data.prototype._layer}},{key:"layerNames",get:function(){return this._layerNames}}]),P}(eP),Tp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.editor.menus.push(p),p.setItems([{id:"file",label:l("editor.file"),items:[p.createItem("newDisplayView",l("editor.newdisplayview"),"newDisplayView",rP.config.displaysVisible),p.createItem("newSymbolView",l("editor.newsymbolview"),"newSymbolView",rP.config.symbolsVisible),p.createItem("newComponent",l("editor.newcomponent"),"newComponent",rP.config.componentsVisible)]},{id:"edit",label:l("editor.edit"),items:[p.createItem("undo",l("editor.undo"),"undo"),p.createItem("redo",l("editor.redo"),"redo"),{id:"afterRedo",separator:!0},p.createItem("copy",l("editor.copy"),"copy"),p.createItem("paste",l("editor.paste"),"paste")]}]),p}return BP(P,S),P.prototype.createItem=function(S,P,E){var p=this,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],_={id:S,label:P,visible:l};return E&&(_.action=function(){p.editor[E]()}),_},P}(WE),Xp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.initMenu(),p.$69$(),p.enableToolTip(),p}return BP(P,S),P.prototype.$6$=function(){this.iv()},P.prototype.initMenu=function(){var S=this;this.editor.mainMenu=new Tp(this.editor);var P=function(P){var E=S.editor.mainMenu;E.isShowing()&&!E.getView().contains(P.target)&&E.hide()};window.addEventListener("touchstart",P,!1),window.addEventListener("mousedown",P,!1)},P.prototype.$69$=function(){var S=function(S){return function(P){"node"===S||"subgraph"===S||("edge"===S?P.s({"edge.width":1,"edge.color":rP.config.color_data_border}):"group"===S?P.setExpanded(!0):"arc"===S?P.s({shape:S,"shape.background":rP.config.color_data_background,"shape.border.width":1,"shape.border.color":rP.config.color_data_border,"shape.arc.from":0,"shape.arc.to":4.1888}):"shape"===S?P.s({"shape.background":null,"shape.border.color":rP.config.color_data_border,"shape.border.width":1}):"text"===S?P.s("text",l("editor.text")):P.s({shape:S,"shape.background":rP.config.color_data_background,"shape.border.width":1,"shape.border.color":rP.config.color_data_border}))}},P=[];P.push(this.$68$()),P.push(this.createEditItem()),P.push(this.editor.createDisplayItem("Shape",l("editor.shape"),"editor.display.shape",ht.Shape,S("shape"))),P.push(this.editor.createDisplayItem("Oval",l("editor.oval"),"editor.display.oval",ht.Node,S("oval"))),P.push(this.editor.createDisplayItem("RoundRect",l("editor.roundrect"),"editor.display.roundrect",ht.Node,S("roundRect"))),P.push(this.editor.createDisplayItem("Rect",l("editor.rect"),"editor.display.rect",ht.Node,S("rect"))),P.push(this.editor.createDisplayItem("Polygon",l("editor.polygon"),"editor.display.polygon",ht.Node,S("polygon"))),P.push(this.editor.createDisplayItem("Triangle",l("editor.triangle"),"editor.display.triangle",ht.Node,S("triangle"))),P.push(this.editor.createDisplayItem("Star",l("editor.star"),"editor.display.star",ht.Node,S("star"))),P.push(this.editor.createDisplayItem("Arc",l("editor.arc"),"editor.display.arc",ht.Node,S("arc"))),P.push(this.editor.createDisplayItem("Text",l("editor.text"),"editor.display.text",ht.Text,S("text"))),P.push(this.editor.createDisplayItem("Node",l("editor.node"),"editor.display.node",ht.Node,S("node"))),P.push(this.editor.createDisplayItem("Group",l("editor.group"),"editor.display.group",ht.Group,S("group"))),P.push(this.editor.createDisplayItem("SubGraph",l("editor.subgraph"),"editor.display.subgraph",ht.SubGraph,S("subgraph"))),P.push(this.editor.createDisplayItem("Edge",l("editor.edge"),"editor.display.edge",ht.Edge,S("edge"))),P.push(this.editor.createSymbolItem("shape",l("editor.shape"),"editor.symbol.shape","shape")),P.push(this.editor.createSymbolItem("oval",l("editor.oval"),"editor.symbol.oval","oval")),P.push(this.editor.createSymbolItem("roundRect",l("editor.roundrect"),"editor.symbol.roundrect","roundRect")),P.push(this.editor.createSymbolItem("rect",l("editor.rect"),"editor.symbol.rect","rect")),P.push(this.editor.createSymbolItem("polygon",l("editor.polygon"),"editor.symbol.polygon","polygon")),P.push(this.editor.createSymbolItem("triangle",l("editor.triangle"),"editor.symbol.triangle","triangle")),P.push(this.editor.createSymbolItem("star",l("editor.star"),"editor.symbol.star","star")),P.push(this.editor.createSymbolItem("arc",l("editor.arc"),"editor.symbol.arc","arc")),P.push(this.editor.createSymbolItem("text",l("editor.text"),"editor.symbol.text","text")),P.push(this.editor.createSymbolItem("border",l("editor.border"),"editor.symbol.border","border")),P.push(this.editor.createSymbolItem("piechart",l("editor.piechart"),"editor.symbol.piechart","pieChart")),P.push(this.editor.createSymbolItem("onedimensionalcolumnchart",l("editor.onedimensionalcolumnchart"),"editor.symbol.onedimensionalcolumnchart","oneDimensionalColumnChart")),P.push(this.editor.createSymbolItem("columnchart",l("editor.columnchart"),"editor.symbol.columnchart","columnChart")),P.push(this.editor.createSymbolItem("linechart",l("editor.linechart"),"editor.symbol.linechart","lineChart")),this.setItems(P)},P.prototype.$68$=function(){var S=this,P=dS("menu",l("editor.menu"),"editor.menu");return P.action=function(P,E,p){S.editor.mainMenu.isShowing()||(S.editor.mainMenu.showOnView(S,4,20),p.preventDefault(),p.stopPropagation())},P},P.prototype.createEditItem=function(){var S=this,P=function(){return S.editor.currentView&&"edit"===S.editor.currentView.$4$()},E=dS("edit",l("editor.edit"),"editor.edit",P);return E.visible=function(){return!!S.editor.currentView},E.action=function(){var P=S.editor.currentView;P&&P.$5$("edit")},E},P}(YE),Wp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.$69$(),p.enableToolTip(),p.setStickToRight(!0),p}return BP(P,S),P.prototype.handlePropertyChange=function(S){"zoom"===S.property&&this.$70$()},P.prototype.$70$=function(){this.label.innerHTML=this.graphView?parseInt(100*this.graphView.getZoom())+"%":""},P.prototype.$6$=function(S){this.graphView&&this.graphView.removePropertyChangeListener(this.handlePropertyChange,this),S?(this.graphView=S.getView().graphView,this.graphView.addPropertyChangeListener(this.handlePropertyChange,this)):this.graphView=null,this.iv(),this.$70$()},P.prototype.$69$=function(){var S=this,P=void 0,E=function(){return!!S.graphView},p=[];P=dS("undo",l("editor.undo"),"editor.undo"),P.action=function(){S.editor.undo()},P.visible=E,p.push(P),P=dS("redo",l("editor.redo"),"editor.redo"),P.action=function(){S.editor.redo()},P.visible=E,p.push(P),p.push({separator:!0,visible:E}),P=dS("rulers",l("editor.showrulers"),"editor.rulers",function(){return S.editor.isRulerEnabled()}),P.action=function(){S.editor.toggleRulerEnabled()},P.visible=E,p.push(P),P=dS("grid",l("editor.showgrid"),"editor.grid",function(){return S.editor.isGridEnabled()}),P.action=function(){S.editor.toggleGridEnabled()},P.visible=E,p.push(P),p.push({separator:!0,visible:E}),P=dS("save",l("editor.save"),"editor.save"),P.action=function(){S.editor.save()},P.visible=E,p.push(P),P=dS("preview",l("editor.preview"),"editor.preview"),P.action=function(){S.editor.preview()},P.visible=E,p.push(P),P=dS("reload",l("editor.reload"),"editor.reload"),P.action=function(){S.editor.reload()},P.visible=E,p.push(P),p.push({separator:!0,visible:E}),P=dS("zoomOut",l("editor.zoomout"),"editor.zoomout"),P.action=function(){S.editor.zoomOut()},P.visible=E,p.push(P),p.push(this.createZoomItem(E)),P=dS("zoomIn",l("editor.zoomin"),"editor.zoomin"),P.action=function(){S.editor.zoomIn()},P.visible=E,p.push(P),P=dS("zoomToFit",l("editor.zoomtofit"),"editor.zoomtofit"),P.action=function(){S.editor.zoomToFit()},P.visible=E,p.push(P),p.push({separator:!0,visible:E}),P=dS("toggleLeft",l("editor.toggleleft"),"editor.toggleleft"),P.action=function(){S.editor.toggleLeft()},p.push(P),P=dS("toggleBoth",l("editor.toggleboth"),"editor.toggleboth"),P.action=function(){S.editor.toggleBoth()},p.push(P),P=dS("toggleRight",l("editor.toggleright"),"editor.toggleright"),P.action=function(){S.editor.toggleRight()},p.push(P),this.setItems(p)},P.prototype.createZoomItem=function(S){var P=this,E=this.label=ht.Default.createDiv(!0);E.style.font=this.getLabelFont(),E.style.color=this.getLabelColor(),E.style.cursor="ew-resize",E.style.width="40px",E.style.height=ht.Default.widgetRowHeight+"px",E.style.lineHeight=ht.Default.widgetRowHeight+"px",E.style.whiteSpace="nowrap",E.style.textAlign="center";var p=function(S){S.preventDefault();var E=P.editor.gv;if(E){Y(S)&&P.editor.zoomReset();var p=E.getZoom(),l=M(S).x,_=function(S){S.preventDefault();var P=M(S).x-l;E.setZoom(p*(1+.005*P))};window.addEventListener("mousemove",_,!1),window.addEventListener("touchmove",_,!1);var m=function(S){S.preventDefault(),window.removeEventListener("mousemove",_,!1),window.removeEventListener("touchmove",_,!1),window.removeEventListener("mouseup",m,!1),window.removeEventListener("touchend",m,!1)};window.addEventListener("mouseup",m,!1),window.addEventListener("touchend",m,!1)}};return E.addEventListener("mousedown",p,!1),E.addEventListener("touchstart",p,!1),{id:"zoom",unfocusable:!0,element:E,visible:S}},P}(YE),hp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p._errorMsg=null,p.$72$(),p.$71$(),p.$73$(),p.splitView=new aE(p.inspectorPane,p.graphView,"v",-200),p.mainSplitView=new aE(p.funcPane,p.splitView,"h",-360);var _=[];return _.push({label:l("editor.refresh"),action:function(){p.refresh()}}),_.push({label:l("editor.ok"),action:function(){p.ok()}}),_.push({label:l("editor.cancel"),action:function(){p.hide()}}),p.setConfig({closable:!0,draggable:!0,width:860,height:640,contentPadding:0,resizeMode:"wh",maximizable:!0,content:p.mainSplitView,buttons:_,buttonsAlign:"right"}),p}return BP(P,S),P.prototype.$49$=function(){this.hide()},P.prototype.$48$=function(){this.ok()},P.prototype.$72$=function(){var S=this;ht.Default.setCompType("_editingCompType_",{func:function(){}}),this.node=new ht.Node,this.node.setImage({width:100,height:100,fitSize:!0,comps:[{type:"_editingCompType_"}]}),this.graphView=new hE,this.graphView.dm().add(this.node),this.graphView.sm().ss(this.node),this.graphView.mi(function(P){"doubleClickData"!==P.kind&&"doubleClickBackground"!==P.kind||S.graphView.fitContent(rP.config.animate,rP.config.fitPadding)});var P=this;ht.Default.drawCompType=function(S,E,p,_,m,u){var F="_editingCompType_"===_.type;try{F&&P.beforeDrawCompType(E),S(E,p,_,m,u),F&&P.afterDrawCompType(E)}catch(S){F&&(P.afterDrawCompType(E),P._errorMsg=l("editor.compFunctionError")),console.error(S.stack||S)}}},P.prototype.beforeDrawCompType=function(S){var P=this._restoreFlag;P||(P=this._restoreFlag=S.createLinearGradient(0,0,10,10),P.addColorStop(0,"black"),P.addColorStop(0,"black")),S.fillStyle=P,S.save(),S.fillStyle="#000000"},P.prototype.afterDrawCompType=function(S){if(S.restore(),S.fillStyle!==this._restoreFlag){for(var P=0;S.fillStyle!==this._restoreFlag&&(S.restore(),!(++P>=20)););S.fillStyle="black",this._errorMsg=l("editor.compLossSaveOrRestore")}else this._errorMsg=null},P.prototype.$73$=function(){this.funcPane=new eP,this.funcPane.addRow([{id:"head",element:"function(g, rect, comp, data, view) {"}],[.1]);var S=ht.Default.getClass(rP.config.codeEditorClass);this.funcPane.addRow([{id:"func",element:new S}],[.1],.1),this.funcPane.addRow(["}"],[.1])},P.prototype.$71$=function(){var S=rP.config.indent;this.inspectorPane=new eP,this.inspectorPane.addRow([l("editor.name"),{id:"name",textField:{}}],[S,.1]),this.inspectorPane.addRow([l("editor.path"),{id:"path",textField:{editable:!1}}],[S,.1]),this.inspectorPane.addRow([l("editor.snapshoturl"),{id:"snapshotURL",textField:{}}],[S,.1]),this.inspectorPane.addRow([l("editor.width"),{id:"width",textField:{}},l("editor.height"),{id:"height",textField:{}}],[S,.1,rP.config.indent2,.1]),this.inspectorPane.addLine(),this.createTable()},P.prototype.$74$=function(S,P,E,p){return{name:S,tag:S,accessType:"attr",width:E,displayName:P,align:"center",enum:p,editable:!0}},P.prototype.createTable=function(){var S=this;this.tableModel=new ht.DataModel,this.tablePane=new sE(this.tableModel),this.tableView=this.tablePane.getTableView(),this.tableView.setEditable(!0),this.tablePane.getView().style.border=rP.config.color_line+" solid 1px",this.tablePane.addColumns([this.$74$("property",l("editor.property"),90),this.$74$("valueType",l("editor.valuetype"),80,{values:rP.consts.valueTypes,labels:rP.consts.valueTypeLabels}),this.$74$("defaultValue",l("editor.defaultvalue"),90),this.$74$("name",l("editor.name"),90),this.$74$("description",l("editor.description"),120)]),this.$75$(),this.inspectorPane.addRow([this.tablePane],[.1],.1),this.inspectorPane.addRow([{button:{label:l("editor.add"),onClicked:function(){var P=new ht.Data;P.a({property:"property",valueType:"String"}),S.tableModel.add(P)}}},{button:{label:l("editor.delete"),onClicked:function(){S.tableView.removeSelection()}}},null],[50,50,.1])},P.prototype.$75$=function(){var S=this,P=this.tableView.getColumnModel().getDataByTag("defaultValue");P.getEnumValues=function(S){var P=S?rP.config.valueTypes[S.a("valueType")]:null;return P&&"enum"===P.type?P.values:null},P.getEnumLabels=function(S){var P=S?rP.config.valueTypes[S.a("valueType")]:null;return P&&"enum"===P.type?P.labels:null},P.getEnumIcons=function(S){var P=S?rP.config.valueTypes[S.a("valueType")]:null;return P&&"enum"===P.type?P.icons:null},P.getEnumDropDownWidth=function(S){var P=S?rP.config.valueTypes[S.a("valueType")]:null;return P&&"enum"===P.type?P.dropDownWidth:null},P.getValueType=function(S){var P=S?rP.config.valueTypes[S.a("valueType")]:null;return P?P.type:null},P.isCellEditable=function(P,E,p,_){var m=P?rP.config.valueTypes[P.a("valueType")]:null,u=m?m.type:null;if("function"===u){var F=l("editor.function")+" "+(P.a("property")||"");return S.editor.functionView.open(P.a("defaultValue"),function(S){P.a("defaultValue",S)},F),!1}if("multiline"===u)return S.editor.textView.open(P.a("defaultValue"),function(S){P.a("defaultValue",S)},P.a("property")||"&nbsp;"),!1;if("font"===u)return S.editor.fontView.open(P.a("defaultValue"),function(S){P.a("defaultValue",S)},P.a("property")||"&nbsp;"),!1;if("object"===u||"stringArray"===u||"objectArray"===u||"numberArray"===u||"colorArray"===u){var f=l("editor.object")+" "+(P.a("property")||"");return S.editor.objectView.open(P.a("defaultValue"),function(S){P.a("defaultValue",S)},f),!1}return!0}},P.prototype.open=function(S){var P=this;this.fileNode=S,S?r(S.url,function(E){P.update(S.url,S.path,v(S.getName()),E)}):this.update(void 0,this.editor.components.currentDir,l("editor.untitled"))},P.prototype.update=function(S,P,E,p){if(p){if(p=J(p),this.setTitle(l("editor.editcomponent")),this.node.setWidth(p.width||100),this.node.setHeight(p.height||100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",p.snapshotURL||""),this.inspectorPane.getViewById("name").setEditable(!1),this.inspectorPane.v("name",E||""),this.inspectorPane.v("path",P||""),this.funcPane.v("func",F(p.func)),this.tableModel.clear(),p.properties)for(var _ in p.properties){var m=p.properties[_],u=new ht.Data;u.a({property:_,valueType:m.valueType,defaultValue:m.defaultValue,name:m.name,description:m.description}),this.tableModel.add(u)}this.refresh(),this.show(),this.url=S,this.editor.fireEvent("componentViewOpened",{componentView:this,url:S,json:p})}else this.setTitle(l("editor.newcomponent")),this.node.setWidth(100),this.node.setHeight(100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",""),this.inspectorPane.getViewById("name").setEditable(!0),this.inspectorPane.v("name",E),this.inspectorPane.v("path",P),this.funcPane.v("func",""),this.tableModel.clear(),this.refresh(),this.show(),this.url=S,this.editor.fireEvent("componentViewCreated",{componentView:this})},P.prototype.$76$=function(){return f(this.funcPane.v("head")+"\n"+this.funcPane.v("func").trim()+"\n}")},P.prototype.$77$=function(){var S={};return this.tableModel.each(function(P){S[P.a("property")]={valueType:P.a("valueType"),defaultValue:P.a("defaultValue"),name:P.a("name"),description:P.a("description")}}),S},P.prototype.refresh=function(S){ht.Default.setCompType("_editingCompType_",{func:this.$76$(),properties:this.$77$()}),this.node.setWidth(parseFloat(this.inspectorPane.v("width"))),this.node.setHeight(parseFloat(this.inspectorPane.v("height"))),this.node.iv(),this.graphView.fitContent(rP.config.animate,rP.config.fitPadding);var P=function(E){"validate"===E.kind&&(S&&S(!this._errorMsg),this._errorMsg&&this.editor.showMessage(this._errorMsg,"error"),this.graphView.removeViewListener(P,this))};this.graphView.addViewListener(P,this)},P.prototype.ok=function(){var S=this,P=this.inspectorPane.v("name").trim();if(P){pS(P)&&(P=v(P));var E=this.inspectorPane.v("path"),p=this.content,l={componentView:this,url:this.url||E+"/"+P+".json",json:G(p)};this.editor.fireEvent("componentViewSaving",l),l.preventDefault||(l={path:l.url,content:l.json},this.refresh(function(_){_&&S.editor.request("upload",l,function(_){!0===_&&(S.refresh(),S.graphView.sm().cs(),S.graphView.validate(),S.editor.saveImage(p.snapshotURL||S.graphView,E+"/"+P+".png"),S.hide(),S.editor.selectFileNode(l.path),l={componentView:S,url:l.path,json:l.content},S.editor.fireEvent("componentViewSaved",l))})}))}},vP(P,[{key:"content",get:function(){var S={width:parseFloat(this.inspectorPane.v("width")),height:parseFloat(this.inspectorPane.v("height")),snapshotURL:this.inspectorPane.v("snapshotURL"),func:this.$76$()};return this.tableModel.size()&&(S.properties=this.$77$()),S}}]),P}(LP),Qp=460,ip=230,ap=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p.addRow([l("editor.binding"),{id:"compProperty",textField:{editable:!1}},{element:l("editor.type"),align:"right"},{id:"type",comboBox:{values:["attr","func"],onValueChanged:function(S,P){var E="func"===P,l=E?ht.Default.labelColor:rP.config.color_disabled;p.getViewById("func").setEditable(E),p.getItemById("head").color=l,p.getItemById("end").color=l,p.getViewById("property").setDisabled(E),E&&p.getViewById("property").setValue(""),p.iv()}}},{element:l("editor.property"),align:"right"},{id:"property",textField:{}}],[50,90,40,60,60,.1]),p.addLine(),p.addRow([{id:"head",element:""}],[.1]);var _=ht.Default.getClass(rP.config.codeEditorClass);p.addRow([{id:"func",element:new _}],[.1],.1),p.addRow([{id:"end",element:"}"},{button:{label:l("editor.ok"),onClicked:function(){p.hide(!0)}}},{button:{label:l("editor.cancel"),onClicked:function(){p.hide()}}}],[.1,50,50]),p.setWidth(Qp),p.setHeight(ip),p.getView().className="ht-editor-databinding",p.getView().style.background=rP.config.color_pane,p.getView().style.border=rP.config.color_pane_dark+" solid 1px",p.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,p.getView().style.overflow="visible";var m=function(S){!p.getView().parentNode||p.button.getView().contains(S.target)||p.getViewById("type").getListView().getView().contains(S.target)||p.getView().contains(S.target)||p.hide()};return window.addEventListener("mousedown",m,!1),window.addEventListener("touchstart",m,!1),p}return BP(P,S),P.prototype.toggle=function(S,P,E,p,l,_){this.getView().parentNode?this.hide():this.show(S,P,E,p,l,_)},P.prototype.show=function(S,P,E,p,l,_){if(!this.getView().parentNode){var m=S.getView().getBoundingClientRect(),u=(this.getView().style,z());ht.Default.appendToScreen(this),m.bottom+ip+1>u.height?this.getView().style.top=u.top+m.top-ip-1+"px":this.getView().style.top=u.top+m.bottom+1+"px",this.getView().style.left=u.left+m.right-Qp+"px",this.iv(),this.button=S,this.name=P,this.inspector=p,this.setter=_,this.v("compProperty",E||P);var f=void 0,H=!1;this.inspector.global?"clip"===P?(f=l?l():this.inspector.dataModel.a("clip"),this.v("head","function(g, width, height, data, view, image) {"),H=!0):(f=l?l():this.inspector.dataModel.a(P+"_func"),this.v("head","function(data, view) {")):(f=l?l():this.inspector.data.a(P),this.inspector.data instanceof pp&&"type"===P?(this.v("head","function(g, rect, comp, data, view) {"),
H=!0):this.v("head","function(data, view) {"));fS(f)?(tP.test(f)?(this.v("type","attr"),this.v("property",f.slice(5))):(this.v("type","attr"),this.v("property",f)),this.v("func","")):TS(f)?(this.v("type","func"),this.v("property",""),this.v("func",F(f))):(this.v("type","attr"),this.v("property",""),this.v("func","")),H?(this.v("type","func"),this.v("property",""),this.getViewById("type").setDisabled(!0)):this.getViewById("type").setDisabled(!1)}},P.prototype.hide=function(){var S=this,P=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getView().parentNode&&(e(this.getView()),P)){var E=this.v("type"),p=this.v("property"),l=void 0;if("func"===E){var _=this.v("func").trim();(_||this.inspector.data instanceof pp&&"type"===this.name)&&(l=f(this.v("head")+"\n"+_+"\n}"))}else p&&"attr"===E&&(l="attr@"+p);this.setter?this.setter(l):this.inspector.global?"clip"===this.name?this.inspector.dataModel.a("clip",l):this.inspector.dataModel.a(this.name+"_func",l):this.inspector.setValue(function(P,E){P.a(S.name,E)},l)}},P}(eP),sp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p.createTabView();var _=[];return _.push({label:l("editor.ok"),action:function(){p.ok()}}),_.push({label:l("editor.cancel"),action:function(){p.hide()}}),p.setConfig({title:l("editor.eventhandlers"),closable:!0,draggable:!0,width:500,height:400,contentPadding:6,resizeMode:"wh",maximizable:!0,content:p.tabView,buttons:_,buttonsAlign:"right"}),p}return BP(P,S),P.prototype.$49$=function(){this.hide()},P.prototype.$48$=function(){this.ok()},P.prototype.ok=function(){var S=this;this.target&&qP.forEach(function(P){var E=S[P+"FormPane"],p=E.v("body").trim();if("data"===S.inspectorType){var l=p?f("function(event, data, view) {\n"+p+"\n}"):void 0;S.target.forEach(function(S){S.s(P,l)})}else{var _=p?f("function(event, data, view, point, width, height) {\n"+p+"\n}"):void 0;S.target.forEach(function(S){S.a(P,_)})}}),this.hide()},P.prototype.createTabView=function(){var S=this,P=this.tabView=new kE,E=ht.Default.getClass(rP.config.codeEditorClass);qP.forEach(function(p){var _=S[p+"FormPane"]=new eP;_.addRow([{id:"head",element:""}],[.1]),_.addRow([{id:"body",element:new E}],[.1],.1),_.addRow(["}"],[.1]),S[p+"Tab"]=P.addTab(l("editor.event."+p.toLowerCase()),_)}),P.getTabModel().sm().ss(P.getTabModel().getDatas().get(0))},P.prototype.open=function(S,P){var E=this;S&&S.length&&(this.target=S,this.inspectorType=P,qP.forEach(function(p){var l=E[p+"FormPane"];"data"===P?(l.v("head",p+": function(event, data, view) {"),l.v("body",F(S[S.length-1].s(p)))):(l.v("head",p+": function(event, data, view, point, width, height) {"),l.v("body",F(S[S.length-1].a(p))))}),this.show())},P}(LP),kp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p.formPane=new eP;var _=ht.Default.getClass(rP.config.codeEditorClass);p.formPane.addRow([{id:"function",element:new _}],[.1],.1);var m=[];return m.push({label:l("editor.ok"),action:function(){p.ok()}}),m.push({label:l("editor.cancel"),action:function(){p.hide()}}),p.setConfig({title:l("editor.function"),closable:!0,draggable:!0,width:680,height:500,contentPadding:6,resizeMode:"wh",maximizable:!0,content:p.formPane,buttons:m,buttonsAlign:"right"}),p}return BP(P,S),P.prototype.$49$=function(){this.hide()},P.prototype.$48$=function(){this.ok()},P.prototype.parse=function(S){if(S)return S=S.trim(),S.startsWith("function")||(S="function() {\n"+S+"\n}"),f(S)},P.prototype.ok=function(){this.setValue&&this.setValue(this.parse(this.formPane.v("function"))),this.hide()},P.prototype.open=function(S,P,E){this.setValue=P,this.setTitle(E),this.formPane.v("function",u(S)),this.show()},P}(LP);rP.FunctionView=kp;var Yp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E;var _=ht.Default.getClass(rP.config.codeEditorClass);p.formPane=new eP,p.formPane.addRow([{id:"object",element:new _}],[.1],.1);var m=[];return m.push({label:l("editor.ok"),action:function(){p.ok()}}),m.push({label:l("editor.cancel"),action:function(){p.hide()}}),p.setConfig({title:l("editor.object"),closable:!0,draggable:!0,width:400,height:300,contentPadding:6,resizeMode:"wh",maximizable:!0,content:p.formPane,buttons:m,buttonsAlign:"right"}),p}return BP(P,S),P.prototype.$49$=function(){this.hide()},P.prototype.$48$=function(){this.ok()},P.prototype.ok=function(){if(this.setValue){var S=this.formPane.v("object").trim();S=new Function("return "+S)(),this.setValue(S)}this.hide()},P.prototype.open=function(S,P,E){if(this.setValue=P,this.setTitle(E),S=this.stringify(S,4)){this._funcMap;for(var p in this._funcMap)S=S.replace('"'+p+'"',u(this._funcMap[p]))}this.formPane.v("object",S),this.show()},P.prototype.stringify=function(S,P){var E=this,p=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()},this._funcMap={};var l=JSON.stringify(S,function(S,P){if("function"==typeof P){var p=Math.random().toString().substring(3,16)+Date.now();return E._funcMap[p]=P,p}return P},null==P?2:P);return Date.prototype.toJSON=p,l},P}(LP),xp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p.formPane=new eP,p.formPane.addRow([{id:"text",textArea:{}}],[.1],.1);var _=[];return _.push({label:l("editor.ok"),action:function(){p.ok()}}),_.push({label:l("editor.cancel"),action:function(){p.hide()}}),p.setConfig({closable:!0,draggable:!0,width:400,height:300,contentPadding:6,resizeMode:"wh",maximizable:!0,content:p.formPane,buttons:_,buttonsAlign:"right"}),p}return BP(P,S),P.prototype.$49$=function(){this.hide()},P.prototype.$48$=function(){this.ok()},P.prototype.ok=function(){this.setValue&&this.setValue(this.formPane.v("text")),this.hide()},P.prototype.open=function(S,P,E){this.setValue=P,this.setTitle(E),this.formPane.v("text",S),this.show()},P}(LP),Mp=function(){function S(){$P(this,S)}return S.prototype.init=function(){var S=this.baseFonts=["monospace","sans-serif","serif"],P=this.testString="mmmmmmmmmmlli",E=this.testSize="72px",p=this.h=document.getElementsByTagName("body")[0],l=this.s=document.createElement("span");l.style.fontSize=E,l.innerHTML=P;var _=this.defaultWidth={},m=this.defaultHeight={};for(var u in S)l.style.fontFamily=S[u],p.appendChild(l),_[S[u]]=l.offsetWidth,m[S[u]]=l.offsetHeight,p.removeChild(l);this.initialized=!0},S.prototype.detect=function(S){this.initialized||this.init();var P=!1,E=this.baseFonts,p=this.s,l=this.h,_=this.defaultWidth,m=this.defaultHeight;for(var u in E){p.style.fontFamily=S+","+E[u],l.appendChild(p);var F=p.offsetWidth!=_[E[u]]||p.offsetHeight!=m[E[u]];l.removeChild(p),P=P||F}return P},S}(),bp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p}return BP(P,S),P.prototype.init=function(){var S=this;this._detector=new Mp;var P=this.borderPane=new XE,E=this.rightBorder=new XE,p=this.previewGraph=new ht.graph.GraphView,_=this.listView=new QE,m=this.formPane=new eP;_.getView().style.borderRight="2px solid #f7f7f7",P.setLeftView(_),P.setCenterView(E),P.setLeftWidth(180),E.setBottomView(p),E.setBottomHeight(120),E.setCenterView(m),p.adjustTranslateX=function(){return 0},p.adjustTranslateY=function(){return 0},p.handleScroll=function(){return!1},p.setScrollBarVisible(!1);var u=this.textNode=new ht.Text;u.s({"2d.selectable":!1,text:rP.config.fontPreview}),u.setAnchor(0,0),u.setSize(2e3,120),u.p(4,4),p.dm().add(u);m.setVPadding(32),m.setVGap(32),m.setHGap(0),m.addRow([{element:l("editor.font.style"),align:"right"},"",{id:"normal",button:this.createStyleButton(l("editor.font.normal"))},{id:"bold",button:this.createStyleButton(l("editor.font.bold"))},{id:"oblique",button:this.createStyleButton(l("editor.font.oblique"))},{id:"obliqueBold",button:this.createStyleButton(l("editor.font.obliqueBold"))}],[60,8,.1,.1,.1,.1],32),m.addRow([{element:l("editor.font.size"),align:"right"},"",{id:"fontSize",slider:{max:72,min:12,step:1,onValueChanged:function(P,E){m.getItemById("fontSizeLabel").element=E+"",m.iv(),S._handleFontChange()}}},{id:"fontSizeLabel",element:"12"}],[60,8,.1,20],32);var F=[];F.push({label:l("editor.ok"),action:function(){S.ok()}}),F.push({label:l("editor.cancel"),action:function(){S.hide()}}),this.initFontList(),this.setConfig({closable:!0,draggable:!0,width:580,height:420,contentPadding:6,resizeMode:"wh",maximizable:!0,content:P,buttons:F,buttonsAlign:"right"}),this._init=!0},P.prototype.createStyleButton=function(S){var P=this;return{label:S,groupId:"fontStyle",labelSelectColor:rP.config.color_select,labelColor:"#2c2c2c",borderSelectColor:"red",background:"rgb(247,247,247)",selectBackground:"rgb(247,247,247)",togglable:!0,borderColor:null,onClicked:function(S){P._handleFontChange()}}},P.prototype.initFontList=function(){var S=this,P=this.listView,E=P.getView().style,p=P.dm(),l=this._detector,_=rP.config.fontList;return P.sm().ms(function(P){S._handleFontChange(P)}),_.forEach(function(S){if(l.detect(S)){var P=new ht.Node;P.setIcon(null),P.setName(S),p.add(P)}}),p.sm().setSelectionMode("single"),E.background="white",P},P.prototype.$49$=function(){this.hide()},P.prototype.$48$=function(){this.ok()},P.prototype._handleFontChange=function(){this.textNode.s("text.font",this.getFontString())},P.prototype.getFontString=function(){var S=this.listView,P=this.formPane,E=S.sm().ld(),p="";if(E){var l=S.sm().ld().getName();return["bold","oblique","obliqueBold"].forEach(function(S,E){P.getItemById(S).element.isSelected()&&(0===E?p="bold ":1===E?p="italic ":2===E&&(p="italic bold "))}),""+p+P.getValue("fontSize")+"px "+l}},P.prototype.ok=function(){this.setValue&&this.setValue(this.getFontString()),this.hide()},P.prototype.analysisFontString=function(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht.Default.labelFont,P=S.split(/px\s+/),E=P[0].split(/\s+/),p=P[1].split(",").map(function(S){return S.trim()}),l=/\d+/,_=void 0,m=void 0,u=void 0;E.forEach(function(S){"bold"===S?_=!0:"oblique"===S||"italic"===S?m=!0:l.test(S)&&(u=parseInt(S))}),this.setFormValue(u,p,_,m)},P.prototype.setFormValue=function(S,P,E,p){var l=this.listView,_=this.formPane;l.sm().cs(),l.dm().each(function(S){S.getName().toLowerCase()===P[0].toLowerCase()&&l.sm().ss(S)});var m=0;E&&p?m=3:E?m=1:p&&(m=2),["normal","bold","oblique","obliqueBold"].forEach(function(S,P){_.getItemById(S).element.setSelected(m===P)}),_.getItemById("fontSizeLabel").element=S+"",_.setValue("fontSize",S)},P.prototype.open=function(S,P,E){this._init||this.init(),this.setValue=P,this.setTitle(E),this.analysisFontString(S),this.show()},P}(LP);rP.FontView=bp;var jp=300,zp=230,cp=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));p.editor=E,p.addRow([{id:"content",textArea:{}}],[.1],.1),p.addRow([null,{button:{label:l("editor.ok"),onClicked:function(){p.hide(!0)}}},{button:{label:l("editor.cancel"),onClicked:function(){p.hide()}}}],[.1,50,50]),p.setWidth(jp),p.setHeight(zp),p.getView().className="ht-editor-styleicons",p.getView().style.background=rP.config.color_pane,p.getView().style.border=rP.config.color_pane_dark+" solid 1px",p.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,p.getView().style.overflow="visible";var _=function(S){!p.getView().parentNode||p.button.getView().contains(S.target)||p.getView().contains(S.target)||p.hide()};return window.addEventListener("mousedown",_,!1),window.addEventListener("touchstart",_,!1),p}return BP(P,S),P.prototype.toggle=function(S,P){this.getView().parentNode?this.hide():this.show(S,P)},P.prototype.show=function(S,P){if(!this.getView().parentNode){var E=S.getView().getBoundingClientRect(),p=(this.getView().style,z());ht.Default.appendToScreen(this),this.getView().style.top=p.top+E.top+"px",this.getView().style.left=p.left+E.left-jp-4+"px",this.iv(),this.button=S,this.data=P;var l=P.s("icons");this.v("content",l?G(l):"")}},P.prototype.hide=function(){var S=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getView().parentNode&&(e(this.getView()),S)){var P=this.v("content").trim();this.data.s("icons",P?J(P):void 0)}},P}(eP),Vp=function(){function S(P){var E=this;$P(this,S),this.editor=P;var p=this.container=ht.Default.createDiv(),l=this.wrap=ht.Default.createDiv(),_=p.style;_.pointerEvents="none",_.position="absolute",_.left=0,_.right=0,_.top=0,_.bottom=0,p.appendChild(l),_=l.style,_.width="600px",_.position="absolute",_.left="50%",_.bottom="20px",_.marginLeft="-300px",_.pointerEvents="none",this._cache=[],this._visibleCount=0,this.layoutContainer(),window.addEventListener("resize",function(){E.layoutContainer()})}return S.prototype.layoutContainer=function(){var S=this.container,P=ht.Default.getWindowInfo(),E=S.style;E.width=P.width+"px",E.height=P.height+"px"},S.prototype.createMessage=function(S){var P=this._cache.pop();if(!P){P=document.createElement("div");var E=P.style;E.boxSizing="border-box",E.padding=0,E.backgroundColor="rgba(61,61,61,0.15)",E.color="rgb(247,247,247)",E.margin="5px auto",E.textAlign="center",E.borderRadius="19px",E.height=0,E.overflow="hidden",E.pointerEvents="none",E.webkitTransition="0.3s all",E.mozTransition="0.3s all",E.msTransition="0.3s all",E.oTransition="0.3s all",E.transition="0.3s all"}return P.innerText=S,P},S.prototype.show=function(S){var P=this,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,l=this.createMessage(S);this.wrap.appendChild(l),this._visibleCount||document.body.appendChild(this.container),this._visibleCount++,l.style.backgroundColor="normal"===E?"rgba(61,61,61,0.15)":"#FF7C7C",setTimeout(function(){l.style.height="38px",l.style.padding="8px 20px",P.hideLater(l,p)},10)},S.prototype.hideLater=function(S,P){var E=this;setTimeout(function(){S.style.height=0,S.style.padding=0,setTimeout(function(){E.wrap.removeChild(S),E._cache.push(S),--E._visibleCount||document.body.removeChild(E.container)},500)},P)},S}(),gp=function S(P,E){var p=this;$P(this,S),this.editor=P,this.inspector=E,["isDataTitleVisible","isDataPropertyVisible","isCompTitleVisible","isCompPropertyVisible","isDisplayTitleVisible","isDisplayPropertyVisible","isSymbolTitleVisible","isSymbolPropertyVisible"].forEach(function(S){p[S]=function(){return!(rP.config.detailFilter[S]&&!rP.config.detailFilter[S].apply(E,arguments))&&!(P.inspectorCompact&&rP.config.compactFilter[S]&&!rP.config.compactFilter[S].apply(E,arguments))}})},Rp=function(S){function P(E,p,l){var _=arguments.length>3&&void 0!==arguments[3]&&arguments[3];$P(this,P);var m=KP(this,S.call(this));return m.setHPadding(8),m.global=_,m.editor=E,m.name=p,m.type=l,m.setVPadding(0),m.inspectorFilter=new gp(E,m),m.updateHandlers=[],m.editor.fireEvent("inspectorInitializing",{inspector:m}),m.initForm(),m.editor.fireEvent("inspectorInitialized",{inspector:m}),m.$104$(),m.editor.fireEvent("inspectorCreated",{inspector:m}),m.$47$=m._rows,m}return BP(P,S),P.prototype.initForm=function(){},P.prototype.beginTransaction=function(){this.dataModel&&this.dataModel.beginTransaction()},P.prototype.endTransaction=function(){this.dataModel&&this.dataModel.endTransaction()},P.prototype.addUpdateHandler=function(S){this.updateHandlers.push(S)},P.prototype.removeUpdateHandler=function(S){_(this.updateHandlers,S)},P.prototype.$104$=function(){for(var S=this._rows,P=!0,E=S.length-1;E>=0;E--)S[E].title?P?this.removeRow(S[E]):P=!0:P=!1},P.prototype.isTitleVisible=function(S){return!1!==S.visible&&(!TS(S.visible)||!1!==S.visible(this))},P.prototype.isPropertyVisible=function(S){var P=this.editor.inspectorInputFilter;if(P){if(!S.keys)return!1;P=P.toLowerCase();var E=S.keys.name;if(E&&E.toLowerCase().indexOf(P)>=0)return!0;var p=S.keys.displayName;return!!(p&&p.toLowerCase().indexOf(P)>=0)}return!1!==S.visible&&(!TS(S.visible)||!1!==S.visible(this))},P.prototype.makeItemsHidden=function(S){var P=this;S.hidden=!0,S.forEach(function(S){var E=P.getItemView(S);E&&(E.style.display="none")})},P.prototype.makeItemsVisible=function(S){var P=this;S.hidden=!1,S.forEach(function(S){var E=P.getItemView(S);E&&(E.style.display="block")})},P.prototype.filterPropertiesLater=function(){var S=this;this._filterPropertiesLater||(this._filterPropertiesLater=!0,requestAnimationFrame(function(){S.filterProperties()}))},P.prototype.isTitleExpanded=function(S){return!(S&&!this.editor.inspectorInputFilter)||rP.config.expandedTitles[S]},P.prototype.filterProperties=function(){var S=this;this._filterPropertiesLater=!1;var P=[],E=void 0,p=this.editor.inspectorInputFilter;this.$47$.forEach(function(l){var _=l.items;l.title?S.isTitleVisible(l)?(E=l.title,l.button.setIcon(S.isTitleExpanded(E)?"expandIcon":"collapseIcon"),p&&P.length&&P[P.length-1].title&&S.makeItemsHidden(P.pop().items),P.push(l),S.makeItemsVisible(_)):(E="HTISFUCKINGAWESOME",S.makeItemsHidden(_)):S.isTitleExpanded(E)&&S.isPropertyVisible(l)?(P.push(l),S.makeItemsVisible(_)):S.makeItemsHidden(_)}),p&&P.length&&P[P.length-1].title&&this.makeItemsHidden(P.pop().items),this._rows=P,this.updateProperties(),this.iv()},P.prototype.addTitle=function(S,P){var E=this,p=this._oldTitle;this.editor.fireEvent("titleCreating",{oldTitle:p,title:S,inspector:this});var _=function(){rP.config.expandedTitles[S]=!rP.config.expandedTitles[S],E.filterProperties()},m=[],u=this.addButton(m,null,null,null,_,!0);u.setBorderColor(null);var F=l("editor."+S.toLowerCase(),!0)||l(S);m.push({element:F,font:rP.config.boldFont}),P=P||{},P.title=S,P.background=rP.config.color_pane_dark,P.button=u;var f=this.addRow(m,[20,.1],rP.config.inspectorTitleHeight||null,P);return this._oldTitle=S,this.editor.fireEvent("titleCreated",{oldTitle:p,title:S,inspector:this}),f},P.prototype.$35$=function(){var S=this;this._updatePropertiesLater||(this._updatePropertiesLater=!0,requestAnimationFrame(function(){S.updateProperties()}))},P.prototype.updateProperties=function(){this._updating=!0,this.updateHandlers.forEach(function(S){S()}),this.editor.fireEvent("propertiesUpdated",{inspector:this}),this._updating=!1,this._updatePropertiesLater=!1},P.prototype.eachSelection=function(S){this.dataModel&&(this.beginTransaction(),this.dataModel.sm().each(function(P){S(P)}),this.endTransaction())},P.prototype.getPropertyValue=function(S,P){var E=this.global?this.dataModel:this.data;if(E){if("s"===(P=this.fixAccessType(P)))return E.s(S);if("a"===P)return E.a(S);if("p"===P){var p=ht.Default.getter(S);if(E[p])return E[p]()}}},P.prototype.setPropertyValue=function(S,P,E,p){if(!this._updating&&this.dataModel){E=this.fixAccessType(E);var l=void 0;this.global?l=[this.dataModel]:p?this.data&&(l=[this.data]):l=this.dataModel.sm().toSelection().toArray(),l&&l.forEach(function(p){if("s"===E&&p.s(S,P),"a"===E&&p.a(S,P),"p"===E){var l=ht.Default.setter(S);p[l]&&p[l](P)}})}},P.prototype.getValue=function(S){if(this.dataModel)return this.global?S(this.dataModel):this.data?S(this.data):void 0},P.prototype.setValue=function(S,P,E){!this._updating&&this.dataModel&&(this.beginTransaction(),this.global?S(this.dataModel,E?E():P):S.once?this.data&&S(this.data):this.dataModel.sm().each(function(p){S(p,E?E():P)}),this.endTransaction())},P.prototype.addLabelArray=function(S,P,E,p,l){return this.addLabel(S,P,E,p),this.addArray(S,E,p,l)},P.prototype.addLabelTextArea=function(S,P,E,p){return this.addLabel(S,P,E,p),this.addTextArea(S,E,p)},P.prototype.addLabelMultiline=function(S,P,E,p){var l=this;this.addLabelInput(S,P,E,p),this.addButton(S,"...",null,null,function(S){var _=function(S){l.setValue(p,S)};l.editor.textView.open(l.getValue(E),_,P)},!0)},P.prototype.addLabelInput=function(S,P,E,p,l,_,m){return this.addLabel(S,P,E,p,_),this.addInput(S,E,p,l,m)},P.prototype.addLabelRange=function(S,P,E,p,l,_,m,u){return this.addLabelInput(S,P,function(S){var P=E(S);return null==P?_:P},p?function(S,P){void 0!==_&&P>_&&(P=_),void 0!==l&&P<l&&(P=l),p(S,P)}:null,u,m)},P.prototype.addLabelColor=function(S,P,E,p){return this.addLabel(S,P,E,p),this.addColor(S,E,p)},P.prototype.addLabelCheckBox=function(S,P,E,p){return this.addLabel(S,P,E,p),this.addCheckBox(S,E,p)},P.prototype.addLabelFunction=function(S,P,E,p,l){return this.addLabel(S,P,E,p),this.addFunction(S,E,p,l)},P.prototype.addLabelObject=function(S,P,E,p,l){return this.addLabel(S,P,E,p),this.addObject(S,E,p,l)},P.prototype.addLabelComboBox=function(S,P,E,p,l,_,m){return this.addLabel(S,P,E,p),this.addComboBox(S,E,p,l,_,m)},P.prototype.addLabelURL=function(S,P,E,p,l){var _=this.addLabelInput(S,P,E,p,null,null,!1);if(p){var m=_.getElement();_.isDroppable=l||function(S,P){return!!P.view.draggingData},_.handleCrossDrag=function(S,P,E){"enter"===P?m.style.border="solid "+rP.config.color_select_dark+" 2px":"exit"===P||"cancel"===P?m.style.border="":"over"===P||"drop"===P&&(m.style.border="",m.value=E.view.draggingData.url,_.setFocus(),_.handleChange())}}return _},P.prototype.addLabelImage=function(S,P,E,p){var l=function(S,P){if(!P.view.draggingData)return!1;var E=P.view.draggingData.fileType;return E===NP||E===ZP};return this.addLabelURL(S,P,E,p,l),this.addImage(S,E,p)},P.prototype.addLabelGradient=function(S,P,E,p,l){var _=this,m=[],u=function(){return _.data&&_.data.s(l)||rP.config.color_light},F=function(){return _.data&&_.data.s(p)||rP.config.color_select};rP.consts.gradients.forEach(function(S){S?m.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:S,gradientColor:{func:u},background:{func:F}}]}):m.push({width:20,height:14,comps:[]})});var f=this.addLabelComboBox(S,P,function(S){return S.s(E)},function(S,P){S.s(E,P)},rP.consts.gradients,null,m);this.updateHandlers.push(function(){if(!S.hidden){var P=u(),E=F();f._lastGradientColor===P&&f._lastBackground===E||(f._lastGradientColor=P,f._lastBackground=E,f.iv())}})},P.prototype.addLabelFont=function(S,P,E,p){var l=this;this.addLabelInput(S,P,function(S){return E(S)||ht.Default.labelFont},p?function(S,P){p(S,P||void 0)}:null),this.addButton(S,"...",null,null,function(S){var _=function(S){l.setValue(p,S)};l.editor.fontView.open(l.getValue(E),_,P)},!0)},P.prototype.addLabelRotation=function(S,P,E,p,l,_,m){return this.addLabelInput(S,P,function(S){return null==E(S)?_:180/Math.PI*E(S)},p?function(S,P){P=P*Math.PI/180,void 0!==_&&P>_&&(P=_),void 0!==l&&P<l&&(P=l),p(S,P)}:null,"number",m||1)},P.prototype.addLabelAlign=function(S,P,E,p){return this.addLabelComboBox(S,P,function(S){return E(S)||"center"},p,rP.consts.aligns,rP.consts.alignLabels)},P.prototype.addLabelVAlign=function(S,P,E,p){return this.addLabelComboBox(S,P,function(S){return E(S)||"bottom"},p,rP.consts.vAligns,rP.consts.vAlignLabels)},P.prototype.addLabelStretch=function(S,P,E,p){this.addLabelComboBox(S,P,function(S){return E(S)||"fill"},p,rP.consts.stretchs,rP.consts.stretchLabels)},P.prototype.addOrientation=function(S,P,E,p){return this.addLabelComboBox(S,P,function(S){return E(S)||"top"},p,rP.consts.orientations,rP.consts.orientationLabels)},P.prototype.addLabelLabel=function(S,P,E,p){this.addLabelInput(S,P,function(S){var P=E(S);return P&&P.replace&&(P=P.replace(/\n/g,"\\n")),P},p?function(S,P){P&&P.replace&&(P=P.replace(/\\n/g,"\n")),p(S,P)}:null)},P.prototype.toDisplayName=function(S){var P=S[0];if(P){if(fS(P))return P;if(fS(P.element))return P.element;if(P.element)return P.element.innerHTML}},P.prototype.addLabel=function(S,P,E,p,l){var _=this;if(l&&p){var m=AS(P,S.length?"right":"left");S.push(m),m.style.cursor="ew-resize";var u=function(S){S.preventDefault(),_.beginTransaction();var P=_.getValue(E)||0,m=M(S).x,u=function(S){S.preventDefault();var E=P+(M(S).x-m)*l;_.setValue(p,E)};window.addEventListener("mousemove",u,!1),window.addEventListener("touchmove",u,!1);var F=function(S){_.endTransaction(),S.preventDefault(),window.removeEventListener("mousemove",u,!1),window.removeEventListener("touchmove",u,!1),window.removeEventListener("mouseup",F,!1),window.removeEventListener("touchend",F,!1)};window.addEventListener("mouseup",F,!1),window.addEventListener("touchend",F,!1)};return m.addEventListener("mousedown",u,!1),m.addEventListener("touchstart",u,!1),m}var F={element:P,align:S.length?"right":"left"};return S.push(F),F},P.prototype.createHandleChange=function(S,P,E){var p=this;return function(){var l=S.value;if("pattern"===E)if(l=l.trim()){if(l.indexOf("[")<0||l.indexOf("]")<0)return;if(l=l.replace("[","").replace("]","").split(","),l.length){for(var _=[],m=0;m<l.length;m++){var u=parseFloat(l[m]);if(isNaN(u))return;_.push(u)}l=_}else l=void 0}else l=void 0;else if("number"===E){if(l=parseFloat(l),isNaN(l))return}else if("int"===E){if(l=parseInt(l),isNaN(l))return}else l||(l=void 0);p.setValue(P,l)}},P.prototype.createArrayIndexColumn=function(S,P,p,_){var m=this,u=S[P],F="object"===_?G(u):u;return{name:P,width:50,align:"center",editable:!!p,sortable:!1,clickable:!1,getValueType:function(S){return _},getValue:function(S){return F},setValue:function(l,_,u,F){m.setValue(p,void 0,function(){var p=S.slice();return p[P]=E(u),p})},isCellEditable:function(S,E,p,F){if("object"===_){var f=l("editor.object")+" ["+P+"]";return m.editor.objectView.open(u,function(P){E.setValue(S,E,P,F)},f),!1}return!0}}},P.prototype.addArray=function(S,P,E,p){var _=this,m=new sE;m.getTableHeader().setMovable(!1),m.getView().style.border=rP.config.color_line+" solid 1px";var u=m.getTableView();return u.getDataModel().add(new ht.Data),this.updateHandlers.push(function(){if(!S.hidden){var F=_.getValue(P);if(u.getColumnModel().clear(),m.addColumns([{name:l("editor.length"),width:50,align:"center",editable:!!E,sortable:!1,clickable:!1,valueType:"int",getValue:function(S){return F?F.length:0},setValue:function(S,P,l,m){_.setValue(E,void 0,function(){if(l>=0){var S=IS(F,l);return"number"===p||"int"===p?DS(S):"color"===p&&yS(S),S}})}}]),F){for(var f=[],H=0;H<F.length;H++)f.push(_.createArrayIndexColumn(F,H,E,p));m.addColumns(f)}}}),S.push(m),m},P.prototype.addTextArea=function(S,P,E){var p=this,l=new ht.widget.TextArea,_=l.getElement();return E?(_.onblur=function(){p.setValue(E,_.value)},_.forceOnblur=_.onblur):l.setEditable(!1),this.updateHandlers.push(function(){if(!S.hidden){var E=p.getValue(P);null==E&&(E=""),_.value!==E&&(_.value=E)}}),S.push(l),l},P.prototype.addInput=function(S,P,E,l,_){var m=this,u=new ht.widget.TextField;"number"!==l&&"int"!==l||u.setType("number");var F=u.getElement();if(E){var f=this.createHandleChange(F,E,l);u.handleChange=f,_?(F.onkeyup=f,F.onchange=f):(F.onblur=f,F.forceOnblur=F.onblur,F.onkeydown=function(S){i(S)&&f()})}else u.setEditable(!1);return this.updateHandlers.push(function(){if(!S.hidden){var E=m.getValue(P);"pattern"===l?E=E?"["+E.join()+"]":"":"number"===l?E=p(parseFloat(E||0)):"int"===l?E=parseInt(E||0):null==E&&(E=""),F.value!==E&&(fS(E)&&E.length>1e3&&E.startsWith("data:image")&&(E=E.substr(0,10)+"[...]"),F.value=E)}}),S.push(u),u},P.prototype.addColor=function(S,P,E){var p=this,l=new ht.widget.ColorPicker;return E?(l.setInstant(!0),l.onValueChanged=function(){p.setValue(E,l.getValue())},l.addViewListener(function(S){"open"===S.kind?p.beginTransaction():"close"===S.kind&&p.endTransaction()})):l.setDisabled(!0),this.updateHandlers.push(function(){if(!S.hidden){var E=p.getValue(P);void 0===E&&(E=null),l.getValue()!=E&&l.setValue(E)}}),S.push(l),l},P.prototype.addImage=function(S,P,E){var p=this,l=new ht.widget.Image;l.vectorDataBindingDisabled=!0,this.updateHandlers.push(function(){if(!S.hidden){var E=p.getValue(P);l.rawIcon=E,E=ht.Default.getImage(E),E&&E.snapshotURL?l.setIcon(E.snapshotURL):l.setIcon(l.rawIcon)}});var _=l.getView();_.style.cursor="pointer";var m=function(S){S.preventDefault(),Y(S)?p.editor.open(l.rawIcon):p.editor.selectFileNode(l.rawIcon)};return _.addEventListener("mousedown",m,!1),_.addEventListener("touchstart",m,!1),S.push(l),l},P.prototype.addCheckBox=function(S,P,E){var p=this,l=new ht.widget.CheckBox;return E?l.onValueChanged=function(){p.setValue(E,l.getValue())}:l.setDisabled(!0),this.updateHandlers.push(function(){if(!S.hidden){var E=!!p.getValue(P);l.getValue()!==E&&l.setValue(E)}}),S.push(l),l},P.prototype.addFunction=function(S,P,E,p){var _=this,m=function(){var S=l("editor.function")+" "+(p||""),m=function(S){_.setValue(E,S)};_.editor.functionView.open(_.getValue(P),m,S)},F=p||l("editor.function"),f=NS(F,null,null,m);return S.push(f),this.updateHandlers.push(function(){if(!S.hidden){var E=_.getValue(P);f.setLabel(u(E)),f.setLabelColor(E?rP.config.color_select:ht.Default.labelColor)}}),f},P.prototype.addObject=function(S,P,E,p){var _=this,m=function(){var S=l("editor.object")+" "+(p||""),m=function(S){_.setValue(E,S)};_.editor.objectView.open(_.getValue(P),m,S)},u=NS("",null,null,m);return S.push(u),this.updateHandlers.push(function(){if(!S.hidden){var E=_.getValue(P);u.setLabel(G(E)),u.setLabelColor(void 0!==E?rP.config.color_select:ht.Default.labelColor)}}),u},P.prototype.addComboBox=function(S,P,E,p,l,_){var m=this,u=new ht.widget.ComboBox;return u.setValues(p),u.setLabels(l),u.setIcons(_),u.setDisabled(!E),E&&(u.onValueChanged=function(){m.setValue(E,u.getValue())}),this.updateHandlers.push(function(){if(!S.hidden){var E=m.getValue(P);u.getValue()!==E&&u.setValue(E)}}),_&&_[0].width&&u.setIndent(_[0].width+4),S.push(u),u},P.prototype.addButton=function(S,P,E,p,l,_){var m=this,u=function(){m.global||_?l():m.eachSelection(l)},F=NS(P,E,p,u);return S.push(F),F},P.prototype.addFuncRow=function(S,P,E,p){var l=this,_=p?this.getRowHeight()*p:null,m=function(){l.dataModel&&l.editor.funcView.toggle(F,P,E,l)},u=(E||P)+": { func: ... }",F=this.addButton(S,null,u,null,m,!0);this.updateHandlers.push(function(){if(!S.hidden){var E=!1;l.global?l.dataModel&&(E="clip"===P?TS(l.dataModel.a(P)):!!l.dataModel.a(P+"_func")):l.data&&(E=!!l.data.a(P)),F.setIcon(E?"editor.bind.state":"editor.unbind.state")}});var f=S.length,H=void 0;return 3===f?H=this.addRow(S,[rP.config.indent,.1,20],_):4===f?H=this.addRow(S,[rP.config.indent,.1,20,20],_):5===f?H=this.addRow(S,[rP.config.indent,.1,20,20,20],_):6===f&&(H=this.addRow(S,[rP.config.indent,.1,20,20,20,20],_)),H.keys={name:E||P,displayName:this.toDisplayName(S)},!this.addingCustomProperties&&EE[this.type][E||P]&&this.removeRows([H]),H},P.prototype.addNameRow=function(S,P,E,p){var l=p?this.getRowHeight()*p:null,_=S.length,m=void 0;return 2===_?m=this.addRow(S,[rP.config.indent,.1],l):3===_?m=this.addRow(S,[rP.config.indent,.1,20],l):4===_?m=this.addRow(S,[rP.config.indent,.1,20,20],l):5===_&&(m=this.addRow(S,[rP.config.indent,.1,20,20,20],l)),m.keys={name:P,displayName:this.toDisplayName(S),accessType:E},P=(E?E+":":"")+P,!this.addingCustomProperties&&EE[this.type][P]&&this.removeRows([m]),m},P.prototype.$78$=function(){var S=this;this.addTitle("TitleGridsGuides");var P=[];this.addLabelInput(P,l("editor.gridblocksize"),function(S){return S.a("gridBlockSize")},function(S,P){P>0&&S.a("gridBlockSize",P)},"int",1),this.addNameRow(P,"gridBlockSize","a"),P=[],this.addLabelInput(P,l("editor.gridthicklinesevery"),function(S){return S.a("gridThickLinesEvery")},function(S,P){P>0&&S.a("gridThickLinesEvery",P)},"int",1),this.addNameRow(P,"gridThickLinesEvery","a"),P=[],this.addLabelColor(P,l("editor.gridthickcolor"),function(S){return S.a("gridThickColor")},function(S,P){S.a("gridThickColor",P)}),this.addNameRow(P,"gridThickColor","a"),P=[],this.addLabelColor(P,l("editor.gridlightcolor"),function(S){return S.a("gridLightColor")},function(S,P){S.a("gridLightColor",P)}),this.addNameRow(P,"gridLightColor","a"),P=[],this.addLabelInput(P,l("editor.gridangle"),function(S){return 180/Math.PI*S.a("gridAngle")},function(S,P){S.a("gridAngle",P*Math.PI/180)},"number",1),this.addNameRow(P,"gridAngle","a"),P=[],this.addLabelInput(P,l("editor.gridrotation"),function(S){return 180/Math.PI*S.a("gridRotation")},function(S,P){S.a("gridRotation",P*Math.PI/180)},"number",1),this.addNameRow(P,"gridRotation","a"),P=[],this.addLabelInput(P,l("editor.gridzoomthreshold"),function(S){return S.a("gridZoomThreshold")},function(S,P){P>0&&S.a("gridZoomThreshold",P)},"number",.01),this.addNameRow(P,"gridZoomThreshold","a"),P=[null];this.addButton(P,l("editor.reset"),null,null,function(){S.editor.currentView&&S.editor.currentView.resetGrid&&S.editor.currentView.resetGrid()})
;this.addNameRow(P,"gridReset")},P.prototype.$27$=function(){var S=this;this.addTitle("TitleEditingPoint");var P={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3};this.editingPointButtons=[];var E=function(E,p){var _=l("editor.editingpoint."+p.toLowerCase()),m="editor.point."+p.toLowerCase(),u=NS(_,null,m,function(){S.editor.editInteractor.getSubModule("Curve").setCurrentSelectionStatus(u.statusValue)});u.setOrientation("v"),u.setTogglable(!0),u.setGroupId("editingPoint"),u.statusValue=P[p],S.editingPointButtons.push(u),E.push(u)},p=[];E(p,"Straight"),E(p,"Mirrored"),this.addRow(p,[.1,.1],60),p=[],E(p,"Disconnected"),E(p,"Asymmetric"),this.addRow(p,[.1,.1],60)},P.prototype.addCustomProperties=function(){var S=this,P=rP.config.customProperties[this.type];P&&P.length&&(this.addTitle("TitleCustom"),P.forEach(function(P){S.addCustomProperty(P)}))},P.prototype.fixAccessType=function(S){return S=S||"a","symbol"===this.type?S="a":"comp"===this.type&&(S="s"),S},P.prototype.addEventProperties=function(){var S=this,P=[],E=function(){var P=S.global?S.dataModel:S.data;P&&(P=S.global?[S.dataModel]:S.dataModel.sm().getSelection().toArray()),S.editor.eventView.open(P,S.type)};this.addLabel(P,l("editor.events"));var p=this.addButton(P,l("editor.eventhandlers"),null,null,E,!0);"data"===this.type?(this.addCheckBox(P,function(S){return!!S&&S.s("interactive")},function(S,P){S&&S.s("interactive",P)}),this.addRow(P,[rP.config.indent,.1,20]).keys={name:"eventHandlers"}):this.addRow(P,[rP.config.indent,.1]).keys={name:"eventHandlers"},this.updateHandlers.push(function(){if(!P.hidden){var E=!1,l=S.global?S.dataModel:S.data;qP.forEach(function(P){E||(E="data"===S.type?l.s(P):l.a(P))}),p.setLabelColor(E?rP.config.color_select:ht.Default.labelColor)}})},P.prototype.addCustomProperty=function(S){var P=S.name,E=S.valueType,p=!1!==S.editable,_=S.defaultValue,m=this.fixAccessType(S.accessType),u=S.dataBinding,F=S.property;if(!(E=rP.config.valueTypes[E]))return!1;this.addingCustomProperties=!0;var f=[],X=l(P)||F,W=H(m,F),h=T(m,F),Q=function(S){var P=W(S);return void 0===P&&(P=_),P},i=p?h:null;"int"===E.type||"number"===E.type?E.angle?this.addLabelRotation(f,X,Q,i,E.min,E.max,E.step):this.addLabelRange(f,X,Q,i,E.min,E.max,E.step,E.type):"color"===E.type?this.addLabelColor(f,X,Q,i):"boolean"===E.type?this.addLabelCheckBox(f,X,Q,i):"enum"===E.type?this.addLabelComboBox(f,X,Q,i,E.values,E.labels,E.icons):"image"===E.type?this.addLabelImage(f,X,Q,i):"url"===E.type?this.addLabelURL(f,X,Q,i):"multiline"===E.type?this.addLabelMultiline(f,X,Q,i):"colorArray"===E.type?this.addLabelArray(f,X,Q,i,"color"):"numberArray"===E.type?this.addLabelArray(f,X,Q,i,"number"):"stringArray"===E.type?this.addLabelArray(f,X,Q,i,"string"):"objectArray"===E.type?this.addLabelArray(f,X,Q,i,"object"):"function"===E.type?this.addLabelFunction(f,X,Q,i,F):"object"===E.type?this.addLabelObject(f,X,Q,i,F):this.addLabelInput(f,X,Q,i),"display"!==this.type&&u?"data"===this.type?this.addDBRow(f,m,F,null,E.rows):"symbol"!==this.type&&"comp"!==this.type||this.addFuncRow(f,F,null,E.rows):this.addNameRow(f,m+":"+F,m,E.rows),this.addingCustomProperties=!1},P}(eP);rP.Inspector=Rp;var Gp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p,"display",!0))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$12$(),this.$78$(),this.$79$()},P.prototype.isTitleVisible=function(P){return!!this.inspectorFilter.isDisplayTitleVisible(this.editor,P.title)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){return!!this.inspectorFilter.isDisplayPropertyVisible(this.editor,P.keys&&P.keys.name)&&S.prototype.isPropertyVisible.call(this,P)},P.prototype.$12$=function(){this.addTitle("TitleBasic");var S=[];this.addLabelInput(S,l("editor.previewurl"),function(S){return S.a("previewURL")},function(S,P){S.a("previewURL",P)}),this.addNameRow(S,"previewURL","a"),S=[],this.addLabelImage(S,l("editor.snapshoturl"),function(S){return S.a("snapshotURL")},function(S,P){S.a("snapshotURL",P)}),this.addNameRow(S,"snapshotURL","a"),S=[],this.addLabelColor(S,l("editor.background"),function(S){return S.getBackground()},function(S,P){S.setBackground(P)}),this.addNameRow(S,"background","p"),S=[],this.addLabelInput(S,l("editor.width"),function(S){return S.a("width")},function(S,P){S.a("width",P)},"number",1),this.addNameRow(S,"width","a"),S=[],this.addLabelInput(S,l("editor.height"),function(S){return S.a("height")},function(S,P){S.a("height",P)},"number",1),this.addNameRow(S,"height","a"),S=[],this.addLabelInput(S,l("editor.datacount"),function(S){return S.size()}),this.addNameRow(S,"count"),S=[],this.addLabelComboBox(S,l("editor.connectactiontype"),function(S){return S.a("connectActionType")},function(S,P){S.a("connectActionType",P)},rP.consts.displayConnectActionTypes,rP.consts.displayConnectActionTypeLabels),this.addNameRow(S,"connectActionType","a"),S=[],this.addLabelCheckBox(S,l("editor.rotateasclock"),function(S){return S.a("rotateAsClock")},function(S,P){S.a("rotateAsClock",P)}),this.addNameRow(S,"rotateAsClock","a"),S=[],this.addLabelCheckBox(S,l("editor.hierarchicalrendering"),function(S){return S.isHierarchicalRendering()},function(S,P){S.setHierarchicalRendering(P)}),this.addNameRow(S,"hierarchicalRendering","p")},P.prototype.$79$=function(){this.addTitle("TitleLayout");var S=[];this.$80$(S,"circular"),this.$80$(S,"symmetric"),this.$80$(S,"hierarchical"),this.$80$(S,"towardnorth"),this.$80$(S,"towardsouth"),this.$80$(S,"towardeast"),this.$80$(S,"towardwest"),this.addRow(S,[.1,.1,.1,.1,.1,.1,.1]).keys={name:"layouts"}},P.prototype.$80$=function(S,P){var E=this,p=function(){E.dataModel&&E.dataModel.layout(P)};return this.addButton(S,null,l("editor.layout."+P),"editor.layout."+P+".state",p)},P}(Rp),Jp={visible:"Boolean",selectable:"Boolean",movable:"Boolean",editable:"Boolean",opacity:"Opacity",clipPercentage:"Percentage",clipDirection:"ClipDirection",shadow:"Boolean",shadowColor:"Color",shadowBlur:"PositiveNumber",shadowOffsetX:"PositiveNumber",shadowOffsetY:"PositiveNumber",type:"String",background:"Color",repeatImage:"String",borderWidth:"PositiveNumber",borderColor:"Color",border3d:"Boolean",border3dColor:"Color",border3dAccuracy:"PositiveNumber",borderCap:"CapStyle",borderJoin:"JoinStyle",gradient:"Gradient",gradientColor:"Color",dash:"Boolean",dashOffset:"Number",dashColor:"Color",dashWidth:"PositiveNumber",dash3d:"Boolean",dash3dColor:"Color",dash3dAccuracy:"PositiveNumber",borderWidthAbsolute:"Boolean",fillClipPercentage:"Percentage",fillClipDirection:"ClipDirection",depth:"Number",cornerRadius:"PositiveNumber",polygonSide:"Int",arcFrom:"Number",arcTo:"Number",arcClose:"Boolean",arcOval:"Boolean",displayName:"String",scaleX:"Number",scaleY:"Number",anchorX:"Number",anchorY:"Number",rotation:"Number",color:"Color",width:"PositiveNumber",label:"Boolean",labelColor:"Color",labelFont:"String",minValue:"Number",maxValue:"Number",linePoint:"Boolean",lineWidth:"PositiveNumber",line3d:"Boolean",text:"String",align:"Align",vAlign:"VAlign",closePath:"Boolean",fillRule:"FillRule",name:"String",stretch:"Stretch",values:"NumberArray",colors:"ColorArray",hollow:"Boolean"},$p=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p,"symbol",!0))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$12$(),this.addDataBindingProperties(),this.$78$()},P.prototype.isTitleVisible=function(P){return!!this.inspectorFilter.isSymbolTitleVisible(this.editor,P.title)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){return!!this.inspectorFilter.isSymbolPropertyVisible(this.editor,P.keys&&P.keys.name)&&S.prototype.isPropertyVisible.call(this,P)},P.prototype.$12$=function(){var S=this,P=void 0;this.addTitle("TitleBasic"),this.addEventProperties(),this.addHTMLProperties(),P=[],this.addLabelInput(P,l("editor.previewurl"),function(S){return S.a("previewURL")},function(S,P){S.a("previewURL",P)}),this.addRow(P,[rP.config.indent,.1]).keys={name:"previewURL"},P=[],this.addLabelImage(P,l("editor.snapshoturl"),function(S){return S.a("snapshotURL")},function(S,P){S.a("snapshotURL",P)}),this.addRow(P,[rP.config.indent,.1,20]).keys={name:"snapshotURL"},P=[],this.addLabelColor(P,l("editor.background"),function(S){return S.getBackground()},function(S,P){S.setBackground(P)}),this.addRow(P,[rP.config.indent,.1]).keys={name:"background"},P=[],this.addLabelInput(P,l("editor.width"),function(S){return S.a("width")},function(S,P){S.a("width",P)},"number",1),this.addFuncRow(P,"width"),P=[],this.addLabelInput(P,l("editor.height"),function(S){return S.a("height")},function(S,P){S.a("height",P)},"number",1),this.addFuncRow(P,"height"),P=[],this.addLabelInput(P,l("editor.boundextend"),function(S){return S.a("boundExtend")},function(S,P){S.a("boundExtend",P)},"number",1),this.addFuncRow(P,"boundExtend"),P=[],this.addLabelComboBox(P,l("editor.connectactiontype"),function(S){return S.a("connectActionType")},function(S,P){S.a("connectActionType",P)},rP.consts.symbolConnectActionTypes,rP.consts.symbolConnectActionTypeLabels),this.addRow(P,[rP.config.indent,.1]).keys={name:"connectActionType"},P=[],this.addLabelCheckBox(P,l("editor.rotateasclock"),function(S){return S.a("rotateAsClock")},function(S,P){S.a("rotateAsClock",P)}),this.addFuncRow(P,"rotateAsClock"),P=[],this.addLabelCheckBox(P,l("editor.fitsize"),function(S){return S.a("fitSize")},function(S,P){S.a("fitSize",P)}),this.addFuncRow(P,"fitSize"),P=[],this.addLabelCheckBox(P,l("editor.scrollable"),function(S){return S.a("scrollable")},function(S,P){S.a("scrollable",P)}),this.addFuncRow(P,"scrollable"),P=[],this.addLabelCheckBox(P,l("editor.interactive"),function(S){return S.a("interactive")},function(S,P){S.a("interactive",P)}),this.addFuncRow(P,"interactive"),P=[],this.addLabelCheckBox(P,l("editor.disableselectedborder"),function(S){return S.a("disableSelectedBorder")},function(S,P){S.a("disableSelectedBorder",P)}),this.addFuncRow(P,"disableSelectedBorder"),P=[],this.addLabelCheckBox(P,l("editor.pixelperfect"),function(S){return S.a("pixelPerfect")},function(S,P){S.a("pixelPerfect",P)}),this.addFuncRow(P,"pixelPerfect"),P=[],this.addLabelCheckBox(P,l("editor.visible"),function(S){return S.a("visible")},function(S,P){S.a("visible",P)}),this.addFuncRow(P,"visible"),P=[],this.addLabelCheckBox(P,l("editor.clip"),function(S){return S.a("clip")},function(S,P){S.a("clip",P)}).onValueChanged=function(P,E){S.dataModel&&(E?S.dataModel.a("clip")||S.dataModel.a("clip",!0):S.dataModel.a("clip",!1))},this.addFuncRow(P,"clip"),P=[],this.addLabelComboBox(P,l("editor.blendmode"),function(S){return S.a("blendMode")},function(S,P){S.a("blendMode",P)},["multiply","override","override_rgb","override_a"],[l("editor.blendmode.multiply"),l("editor.blendmode.override"),l("editor.blendmode.override_rgb"),l("editor.blendmode.override_a")]),this.addFuncRow(P,"blendMode"),P=[],this.addLabelInput(P,l("editor.compcount"),function(S){return S.size()}),this.addNameRow(P,"count")},P.prototype.addHTMLProperties=function(){var S=this,P=[],E=function(){S.editor.functionView.open(S.dataModel.a("renderHTML"),function(P){S.dataModel.a("renderHTML",P)},l("editor.renderhtml"))};this.addLabel(P,l("editor.html"));var p=this.addButton(P,l("editor.renderhtml"),null,null,E,!0);this.addRow(P,[rP.config.indent,.1]).keys={name:"renderHTML"},this.updateHandlers.push(function(){if(!P.hidden){var E=S.dataModel.a("renderHTML");p.setLabelColor(E?rP.config.color_select:ht.Default.labelColor)}})},P.prototype.addDataBindingProperties=function(){this.addTitle("TitleDataBinding"),this.$81$(),this.$82$()},P.prototype.$74$=function(S,P,E,p){var l=this;return{name:S,tag:S,width:E,displayName:P,align:"center",enum:p,editable:!0,getValue:function(P){return P.dataBinding[S]},setValue:function(P,E,p,_){P.dataBinding[S]!==p&&l.modifyDataBindings(function(){P.dataBinding[S]=p})}}},P.prototype.$75$=function(){var S=this,P=this.tableView.getColumnModel().getDataByTag("defaultValue");P.getEnumValues=function(S){var P=S?rP.config.valueTypes[S.dataBinding.valueType]:null;return P&&"enum"===P.type?P.values:null},P.getEnumLabels=function(S){var P=S?rP.config.valueTypes[S.dataBinding.valueType]:null;return P&&"enum"===P.type?P.labels:null},P.getEnumIcons=function(S){var P=S?rP.config.valueTypes[S.dataBinding.valueType]:null;return P&&"enum"===P.type?P.icons:null},P.getEnumDropDownWidth=function(S){var P=S?rP.config.valueTypes[S.dataBinding.valueType]:null;return P&&"enum"===P.type?P.dropDownWidth:null},P.getValueType=function(S){var P=S?rP.config.valueTypes[S.dataBinding.valueType]:null;return P?P.type:null},P.isCellEditable=function(P,E,p,_){var m=rP.config.valueTypes[P.dataBinding.valueType],u=m?m.type:null;if("function"===u){var F=l("editor.function")+" "+(P.dataBinding.attr||"");return S.editor.functionView.open(P.dataBinding.defaultValue,function(E){P.dataBinding.defaultValue=E,S.tableView.redraw()},F),!1}if("multiline"===u)return S.editor.textView.open(P.dataBinding.defaultValue,function(E){P.dataBinding.defaultValue=E,S.tableView.redraw()},P.dataBinding.attr||"&nbsp;"),!1;if("font"===u)return S.editor.fontView.open(P.dataBinding.defaultValue,function(E){P.dataBinding.defaultValue=E,S.tableView.redraw()},P.dataBinding.attr||"&nbsp;"),!1;if("object"===u||"stringArray"===u||"objectArray"===u||"numberArray"===u||"colorArray"===u){var f=l("editor.object")+" "+(P.dataBinding.attr||"");return S.editor.objectView.open(P.dataBinding.defaultValue,function(E){P.dataBinding.defaultValue=E,S.tableView.redraw()},f),!1}return!0}},P.prototype.$81$=function(){var S=this,P=this.tableModel=new ht.DataModel,E=new sE(P);(this.tableView=E.getTableView()).setEditable(!0),E.getView().style.border=rP.config.color_line+" solid 1px",E.addColumns([this.$74$("attr","Attr",90),this.$74$("valueType",l("editor.valuetype"),80,{values:rP.consts.valueTypes,labels:rP.consts.valueTypeLabels}),this.$74$("defaultValue",l("editor.defaultvalue"),90),this.$74$("name",l("editor.name"),80),this.$74$("description",l("editor.description"),120)]),this.$75$();var p=[E];this.addRow(p,[.1],"120+0.1");var m=null;this.updateHandlers.push(function(){if(!p.hidden&&S.dataModel&&(!m||S.dataModel.dataBindings!==m)){m=S.dataModel.dataBindings;var E=P.sm().toSelection().toArray();P.clear(),S.dataModel.dataBindings&&S.dataModel.dataBindings.forEach(function(S){var p=new ht.Data;p.dataBinding=S,P.add(p);for(var l=0;l<E.length;l++)if(YS(E[l].dataBinding,S)){_(E,E[l]),P.sm().as(p);break}})}})},P.prototype.modifyDataBindings=function(S){var P=E(this.dataModel.dataBindings);S();var p=E(this.dataModel.dataBindings);this.dataModel.dataBindings=p,this.dataModel.fp("f:dataBindings",P,p)},P.prototype.$83$=function(S,P,E,p,l){var _=new ht.Data;_.dataBinding={attr:S||"",valueType:P||"String",defaultValue:E,name:p,description:l},this.dataModel.dataBindings||(this.dataModel.dataBindings=[]),this.dataModel.dataBindings.push(_.dataBinding)},P.prototype.add=function(){var S=this;this.modifyDataBindings(function(){S.$83$()})},P.prototype.delete=function(){var S=this;this.tableView.sm().ld()&&this.modifyDataBindings(function(){S.tableView.sm().each(function(P){_(S.dataModel.dataBindings,P.dataBinding)})})},P.prototype.reorder=function(){var S=this;this.dataModel.dataBindings=[],this.tableModel.getRoots().each(function(P){S.dataModel.dataBindings.push(P.dataBinding)})},P.prototype.import=function(){var S=this;this.modifyDataBindings(function(){rP.config.clearDataBindingsBeforeImporting&&(S.dataModel.dataBindings=[]);var P=S.editor.symbolView.content,E={};P.dataBindings&&P.dataBindings.forEach(function(S){E[S.attr]=!0}),P.comps.forEach(function(P){for(var p in P){var l=P[p];if(HS(l))if(fS(l.func)&&tP.test(l.func)){var _=l.func.slice(5);if(!E[_]){var m=void 0,u=void 0,F=void 0;if(pS(P.type)){var f=ht.Default.getCompType(P.type);if(f){var H=f.properties[p];m=H.valueType,u=H.name,F=H.description}}else m=Jp[p];S.$83$(_,m,void 0,u,F),E[_]=!0}}else{var T={};US(l,T);for(var X in T)E[X]||S.$83$(X,Jp[T[X]])}}})})},P.prototype.$82$=function(){var S=this;this.addRow([{button:{icon:"editor.add",toolTip:l("editor.add"),onClicked:function(){S.add()}}},{button:{icon:"editor.delete",toolTip:l("editor.delete"),onClicked:function(){S.delete()}}},{button:{icon:"editor.import",toolTip:l("editor.import"),onClicked:function(){S.import()}}},null,{button:{icon:"editor.top",toolTip:l("editor.bringtofront"),onClicked:function(){S.tableView.sm().size()&&S.modifyDataBindings(function(){S.tableModel.moveSelectionToTop(),S.reorder()})}}},{button:{icon:"editor.up",toolTip:l("editor.bringforward"),onClicked:function(){S.tableView.sm().size()&&S.modifyDataBindings(function(){S.tableModel.moveSelectionUp(),S.reorder()})}}},{button:{icon:"editor.down",toolTip:l("editor.sendbackward"),onClicked:function(){S.tableView.sm().size()&&S.modifyDataBindings(function(){S.tableModel.moveSelectionDown(),S.reorder()})}}},{button:{icon:"editor.bottom",toolTip:l("editor.sendtoback"),onClicked:function(){S.tableView.sm().size()&&S.modifyDataBindings(function(){S.tableModel.moveSelectionToBottom(),S.reorder()})}}}],[20,20,20,.1,20,20,20,20])},P}(Rp),vp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p,"data"))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$28$()},P.prototype.isTitleVisible=function(P){return!!this.inspectorFilter.isDataTitleVisible(this.editor,this.data,P.title)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){return!!this.inspectorFilter.isDataPropertyVisible(this.editor,this.data,P.keys&&P.keys.accessType,P.keys&&P.keys.name)&&S.prototype.isPropertyVisible.call(this,P)},P.prototype.addDBRow=function(S,P,E,p,l){var _=this,m=l?this.getRowHeight()*l:null,u=S.length,F=void 0;if(!rP.config.dataBindings||rP.config.dataBindings.filter&&!rP.config.dataBindings.filter(P,E))2===u?F=this.addRow(S,[rP.config.indent,.1],m,p):3===u?F=this.addRow(S,[rP.config.indent,.1,20],m,p):4===u?F=this.addRow(S,[rP.config.indent,.1,20,20],m,p):5===u&&(F=this.addRow(S,[rP.config.indent,.1,20,20,20],m,p));else{var f=function(){rP.config.dataBindings.onButtonClicked(_.data,P,E)},H=P+":"+E,T=this.addButton(S,null,H,null,f,!0);this.updateHandlers.push(function(){if(!S.hidden&&_.data){var p=rP.config.isDataBound(_.data,P,E);T.setIcon(p?"editor.bind.state":"editor.unbind.state")}}),2===u?F=this.addRow(S,[rP.config.indent,.1,20],m,p):3===u?F=this.addRow(S,[rP.config.indent,.1,20,20],m,p):4===u?F=this.addRow(S,[rP.config.indent,.1,20,20,20],m,p):5===u&&(F=this.addRow(S,[rP.config.indent,.1,20,20,20,20],m,p))}return F.keys={name:E,displayName:this.toDisplayName(S),accessType:P},!this.addingCustomProperties&&EE[this.type][P+":"+E]&&this.removeRows([F]),F},P.prototype.addDBInput=function(S,P,E,p,l){var _=[];return this.addLabelInput(_,P,H(S,E),T(S,E),p,l),this.addDBRow(_,S,E)},P.prototype.addDBLabel=function(S,P,E){var p=[];return this.addLabelLabel(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBCheckBox=function(S,P,E){var p=[];return this.addLabelCheckBox(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBImage=function(S,P,E){var p=[];return this.addLabelImage(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBColor=function(S,P,E){var p=[];return this.addLabelColor(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBFont=function(S,P,E){var p=[];return this.addLabelFont(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBPattern=function(S,P,E){var p=[];return this.addLabelInput(p,P,H(S,E),T(S,E),"pattern"),this.addDBRow(p,S,E)},P.prototype.addDBRotation=function(S,P,E){var p=[];return this.addLabelRotation(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBAlign=function(S,P,E){var p=[];return this.addLabelAlign(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBVAlign=function(S,P,E){var p=[];return this.addLabelVAlign(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBOrientation=function(S,P,E){var p=[];return this.addOrientation(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBComboBox=function(S,P,E,p,l,_){var m=[];return this.addLabelComboBox(m,P,H(S,E),T(S,E),p,l,_),this.addDBRow(m,S,E)},P.prototype.addDBStretch=function(S,P,E){var p=[];return this.addLabelStretch(p,P,H(S,E),T(S,E)),this.addDBRow(p,S,E)},P.prototype.addDBZeroToOne=function(S,P,E){var p=[];return this.addLabelRange(p,P,H(S,E),T(S,E),0,1,.01,"number"),this.addDBRow(p,S,E)},P.prototype.addDBPosition=function(S,P,E){var p=[];return this.addLabelRange(p,P,H(S,E),T(S,E),1,55,1,"int"),this.addDBRow(p,S,E)},P.prototype.addDBRange=function(S,P,E,p,l,_,m){var u=[];return this.addLabelRange(u,P,H(S,E),T(S,E),p,l,_,m),this.addDBRow(u,S,E)},P.prototype.addDBGradient=function(S,P,E,p){var l=[];return this.addLabelGradient(l,S,P,E,p),this.addDBRow(l,"s",P)},P.prototype.addDBBodyColorProperty=function(){this.addDBColor("s",l("editor.bodycolor"),"body.color")},P.prototype.addDBOpacityProperty=function(){this.addDBZeroToOne("s",l("editor.opacity"),"opacity")},P.prototype.$84$=function(){var S=this,P=[];this.addLabel(P,l("editor.icons"));var E=function(){S.data&&S.editor.iconsView.toggle(p,S.data)},p=this.addButton(P,"Icons","s:icons",null,E,!0);return this.updateHandlers.push(function(){P.hidden||p.setLabelColor(S.data.s("icons")?rP.config.color_select:ht.Default.labelColor)}),this.addDBRow(P,"s","icons")},P.prototype.addDBData=function(S,P,E,p){var l=this;p=p||T(S,E);var _=H(S,E),m=[],u=this.addLabelInput(m,P,function(S){var P=_(S);return P?P.toLabel()||P.getClassName():""}),F=u.getElement();u.isDroppable=function(S,P){return P.view.draggingData&&l.dataModel===P.view.draggingData.getDataModel()},u.handleCrossDrag=function(S,P,E){"enter"===P?F.style.border="solid "+rP.config.color_select_dark+" 2px":"exit"===P||"cancel"===P?F.style.border="":"over"===P||"drop"===P&&(F.style.border="",l.setValue(p,E.view.draggingData),u.setFocus())},F.onkeydown=function(S){s(S)&&l.setValue(p,null)};var f=new ht.widget.Image;return f.drawImage=function(S,P,E,p,_,m){var u=f.data,F=l.editor.list;u&&F&&F.dm().contains(u)&&(P=F.getIcon(u))&&o(S,ht.Default.getImage(P),"centerUniform",E,p,_,m,u,F)},this.updateHandlers.push(function(){if(!m.hidden){var S=f.data;f.data=l.getValue(_),f.fp("data",S,f.data)}}),m.push(f),this.addDBRow(m,S,E)},P.prototype.$28$=function(){this.addTitle("TitleBasic"),this.addEventProperties();var S=[];this.addLabelInput(S,l("editor.class"),function(S){return S.getClassName()}),this.addRow(S,[rP.config.indent,.1]).keys={accessType:"p",name:"className"},this.addDBInput("p",l("editor.name"),"displayName"),this.addDBInput("p",l("editor.tag"),"tag"),this.addDBImage("p",l("editor.icon"),"icon"),this.addDBData("p",l("editor.parent"),"parent")},P.prototype.$30$=function(){this.addTitle("TitleLabel"),this.addDBLabel("s",l("editor.content"),"label"),this.addDBFont("s",l("editor.font"),"label.font"),this.addDBColor("s",l("editor.color"),"label.color"),this.addDBColor("s",l("editor.background"),"label.background"),this.addDBPosition("s",l("editor.position"),"label.position"),this.addDBInput("s",l("editor.offsetx"),"label.offset.x","number",1),this.addDBInput("s",l("editor.offsety"),"label.offset.y","number",1),this.addDBInput("s",l("editor.maxlength"),"label.max","number",1),this.addDBRotation("s",l("editor.rotation"),"label.rotation"),this.addDBZeroToOne("s",l("editor.opacity"),"label.opacity"),this.addDBRange("s",l("editor.scale"),"label.scale",.01,100,.1,"number"),this.addDBAlign("s",l("editor.align"),"label.align"),this.addDBCheckBox("s",l("editor.fixed"),"label.position.fixed")},P.prototype.$31$=function(){this.addTitle("TitleNote"),this.addDBLabel("s",l("editor.content"),"note"),this.addDBFont("s",l("editor.font"),"note.font"),this.addDBColor("s",l("editor.color"),"note.color"),this.addDBColor("s",l("editor.background"),"note.background"),this.addDBInput("s",l("editor.borderwidth"),"note.border.width","number",1),this.addDBColor("s",l("editor.bordercolor"),"note.border.color"),this.addDBPosition("s",l("editor.position"),"note.position"),this.addDBInput("s",l("editor.offsetx"),"note.offset.x","number",1),this.addDBInput("s",l("editor.offsety"),"note.offset.y","number",1),this.addDBZeroToOne("s",l("editor.opacity"),"note.opacity"),this.addDBRange("s",l("editor.scale"),"note.scale",.01,100,.1,"number"),this.addDBInput("s",l("editor.maxlength"),"note.max","number",1),this.addDBAlign("s",l("editor.align"),"note.align"),this.addDBCheckBox("s",l("editor.toggleable"),"note.toggleable"),this.addDBCheckBox("s",l("editor.expanded"),"note.expanded")},P.prototype.addDBLayer=function(){var S=this,P=[],E=H("p","layer"),p=T("p","layer");this.addLabel(P,l("editor.layer"),E,p);var _=new ht.widget.ComboBox;_.onValueChanged=function(){S.setValue(p,_.getValue())},this.updateHandlers.push(function(){if(!P.hidden){_.setValues(S.editor.layerPane.layerNames);var p=S.getValue(E);_.getValue()!==p&&_.setValue(p)}}),P.push(_);var m=this.addDBRow(P,"p","layer");return m.items.tag="layer",m},P}(Rp),Bp={TitleShapeBackground:!0,TitleShapeBorder:!0,TitleShapeDash:!0},Kp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$28$(),this.$92$(),this.$23$(),this.$29$(),this.$30$(),this.$31$(),this.$26$()},P.prototype.$28$=function(){S.prototype.$28$.call(this),this.addDBLayer(),this.addDBInput("p",l("editor.tooltip"),"toolTip"),this.addDBBodyColorProperty(),this.addDBOpacityProperty(),this.$84$()},P.prototype.$92$=function(){var S=this;this.addDBStretch("s",l("editor.stretch"),"image.stretch").items.tag="imageRelative",this.addDBComboBox("s",l("editor.shape"),"shape",rP.consts.shapes,rP.consts.shapeLabels,rP.consts.shapeIcons);var P=[];this.addLabelImage(P,l("editor.image"),function(P){var E=P.getImage(),p=ht.Default.getImage(E);return S.$86$(HS(p)?p.dataBindings:null,p),E},function(S,P){S.setImage&&(fS(P)&&P.endsWith("[...]")||S.setImage(P))}),this.addButton(P,null,l("editor.resetsize"),"editor.resetsize.state",function(S){S instanceof ht.Node&&S.setSize(-1,-1)}),this.imageRow=this.addDBRow(P,"p","image"),this.imageRow.items.tag="imageRelative"},P.prototype.$23$=function(){this.addTitle("TitleNode"),this.addDBInput("p",l("editor.posx"),"x","number",1),this.addDBInput("p",l("editor.posy"),"y","number",1),this.addDBInput("p",l("editor.width"),"width","number",1),this.addDBInput("p",l("editor.height"),"height","number",1),this.addDBRotation("p",l("editor.rotation"),"rotation");var S=[];this.addLabelInput(S,l("editor.scalex"),H("p","scaleX"),T("p","scaleX"),"number",.01),this.addButton(S,null,l("editor.flipx"),"editor.flipx",function(S){S instanceof ht.Node&&S.setScaleX(-S.getScaleX())}),this.addDBRow(S,"p","scaleX"),S=[],this.addLabelInput(S,l("editor.scaley"),H("p","scaleY"),T("p","scaleY"),"number",.01),this.addButton(S,null,l("editor.flipy"),"editor.flipy",function(S){S instanceof ht.Node&&S.setScaleY(-S.getScaleY())}),this.addDBRow(S,"p","scaleY"),S=[],this.addLabelInput(S,l("editor.anchorx"),function(S){return S.getAnchor().x},function(S,P){S instanceof ht.Node&&S.setAnchor(P,S.getAnchor().y,!0)},"number",.01),this.addDBRow(S,"p","anchorX"),S=[],this.addLabelInput(S,l("editor.anchory"),function(S){return S.getAnchor().y},function(S,P){S instanceof ht.Node&&S.setAnchor(S.getAnchor().x,P,!0)},"number",.01),this.addDBRow(S,"p","anchorY"),this.$85$(),this.addDBData("p",l("editor.host"),"host",function(S,P){S instanceof ht.Node&&(null==P||P instanceof ht.Node)&&S.setHost(P)}),this.addDBComboBox("s",l("editor.movemode"),"2d.move.mode",[void 0,"x","y"],["",l("editor.horizontal"),l("editor.vertical")]),this.addDBCheckBox("s",l("editor.ingroup"),"ingroup"),this.addDBCheckBox("s",l("editor.visible"),"2d.visible"),this.addDBCheckBox("s",l("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",l("editor.movable"),"2d.movable"),this.addDBCheckBox("s",l("editor.editable"),"2d.editable"),this.addDBCheckBox("s",l("editor.pixelperfect"),"pixelPerfect")},P.prototype.$85$=function(){this.addDBZeroToOne("s",l("editor.clippercentage"),"clip.percentage"),this.addDBComboBox("s",l("editor.clipdirection"),"clip.direction",rP.consts.clipDirections,rP.consts.clipDirectionLabels)},P.prototype.$29$=function(){this.$25$(),this.addShapeForegroundProperties(),this.$33$(),this.addShapeDashProperties()},P.prototype.$25$=function(){this.addTitle("TitleShapeBackground"),this.addDBColor("s",l("editor.background"),"shape.background"),this.addDBGradient(l("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color"),this.addDBColor("s",l("editor.gradientcolor"),"shape.gradient.color"),this.addDBImage("s",l("editor.repeatimage"),"shape.repeat.image"),this.addDBZeroToOne("s",l("editor.clippercentage"),"shape.fill.clip.percentage"),this.addDBComboBox("s",l("editor.clipdirection"),"shape.fill.clip.direction",rP.consts.clipDirections,rP.consts.clipDirectionLabels)},P.prototype.addShapeForegroundProperties=function(){this.addTitle("TitleShapeForeground"),this.addDBColor("s",l("editor.foreground"),"shape.foreground"),this.addDBGradient(l("editor.gradient"),"shape.foreground.gradient","shape.foreground","shape.foreground.gradient.color"),this.addDBColor("s",l("editor.gradientcolor"),"shape.foreground.gradient.color"),this.addDBZeroToOne("s",l("editor.clippercentage"),"shape.foreground.clip.percentage"),this.addDBComboBox("s",l("editor.clipdirection"),"shape.foreground.clip.direction",rP.consts.clipDirections,rP.consts.clipDirectionLabels)},P.prototype.$33$=function(){this.addTitle("TitleShapeBorder"),this.addDBInput("s",l("editor.width"),"shape.border.width","number",1),this.addDBCheckBox("s",l("editor.widthabsolute"),"shape.border.width.absolute"),this.addDBPattern("s",l("editor.pattern"),"shape.border.pattern"),this.addDBColor("s",l("editor.color"),"shape.border.color"),this.addDBCheckBox("s",l("editor.threed"),"shape.border.3d"),this.addDBColor("s",l("editor.threedcolor"),"shape.border.3d.color"),this.addDBComboBox("s",l("editor.join"),"shape.border.join",rP.consts.joins,rP.consts.joinLabels),this.addDBComboBox("s",l("editor.cap"),"shape.border.cap",rP.consts.caps,rP.consts.capLabels),this.$24$()},P.prototype.$24$=function(){this.addDBInput("s",l("editor.depth"),"shape.depth","int",1).items.tag="shapeDepth",this.addDBInput("s",l("editor.sides"),"shape.polygon.side","int",1).items.tag="shapeSide",this.addDBInput("s",l("editor.radius"),"shape.corner.radius","number",1).items.tag="shapeRadius",this.addDBCheckBox("s",l("editor.arcoval"),"shape.arc.oval").items.tag="shapeArc",this.addDBCheckBox("s",l("editor.closed"),"shape.arc.close").items.tag="shapeArc",this.addDBRotation("s",l("editor.arcfrom"),"shape.arc.from").items.tag="shapeArc",this.addDBRotation("s",l("editor.arcto"),"shape.arc.to").items.tag="shapeArc"},P.prototype.addShapeDashProperties=function(){this.addTitle("TitleShapeDash"),this.addDBPattern("s",l("editor.pattern"),"shape.dash.pattern"),this.addDBCheckBox("s",l("editor.dash"),"shape.dash"),this.addDBColor("s",l("editor.color"),"shape.dash.color"),this.addDBInput("s",l("editor.offset"),"shape.dash.offset","number",1),this.addDBInput("s",l("editor.width"),"shape.dash.width","number",1),this.addDBCheckBox("s",l("editor.threed"),"shape.dash.3d"),this.addDBColor("s",l("editor.threedcolor"),"shape.dash.3d.color")},P.prototype.$35$=function(P){if(P){if("s:shape"===P.property)return void this.filterPropertiesLater();if("s:select.type"===P.property&&("shadow"===P.oldValue||"shadow"===P.newValue))return void this.filterPropertiesLater()}S.prototype.$35$.call(this,P)},P.prototype.isTitleVisible=function(P){return!(!(!this.data||this.data instanceof ht.Shape||this.data.s("shape"))&&Bp[P.title])&&S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){if(this.data){var E=P.items.tag;if(E)if("selectShadow"===E){if("shadow"!==this.data.s("select.type"))return!1}else if("shapeDepth"===E){if("rect"!==this.data.s("shape"))return!1}else if("shapeSide"===E){
if("polygon"!==this.data.s("shape"))return!1}else if("shapeRadius"===E){if("roundRect"!==this.data.s("shape"))return!1}else if("shapeArc"===E){if("arc"!==this.data.s("shape"))return!1}else if("imageRelative"===E){if(this.data.s("shape"))return!1}else if("layer"===E&&!this.editor.layerPane.layerNames.length)return!1}return S.prototype.isPropertyVisible.call(this,P)},P.prototype.$86$=function(S,P){var E=this;this.dataBindings!==S&&(this.$46$=S,this.pendingImage=P,this._updateDataBindingsLater||(this._updateDataBindingsLater=!0,requestAnimationFrame(function(){E.$87$()})))},P.prototype.$87$=function(){var S=this;if(this._updateDataBindingsLater=!1,this.dataBindings===this.$46$)return this.$46$=null,void(this.pendingImage=null);if(this._rows=this.$47$,this.removeRows(this.$45$),this.$45$=[],this.dataBindings=this.$46$,this.dataBindings){var P={},E={},p={};this.pendingImage.comps.forEach(function(S){if(pS(S.type)){var l=ht.Default.getCompType(S.type);if(l)for(var _ in l.properties)P[_]=l.properties[_].defaultValue}US(S,E,p)});for(var l in E)void 0===p[l]&&(p[l]=P[E[l]]);var _=this._rows.indexOf(this.imageRow)+1;this.dataBindings.forEach(function(P){S.$88$(P,_,p)&&_++})}this.$47$=this._rows,this.filterProperties()},P.prototype.$88$=function(S,P,E){var p=[],_=S.attr,m=rP.config.valueTypes[S.valueType];if(!m)return this.editor.fireEvent("error",{message:"Wrong value type:"+S.valueType}),!1;var u=l(S.name)||_,F=function(S){var P=S.a(_);return void 0===P&&(P=E[_]),P},f=function(S,P){S.a(_,P)};return"int"===m.type||"number"===m.type?m.angle?this.addLabelRotation(p,u,F,f,m.min,m.max,m.step):this.addLabelRange(p,u,F,f,m.min,m.max,m.step,m.type):"color"===m.type?this.addLabelColor(p,u,F,f):"boolean"===m.type?this.addLabelCheckBox(p,u,F,f):"enum"===m.type?this.addLabelComboBox(p,u,F,f,m.values,m.labels,m.icons):"multiline"===m.type?this.addLabelMultiline(p,u,F,f):"font"===m.type?this.addLabelFont(p,u,F,f):"image"===m.type?this.addLabelImage(p,u,F,f):"url"===m.type?this.addLabelURL(p,u,F,f):"colorArray"===m.type?this.addLabelArray(p,u,F,f,"color"):"numberArray"===m.type?this.addLabelArray(p,u,F,f,"number"):"stringArray"===m.type?this.addLabelArray(p,u,F,f,"string"):"objectArray"===m.type?this.addLabelArray(p,u,F,f,"object"):"function"===m.type?this.addLabelFunction(p,u,F,f,_):"object"===m.type?this.addLabelObject(p,u,F,f,_):this.addLabelInput(p,u,F,f),this.$45$.push(this.addDBRow(p,"a",_,{index:P},m.rows)),p.tag="imageRelative",!0},P.prototype.$26$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",l("editor.color"),"select.color"),this.addDBInput("s",l("editor.width"),"select.width","number",1),this.addDBInput("s",l("editor.padding"),"select.padding","number",1),this.addDBComboBox("s",l("editor.selecttype"),"select.type",rP.consts.selectTypes,rP.consts.selectTypeLabels,rP.consts.selectTypeIcons),this.addDBInput("s",l("editor.shadowblur"),"shadow.blur","number",1).items.tag="selectShadow",this.addDBInput("s",l("editor.shadowoffsetx"),"shadow.offset.x","number",1).items.tag="selectShadow",this.addDBInput("s",l("editor.shadowoffsety"),"shadow.offset.y","number",1).items.tag="selectShadow"},P}(vp),Lp={"h.v":!0,"v.h":!0,ortho:!0,flex:!0,"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,ortho2:!0,flex2:!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0,"v.h2":!0,"h.v2":!0},ep={"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0},rp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.$27$(),S.prototype.initForm.call(this),this.$89$(),this.$90$(),this.$91$(),this.$30$(),this.$31$(),this.$26$()},P.prototype.isTitleVisible=function(P){return!("TitleEditingPoint"===P.title&&!this.editor.pointsEditingMode)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.$35$=function(P){if(P&&"s:edge.type"===P.property)return void this.filterPropertiesLater();S.prototype.$35$.call(this,P)},P.prototype.isPropertyVisible=function(P){if(this.data){var E=P.items.tag;if(E){var p=this.data.s("edge.type");if("edgeRipple"===E){if("ripple"!==p)return!1}else if("edgeRadius"===E){if(!Lp[p])return!1}else if("edgeOrtho"===E){if("ortho"!==p&&"ortho2"!==p)return!1}else if("edgeFlex"===E){if("flex"!==p&&"flex2"!==p)return!1}else if("edgeExtend"===E){if(!ep[p])return!1}else if("layer"===E&&!this.editor.layerPane.layerNames.length)return!1}}return S.prototype.isPropertyVisible.call(this,P)},P.prototype.$28$=function(){S.prototype.$28$.call(this),this.addDBLayer(),this.addDBInput("p",l("editor.tooltip"),"toolTip"),this.addDBOpacityProperty(),this.$84$()},P.prototype.$26$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",l("editor.color"),"select.color"),this.addDBInput("s",l("editor.width"),"select.width","number",1);var S=[];this.addLabelCheckBox(S,l("editor.shadow"),function(S){return"shadow"===S.s("select.type")},function(S,P){S.s("select.type",P?"shadow":null)}),this.addDBRow(S,"s","select.type"),this.addDBInput("s",l("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",l("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",l("editor.shadowoffsety"),"shadow.offset.y","number",1)},P.prototype.$89$=function(){this.addTitle("TitleEdgeBasic"),this.addDBInput("s",l("editor.width"),"edge.width","number",1),this.addDBCheckBox("s",l("editor.widthabsolute"),"edge.width.absolute"),this.addDBPattern("s",l("editor.pattern"),"edge.pattern"),this.addDBColor("s",l("editor.color"),"edge.color"),this.addDBCheckBox("s",l("editor.threed"),"edge.3d"),this.addDBColor("s",l("editor.threedcolor"),"edge.3d.color"),this.addDBComboBox("s",l("editor.join"),"edge.join",rP.consts.joins,rP.consts.joinLabels),this.addDBComboBox("s",l("editor.cap"),"edge.cap",rP.consts.caps,rP.consts.capLabels),this.addDBInput("s",l("editor.group"),"edge.group"),this.addDBInput("s",l("editor.offset"),"edge.offset","number",1),this.addDBInput("s",l("editor.gap"),"edge.gap","number",1),this.addDBComboBox("s",l("editor.type"),"edge.type",rP.consts.edgeTypes),this.addDBInput("s",l("editor.radius"),"edge.corner.radius","number",1).items.tag="edgeRadius",this.addDBZeroToOne("s",l("editor.ortho"),"edge.ortho").items.tag="edgeOrtho",this.addDBInput("s",l("editor.flex"),"edge.flex","number",1).items.tag="edgeFlex",this.addDBInput("s",l("editor.extend"),"edge.extend","number",1).items.tag="edgeExtend",this.addDBInput("s",l("editor.ripplesize"),"edge.ripple.size","int",1).items.tag="edgeRipple",this.addDBInput("s",l("editor.ripplelength"),"edge.ripple.length","number",1).items.tag="edgeRipple",this.addDBInput("s",l("editor.rippleelevation"),"edge.ripple.elevation","number",1).items.tag="edgeRipple",this.addDBCheckBox("s",l("editor.rippleboth"),"edge.ripple.both").items.tag="edgeRipple",this.addDBCheckBox("s",l("editor.ripplestraight"),"edge.ripple.straight").items.tag="edgeRipple",this.addDBCheckBox("s",l("editor.center"),"edge.center"),this.addDBCheckBox("s",l("editor.ingroup"),"ingroup"),this.addDBCheckBox("s",l("editor.visible"),"2d.visible"),this.addDBCheckBox("s",l("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",l("editor.editable"),"2d.editable"),this.addDBCheckBox("s",l("editor.independent"),"edge.independent"),this.addDBCheckBox("s",l("editor.toggleable"),"edge.toggleable");var S=[],P=function(S,P){S instanceof ht.Edge&&S.toggle()};P.once=!0,this.addLabelCheckBox(S,l("editor.expanded"),function(S){return S.s("edge.expanded")},P),this.addDBRow(S,"s","edge.expanded")},P.prototype.$91$=function(){this.addTitle("TitleEdgeDash"),this.addDBCheckBox("s",l("editor.dash"),"edge.dash"),this.addDBPattern("s",l("editor.pattern"),"edge.dash.pattern"),this.addDBColor("s",l("editor.color"),"edge.dash.color"),this.addDBInput("s",l("editor.offset"),"edge.dash.offset","number",1),this.addDBInput("s",l("editor.width"),"edge.dash.width","number",1),this.addDBCheckBox("s",l("editor.threed"),"edge.dash.3d"),this.addDBColor("s",l("editor.threedcolor"),"edge.dash.3d.color")},P.prototype.$90$=function(){this.addTitle("TitleEdgeEndpoint"),this.addDBData("p",l("editor.sourcenode"),"source",function(S,P){S instanceof ht.Edge&&(null==P||P instanceof ht.Node)&&S.setSource(P)}),this.addDBData("p",l("editor.targetnode"),"target",function(S,P){S instanceof ht.Edge&&(null==P||P instanceof ht.Node)&&S.setTarget(P)}),this.addDBPosition("s",l("editor.sourceposition"),"edge.source.position"),this.addDBInput("s",l("editor.sourceoffsetx"),"edge.source.offset.x","number",1),this.addDBInput("s",l("editor.sourceoffsety"),"edge.source.offset.y","number",1),this.addDBInput("s",l("editor.sourceanchorx"),"edge.source.anchor.x","number",.01),this.addDBInput("s",l("editor.sourceanchory"),"edge.source.anchor.y","number",.01),this.addDBPosition("s",l("editor.targetposition"),"edge.target.position"),this.addDBInput("s",l("editor.targetoffsetx"),"edge.target.offset.x","number",1),this.addDBInput("s",l("editor.targetoffsety"),"edge.target.offset.y","number",1),this.addDBInput("s",l("editor.targetanchorx"),"edge.target.anchor.x","number",.01),this.addDBInput("s",l("editor.targetanchory"),"edge.target.anchor.y","number",.01)},P}(vp),qp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$28$(),this.$92$(),this.$23$(),this.$32$(),this.$94$(),this.$93$(),this.$29$(),this.$30$(),this.$31$(),this.$26$()},P.prototype.$35$=function(P){if(P&&"s:group.type"===P.property)return void this.filterPropertiesLater();S.prototype.$35$.call(this,P)},P.prototype.isTitleVisible=function(P){return(!this.data||!this.data.s("group.type")||"TitleGroupTitle"!==P.title)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){if(this.data){var E=P.items.tag;if(E&&"groupDepth"===E){var p=this.data.s("group.type");if(p&&"rect"!==p)return!1}}return S.prototype.isPropertyVisible.call(this,P)},P.prototype.$32$=function(){this.addTitle("TitleGroupBasic"),this.addDBComboBox("s",l("editor.type"),"group.type",[void 0,"rect","oval","circle","roundRect"],["",l("editor.grouptype.rect"),l("editor.grouptype.oval"),l("editor.grouptype.circle"),l("editor.grouptype.roundrect")]),this.addDBPosition("s",l("editor.position"),"group.position"),this.addDBColor("s",l("editor.background"),"group.background"),this.addDBGradient(l("editor.gradient"),"group.gradient","group.background","group.gradient.color"),this.addDBColor("s",l("editor.gradientcolor"),"group.gradient.color"),this.addDBImage("s",l("editor.image"),"group.image"),this.addDBStretch("s",l("editor.stretch"),"group.image.stretch"),this.addDBImage("s",l("editor.repeatimage"),"group.repeat.image"),this.addDBCheckBox("s",l("editor.toggleable"),"group.toggleable"),this.addDBCheckBox("p",l("editor.expanded"),"expanded"),this.addDBInput("s",l("editor.depth"),"group.depth","number",1).items.tag="groupDepth"},P.prototype.$94$=function(){this.addTitle("TitleGroupTitle"),this.addDBLabel("s",l("editor.content"),"label"),this.addDBFont("s",l("editor.font"),"group.title.font"),this.addDBColor("s",l("editor.color"),"group.title.color"),this.addDBColor("s",l("editor.background"),"group.title.background"),this.addDBAlign("s",l("editor.align"),"group.title.align"),this.addDBOrientation("s",l("editor.valuetype.orientation"),"group.title.orientation"),this.addDBCheckBox("s","\u5206\u5272\u7ebf","group.splitLine")},P.prototype.$93$=function(){this.addTitle("TitleGroupBorder"),this.addDBInput("s",l("editor.width"),"group.border.width","number",1),this.addDBPattern("s",l("editor.pattern"),"group.border.pattern"),this.addDBColor("s",l("editor.color"),"group.border.color"),this.addDBComboBox("s",l("editor.join"),"group.border.join",rP.consts.joins,rP.consts.joinLabels),this.addDBComboBox("s",l("editor.cap"),"group.border.cap",rP.consts.caps,rP.consts.capLabels),this.addDBInput("s",l("editor.radius"),"group.border.radius","number",1),this.addDBInput("s",l("editor.padding"),"group.padding","number",1),this.addDBInput("s",l("editor.paddingleft"),"group.padding.left","number",1),this.addDBInput("s",l("editor.paddingright"),"group.padding.right","number",1),this.addDBInput("s",l("editor.paddingtop"),"group.padding.top","number",1),this.addDBInput("s",l("editor.paddingbottom"),"group.padding.bottom","number",1)},P}(Kp),Op=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.$27$(),this.addCustomProperties(),this.$28$(),this.$23$(),this.$29$(),this.$30$(),this.$31$(),this.$26$()},P.prototype.isTitleVisible=function(P){return!("TitleEditingPoint"===P.title&&!this.editor.pointsEditingMode)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.$24$=function(){this.addDBCheckBox("p",l("editor.closed"),"closePath"),this.addDBColor("s",l("editor.outlinecolor"),"border.color"),this.addDBInput("s",l("editor.outlinewidth"),"border.width","number",1)},P.prototype.$25$=function(){S.prototype.$25$.call(this),this.addDBComboBox("s",l("editor.fillrule"),"shape.fill.rule",rP.consts.fillRules,rP.consts.fillRuleLabels)},P.prototype.$26$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",l("editor.color"),"select.color"),this.addDBInput("s",l("editor.width"),"select.width","number",1);var S=[];this.addLabelCheckBox(S,l("editor.shadow"),function(S){return"shadow"===S.s("select.type")},function(S,P){S.s("select.type",P?"shadow":null)}),this.addDBRow(S,"s","select.type"),this.addDBInput("s",l("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",l("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",l("editor.shadowoffsety"),"shadow.offset.y","number",1)},P}(Kp),dp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.$23$=function(){S.prototype.$23$.call(this),this.addDBCheckBox("p",l("editor.clickthroughenabled"),"clickThroughEnabled");var P=[];this.addLabelCheckBox(P,l("editor.syncsize"),function(S){return S.isSyncSize()},function(S,P){S instanceof ht.Block&&(S.setSyncSize(P),S instanceof ht.RefGraph&&(S.p(0,0),S.setRotation(0),S.setAnchor(.5,.5),S.setScale(1,1),S.setSize(20,20),S.setRef(S.getRef())))}),this.addDBRow(P,"p","syncSize")},P.prototype.addDBBodyColorProperty=function(){},P.prototype.addDBOpacityProperty=function(){},P.prototype.$92$=function(){},P.prototype.$29$=function(){},P.prototype.$85$=function(){},P}(Kp),Ap=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.$28$=function(){S.prototype.$28$.call(this),this.addDBRef()},P.prototype.addDBRef=function(){var S=this,P=[],E=function(S){return S.getRef()},p=function(S,P){S instanceof ht.RefGraph&&(S.p(0,0),S.setRotation(0),S.setAnchor(.5,.5),S.setScale(1,1),S.setSize(20,20),S.setRef(P))},_=function(P,E){var p=E.view.draggingData;return!!p&&(S.editor.url!==p.url&&p.fileType===CP)};return this.addLabelURL(P,l("editor.ref"),E,p,_),this.addDBRow(P,"p","ref")},P}(dp),Np=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$28$(),this.$22$(),this.$23$(),this.$26$()},P.prototype.$22$=function(){this.addTitle("TitleText"),this.addDBInput("s",l("editor.content"),"text"),this.addDBAlign("s",l("editor.align"),"text.align"),this.addDBVAlign("s",l("editor.valign"),"text.vAlign"),this.addDBColor("s",l("editor.color"),"text.color"),this.addDBFont("s",l("editor.font"),"text.font"),this.addDBCheckBox("s",l("editor.shadow"),"text.shadow"),this.addDBColor("s",l("editor.shadowcolor"),"text.shadow.color"),this.addDBInput("s",l("editor.shadowblur"),"text.shadow.blur","number",1),this.addDBInput("s",l("editor.shadowoffsetx"),"text.shadow.offset.x","number",1),this.addDBInput("s",l("editor.shadowoffsety"),"text.shadow.offset.y","number",1)},P}(Kp),Zp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p,"comp"))}return BP(P,S),P.prototype.initForm=function(){this.addCustomProperties(),this.$12$(),this.$20$()},P.prototype.isTitleVisible=function(P){return!!this.inspectorFilter.isCompTitleVisible(this.editor,this.data?this.data.compType:null,P.title)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){return!!this.inspectorFilter.isCompPropertyVisible(this.editor,this.data?this.data.compType:null,P.keys&&P.keys.name)&&S.prototype.isPropertyVisible.call(this,P)},P.prototype.$12$=function(){this.addTitle("TitleBasic"),this.addEventProperties(),this.$14$(),this.$15$(),this.$13$(),this.$21$(),this.$16$(),this.$17$(),this.$18$(),this.$19$(),this.addStyleCheckBox(l("editor.visible"),"2d.visible","visible"),this.addStyleCheckBox(l("editor.selectable"),"2d.selectable","selectable"),this.addStyleCheckBox(l("editor.movable"),"2d.movable","movable"),this.addStyleCheckBox(l("editor.editable"),"2d.editable","editable"),this.addStyleCheckBox(l("editor.pixelperfect"),"comp.pixelPerfect","pixelPerfect"),this.addStyleZeroToOne(l("editor.opacity"),"opacity","opacity")},P.prototype.$13$=function(){var S=[];this.addLabelInput(S,l("editor.area"),function(S){return"["+p(S.p().x-S.getWidth()*S.getAnchor().x)+","+p(S.p().y-S.getHeight()*S.getAnchor().y)+","+p(S.getWidth())+","+p(S.getHeight())+"]"}),this.addFuncRow(S,"rect")},P.prototype.$14$=function(){var S=[];this.addLabelInput(S,l("editor.type"),function(S){return S.compType}),this.addRow(S,[rP.config.indent,.1]).keys={name:"type"}},P.prototype.$15$=function(){var S=[];this.addLabelInput(S,l("editor.name"),function(S){return S.getDisplayName()},function(S,P){S.setDisplayName(P)}),this.addFuncRow(S,"displayName")},P.prototype.$16$=function(){var S=[];this.addLabelInput(S,l("editor.rotation"),function(S){return 180/Math.PI*S.getRotation()},function(S,P){S instanceof ht.Node&&S.setRotation(P*Math.PI/180)},"number",1),this.addFuncRow(S,"rotation")},P.prototype.$17$=function(){var S=[];this.addLabelInput(S,l("editor.anchorx"),function(S){return S.getAnchor().x},function(S,P){S instanceof ht.Node&&S.setAnchor(P,S.getAnchor().y,!0)},"number",.01),this.addFuncRow(S,"anchorX"),S=[],this.addLabelInput(S,l("editor.anchory"),function(S){return S.getAnchor().y},function(S,P){S instanceof ht.Node&&S.setAnchor(S.getAnchor().x,P,!0)},"number",.01),this.addFuncRow(S,"anchorY")},P.prototype.$18$=function(){var S=[];this.addLabelInput(S,l("editor.scalex"),function(S){return S.getScale().x},function(S,P){S instanceof ht.Node&&S.setScale(P,S.getScale().y)},"number",.01),this.addFuncRow(S,"scaleX"),S=[],this.addLabelInput(S,l("editor.scaley"),function(S){return S.getScale().y},function(S,P){S instanceof ht.Node&&S.setScale(S.getScale().x,P)},"number",.01),this.addFuncRow(S,"scaleY")},P.prototype.$19$=function(){this.addStyleZeroToOne(l("editor.clippercentage"),"clip.percentage","clipPercentage"),this.addStyleComboBox(l("editor.clipdirection"),"clip.direction",rP.consts.clipDirections,rP.consts.clipDirectionLabels,null,"clipDirection")},P.prototype.$20$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(l("editor.shadow"),"shadow","shadow"),this.addStyleColor(l("editor.shadowcolor"),"select.color","shadowColor"),this.addStyleInput(l("editor.shadowblur"),"shadow.blur","number",1,"shadowblur"),this.addStyleInput(l("editor.shadowoffsetx"),"shadow.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(l("editor.shadowoffsety"),"shadow.offset.y","number",1,"shadowOffsetYs")},P.prototype.$21$=function(){var S=[];return this.addLabelInput(S,l("editor.posx"),function(S){return S.p().x},function(S,P){S instanceof ht.Node&&S.p(P,S.p().y)},"number",1),this.addLabelInput(S,l("editor.posy"),function(S){return S.p().y},function(S,P){S instanceof ht.Node&&S.p(S.p().x,P)},"number",1),this.addRow(S,[rP.config.indent,.1,rP.config.indent2,.1]).keys={name:"position"},S=[],this.addLabelInput(S,l("editor.width"),function(S){return S.getWidth()},function(S,P){S instanceof ht.Node&&S.setWidth(P)},"number",1),this.addLabelInput(S,l("editor.height"),function(S){return S.getHeight()},function(S,P){S instanceof ht.Node&&S.setHeight(P)},"number",1),this.addRow(S,[rP.config.indent,.1,rP.config.indent2,.1]).keys={name:"size"},S},P.prototype.addStyleColor=function(S,P,E){var p=[];return this.addLabelColor(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(p,P,E)},P.prototype.addStyleFunction=function(S,P,E){var p=[];return this.addLabelFunction(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)},E),this.addFuncRow(p,P,E)},P.prototype.addStyleObject=function(S,P,E){var p=[];return this.addLabelObject(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)},E),this.addFuncRow(p,P,E)},P.prototype.addStyleLabel=function(S,P,E){var p=[];return this.addLabelInput(p,S,function(S){var E=S.s(P);return E&&E.replace&&(E=E.replace(/\n/g,"\\n")),E},function(S,E){E&&E.replace&&(E=E.replace(/\\n/g,"\n")),S.s(P,E)}),this.addFuncRow(p,P,E)},P.prototype.addStyleArray=function(S,P,E,p,l){var _=[];return this.addLabelArray(_,S,function(S){return S.s(P)},function(S,E){S.s(P,E)},p),this.addFuncRow(_,P,E,l)},P.prototype.addStyleMultiline=function(S,P,E,p){var l=[];return this.addLabelMultiline(l,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(l,P,E,p)},P.prototype.addStyleFont=function(S,P,E,p){var l=[];return this.addLabelFont(l,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(l,P,E,p)},P.prototype.addStyleTextArea=function(S,P,E,p){var l=[];return this.addLabelTextArea(l,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(l,P,p,E)},P.prototype.addStyleInput=function(S,P,E,p,l){var _=[];return this.addLabelInput(_,S,function(S){return S.s(P)},function(S,E){S.s(P,E)},E,p),this.addFuncRow(_,P,l)},P.prototype.addStyleCheckBox=function(S,P,E){var p=[];return this.addLabelCheckBox(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(p,P,E)},P.prototype.addStyleAlign=function(S,P,E){var p=[];return this.addLabelComboBox(p,S,function(S){return S.s(P)||"center"},function(S,E){S.s(P,E)},["left","center","right"],[l("editor.align.left"),l("editor.align.center"),l("editor.align.right")]),this.addFuncRow(p,P,E)},P.prototype.addStyleVAlign=function(S,P,E){var p=[];return this.addLabelComboBox(p,S,function(S){return S.s(P)||"bottom"},function(S,E){S.s(P,E)},["top","middle","bottom"],[l("editor.valign.top"),l("editor.valign.middle"),l("editor.valign.bottom")]),this.addFuncRow(p,P,E)},P.prototype.addStyleStretch=function(S,P,E){var p=[];return this.addLabelComboBox(p,S,function(S){return S.s(P)||"fill"},function(S,E){S.s(P,E)},["fill","uniform","centerUniform"],[l("editor.stretch.fill"),l("editor.stretch.uniform"),l("editor.stretch.centeruniform")]),this.addFuncRow(p,P,E)},P.prototype.addStyleComboBox=function(S,P,E,p,l,_){var m=[];return this.addLabelComboBox(m,S,function(S){return S.s(P)},function(S,E){S.s(P,E)},E,p,l),this.addFuncRow(m,P,_)},P.prototype.addStyleImage=function(S,P,E){var p=[];return this.addLabelImage(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(p,P,E)},P.prototype.addStyleURL=function(S,P,E){var p=[];return this.addLabelURL(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)}),this.addFuncRow(p,P,E)},P.prototype.addStylePattern=function(S,P,E){var p=[];return this.addLabelInput(p,S,function(S){return S.s(P)},function(S,E){S.s(P,E)},"pattern"),this.addFuncRow(p,P,E)},P.prototype.addStyleZeroToOne=function(S,P,E){return this.addStyleRange(S,P,0,1,.01,E)},P.prototype.addStylePosition=function(S,P,E){return this.addStyleRange(S,P,1,55,1,E)},P.prototype.addStyleRange=function(S,P,E,p,l,_){var m=[];return this.addLabelInput(m,S,function(S){var E=S.s(P);return null==E?p:E},function(S,l){void 0!==p&&l>p&&(l=p),void 0!==E&&l<E&&(l=E),S.s(P,l)},"number",l),this.addFuncRow(m,P,_)},P.prototype.addStyleRotation=function(S,P,E,p,l,_){var m=[];return this.addLabelInput(m,S,function(S){var E=S.s(P);return null==E?l:180/Math.PI*E},function(S,E){E=E*Math.PI/180,void 0!==l&&E>l&&(E=l),void 0!==p&&E<p&&(E=p),S.s(P,E)},"number",_||1),this.addFuncRow(m,P,E)},P.prototype.addStyleGradient=function(S,P,E,p,l){var _=[];return this.addLabelGradient(_,S,P,E,p),this.addFuncRow(_,P,l)},P}(Rp),Cp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.$35$=function(P){if(P&&"s:shape"===P.property)return void this.filterPropertiesLater();S.prototype.$35$.call(this,P)},P.prototype.isTitleVisible=function(P){if(this.data){var E=this.data.s("shape");if("TitleArc"===P.title&&"arc"!==E)return!1}return S.prototype.isTitleVisible.call(this,P)},P.prototype.isPropertyVisible=function(P){if(this.data){var E=P.items.tag;if(E){var p=this.data.s("shape");if("shapeDepth"===E&&"rect"!==p)return!1;if("shapeCornerRadius"===E&&"roundRect"!==p)return!1;if("shapePolygonSide"===E&&"polygon"!==p)return!1}}return S.prototype.isPropertyVisible.call(this,P)},P.prototype.initForm=function(){S.prototype.initForm.call(this),this.$37$(),this.$38$(),this.addDashProperties(),this.addArcProperties()},P.prototype.$14$=function(){this.addStyleComboBox(l("editor.type"),"shape",rP.consts.shapes.slice(1),rP.consts.shapeLabels.slice(1),rP.consts.shapeIcons.slice(1),"type")},P.prototype.$37$=function(){this.addTitle("TitleBackground"),this.addStyleColor(l("editor.background"),"shape.background","background"),this.addStyleImage(l("editor.repeatimage"),"shape.repeat.image","repeatImage"),this.addStyleGradient(l("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color","gradient"),this.addStyleColor(l("editor.gradientcolor"),"shape.gradient.color","gradientColor"),this.addStyleZeroToOne(l("editor.clippercentage"),"shape.fill.clip.percentage","fillClipPercentage"),this.addStyleComboBox(l("editor.clipdirection"),"shape.fill.clip.direction",rP.consts.clipDirections,rP.consts.clipDirectionLabels,null,"fillClipDirection")},P.prototype.$38$=function(){this.addTitle("TitleBorder"),this.addStyleInput(l("editor.width"),"shape.border.width","number",1,"borderWidth"),this.addStyleCheckBox(l("editor.widthabsolute"),"shape.border.width.absolute","borderWidthAbsolute"),this.addStyleColor(l("editor.color"),"shape.border.color","borderColor"),this.addStylePattern(l("editor.pattern"),"shape.border.pattern","borderPattern"),this.addStyleCheckBox(l("editor.threed"),"shape.border.3d","border3d"),this.addStyleColor(l("editor.threedcolor"),"shape.border.3d.color","border3dColor"),this.addStyleComboBox(l("editor.cap"),"shape.border.cap",rP.consts.caps,rP.consts.capLabels,null,"borderCap"),this.addStyleComboBox(l("editor.join"),"shape.border.join",rP.consts.joins,rP.consts.joinLabels,null,"borderJoin"),this.addStyleInput(l("editor.depth"),"shape.depth","int",1,"depth").items.tag="shapeDepth",this.addStyleInput(l("editor.radius"),"shape.corner.radius","number",1,"cornerRadius").items.tag="shapeCornerRadius",this.addStyleInput(l("editor.sides"),"shape.polygon.side","int",1,"polygonSide").items.tag="shapePolygonSide"},P.prototype.addDashProperties=function(){this.addTitle("TitleDash"),this.addStyleCheckBox(l("editor.dash"),"shape.dash","dash"),this.addStylePattern(l("editor.pattern"),"shape.dash.pattern","dashPattern"),this.addStyleColor(l("editor.color"),"shape.dash.color","dashColor"),this.addStyleInput(l("editor.offset"),"shape.dash.offset","number",1,"dashOffset"),this.addStyleInput(l("editor.width"),"shape.dash.width","number",1,"dashWidth"),this.addStyleCheckBox(l("editor.threed"),"shape.dash.3d","dash3d"),this.addStyleColor(l("editor.threedcolor"),"shape.dash.3d.color","dash3dColor")},P.prototype.addArcProperties=function(){this.addTitle("TitleArc"),this.addStyleCheckBox(l("editor.arcoval"),"shape.arc.oval","arcOval"),this.addStyleCheckBox(l("editor.closed"),"shape.arc.close","arcClose"),this.addStyleRotation(l("editor.arcfrom"),"shape.arc.from","arcFrom"),this.addStyleRotation(l("editor.arcto"),"shape.arc.to","arcTo")},P}(Zp),op=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addTitle("TitleImage");var P=[];this.addLabelImage(P,l("editor.name"),function(S){return S.s("image")},function(S,P){fS(P)&&P.endsWith("[...]")||S.s("image",P)}),this.addButton(P,null,l("editor.resetsize"),"editor.resetsize.state",function(S){S instanceof ht.Node&&S.setSize(-1,-1)}),this.addFuncRow(P,"image","name"),this.addStyleColor(l("editor.color"),"body.color","color"),this.addStyleStretch(l("editor.stretch"),"image.stretch","stretch")},P}(Zp),Dp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.$44$()},P.prototype.$44$=function(){this.addTitle("TitleBorder"),this.addStyleInput(l("editor.width"),"border_width","number",1,"border"),this.addStyleColor(l("editor.color"),"border_color","color")},P}(Zp),yp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addBasicChartProperties()},P.prototype.addBasicChartProperties=function(){this.addTitle("TitleChart"),this.addStyleCheckBox(l("editor.text"),"chart.label","label"),this.addStyleColor(l("editor.color"),"chart.label.color","labelColor"),this.addStyleFont(l("editor.font"),"chart.label.font","labelFont")},P}(Zp),Ip=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addPieChartProperties()},P.prototype.addBasicChartProperties=function(){S.prototype.addBasicChartProperties.call(this),this.addStyleRotation(l("editor.rotation"),"chart.start.angle","startAngle"),this.addStyleCheckBox(l("editor.hollow"),"chart.hollow","hollow")},P.prototype.createChartIndexColumn=function(S){var P=this;return{name:S,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(S){return"chart.values"===S.getTag()?"number":"color"},getValue:function(E){if(P.data){var p=P.data.s(E.getTag());return p?p[S]:void 0}},setValue:function(E,p,l,_){var m=E.getTag(),u=function(P,E){var p=IS(P.s(m));p[S]=E,"chart.values"===m?DS(p):yS(p),P.s(m,p)};P.setValue(u,l)}}},P.prototype.addPieChartProperties=function(){var S=this,P=this.tableModel=new ht.DataModel,E=this.tablePane=new sE(P),p=this.tableView=E.getTableView();E.getTableHeader().setMovable(!1),p.setEditable(!0),E.getView().style.border=rP.config.color_line+" solid 1px";var _=[E];this.addRow(_,[.1],ht.Default.widgetRowHeight+4*p.getRowHeight()).keys={name:"chartTable"};var m=new ht.Data,u=new ht.Data;m.setTag("chart.values"),u.setTag("chart.colors"),P.add(m),P.add(u),this.updateHandlers.push(function(){if(!_.hidden&&S.data){p.getColumnModel().clear(),E.addColumns([{name:l("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(P){if(!S.data)return 0;var E=S.data.s("chart.values");return E?E.length:0},setValue:function(P,E,p,l){var _=function(S,P){if(P>=0){var E=IS(S.s("chart.values"),P);DS(E),S.s("chart.values",E),E=IS(S.s("chart.colors"),P),yS(E),S.s("chart.colors",E)}};S.setValue(_,p)}},{tag:"binding",name:l("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(P,p,l,_){var m="chart.values"===P.getTag()?"values":"colors";return S.editor.funcView.toggle(E,P.getTag(),m,S),!1},drawCell:function(P,E,p,l,_,m,u,F,f){var H=!!S.data.a(E.getTag());o(P,ht.Default.getImage(H?"editor.bind":"editor.unbind"),"centerUniform",_,m,u,F,E,f,H&&!p?rP.config.color_select:rP.config.color_dark)}}]);for(var P=S.data.s("chart.values"),m=P?P.length:0,u=0;u<m;u++)E.addColumns([S.createChartIndexColumn(u)])}})},P}(yp),np=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addOneDimensionalProperties()},P.prototype.createChartIndexColumn=function(S){var P=this;return{
name:S,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(S){return"values"===S.getTag()?"number":"color"},getValue:function(E){if(P.data){var p=JS(P.data.s("chart.series"));if(p&&p[0]){var l=JS(p[0][E.getTag()]);return l?l[S]:void 0}}},setValue:function(p,l,_,m){var u=p.getTag(),F=function(P,p){var l=P.s("chart.series");if(l){var _=E(l),m=JS(_);if(m[0]){var F=JS(m[0][u]);F&&F[S]!==p&&(F[S]=p,"values"===u?DS(F):yS(F),P.s("chart.series",_))}}};P.setValue(F,_)}}},P.prototype.addOneDimensionalProperties=function(){var S=this,P=this.tableModel=new ht.DataModel,p=this.tablePane=new sE(P),_=this.tableView=p.getTableView();p.getTableHeader().setMovable(!1),_.setEditable(!0),p.getView().style.border=rP.config.color_line+" solid 1px";var m=[p];this.addRow(m,[.1],ht.Default.widgetRowHeight+4*_.getRowHeight()).keys={name:"chartTable"};var u=new ht.Data,F=new ht.Data;u.setTag("values"),F.setTag("colors"),P.add(u),P.add(F),this.updateHandlers.push(function(){if(!m.hidden&&S.data){_.getColumnModel().clear(),p.addColumns([{name:l("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(P){if(!S.data)return 0;var E=JS(S.data.s("chart.series"));if(!E)return 0;if(!E[0])return 0;var p=JS(E[0].values);return p?p.length:0},setValue:function(P,p,l,_){var m=function(S,P){if(P>=0){var p=S.s("chart.series"),l=p?E(p):[],_=JS(l);_[0]||(_[0]={});var m=_[0];m.values||(m.values=[]),m.colors||(m.colors=[]);var u=JS(m.values),F=JS(m.colors);P===u.length&&P===F.length||(u.length=P,F.length=P,DS(u),yS(F),S.s("chart.series",l))}};S.setValue(m,l)}},{tag:"binding",name:l("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(P,l,_,m){var u=P.getTag(),F=function(){return YP(S.data,u)},f=function(P){S.setValue(function(S,p){var l=S.s("chart.series");if(l){var _=E(l),m=JS(_);if(m[0]){var F=JS(m[0][u]);m[0][u]=P?{value:F,func:P}:F,S.s("chart.series",_)}}},P)};return S.editor.funcView.toggle(p,u,u,S,F,f),!1},drawCell:function(P,E,p,l,_,m,u,F,f){var H=!!YP(S.data,E.getTag());o(P,ht.Default.getImage(H?"editor.bind":"editor.unbind"),"centerUniform",_,m,u,F,E,f,H&&!p?rP.config.color_select:rP.config.color_dark)}}]);for(var P=kP(S.data,"values"),u=P?P.length:0,F=0;F<u;F++)p.addColumns([S.createChartIndexColumn(F)])}})},P}(yp),Up=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addSeriesChartProperties()},P.prototype.addSeriesChartProperties=function(){var S=this,P=[],p=function(S){var P=S.s("chart.series");return P?P.length:0},_=function(S,P){if(P>=0){var p=S.s("chart.series"),l=p?E(p):[],_=JS(l);if(_.length!==P){_.length=P;for(var m=void 0,u=0;u<P;u++){_[u]||(_[u]={});var F=_[u];F.values||(F.values=[]),F.color||(F.color=ht.Color.chart[u%ht.Color.chart.length]);var f=JS(F.values);JS(F.colors);0===u?m=f.length:f.length=m,DS(f)}S.s("chart.series",l)}}};this.addLabelInput(P,l("editor.series"),p,_,"int",1),p=function(S){var P=S.s("chart.series");if(P){var E=P[0];if(E){var p=JS(E.values);return p?p.length:0}}return 0},_=function(S,P){if(P>=0){var p=S.s("chart.series"),l=p?E(p):[],_=JS(l);if(_.length){for(var m=0;m<_.length;m++){_[m]||(_[m]={});var u=_[m];u.values||(u.values=[]);var F=JS(u.values);if(F.length===P)return;u.color||(u.color=ht.Color.chart[m%ht.Color.chart.length]);JS(u.colors);F.length=P,DS(F)}S.s("chart.series",l)}}},this.addLabelInput(P,l("editor.length"),p,_,"int",1),this.addRow(P,[rP.config.indent,.1,rP.config.indent2,.1]).keys={name:"chartSeries"};var m=this.tableModel=new ht.DataModel,u=this.tablePane=new sE(m),F=this.tableView=u.getTableView();u.getTableHeader().setMovable(!1),F.setEditable(!0),u.getView().style.border=rP.config.color_line+" solid 1px";var f=[u];this.addRow(f,[.1],160).keys={name:"chartTable"},this.updateHandlers.push(function(){if(!f.hidden&&S.data){m.clear(),F.getColumnModel().clear();var P=S.data.s("chart.series");if(P)for(var p=0;p<P.length;p++){var _=new ht.Data;_.serie=P[p],_.index=p,m.add(_)}if(u.addColumns([{name:l("editor.index"),width:50,align:"center",sortable:!1,clickable:!1,valueType:"int",getValue:function(S){return S.index}},{tag:"binding",name:l("editor.colorbinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(P,p,l,_){var m=P.index,F=function(){return $S(P.serie.color)},f=function(P){S.setValue(function(S,p){var l=S.s("chart.series");if(l){var _=E(l),u=JS(_),F=u[m];if(F){var f=JS(F.color);F.color=P?{value:f,func:P}:f,S.s("chart.series",_)}}},P)};return S.editor.funcView.toggle(u,"values","values",S,F,f),!1},drawCell:function(S,P,E,p,l,_,m,u,F){var f=!!$S(P.serie.color);o(S,ht.Default.getImage(f?"editor.bind":"editor.unbind"),"centerUniform",l,_,m,u,P,F,f&&!E?rP.config.color_select:rP.config.color_dark)}},{name:l("editor.color"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"color",getValue:function(S){return JS(S.serie.color)},setValue:function(P,p,l,_){var m=P.index,u=JS(P.serie.color);if(l&&u!==l){var F=function(S,P){var p=S.s("chart.series");if(p){var l=E(p),_=JS(l),u=_[m];if(u){var F=$S(u.color);u.color=F?{value:P,func:F}:P,S.s("chart.series",l)}}};S.setValue(F,l)}}},{tag:"binding",name:l("editor.valuebinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(P,p,l,_){var m=P.index,F=function(){return $S(P.serie.values)},f=function(P){S.setValue(function(S,p){var l=S.s("chart.series");if(l){var _=E(l),u=JS(_),F=u[m];if(F){var f=JS(F.values);F.values=P?{value:f,func:P}:f,S.s("chart.series",_)}}},P)};return S.editor.funcView.toggle(u,"values","values",S,F,f),!1},drawCell:function(S,P,E,p,l,_,m,u,F){var f=!!$S(P.serie.values);o(S,ht.Default.getImage(f?"editor.bind":"editor.unbind"),"centerUniform",l,_,m,u,P,F,f&&!E?rP.config.color_select:rP.config.color_dark)}}]),P){var H=P[0];if(H){var T=JS(H.values);if(T)for(var X=0;X<T.length;X++)u.addColumns([S.createChartIndexColumn(X)])}}}})},P.prototype.createChartIndexColumn=function(S){var P=this;return{name:S,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"number",getValue:function(P){var E=JS(P.serie.values);return E?E[S]:void 0},setValue:function(p,l,_,m){var u=p.index,F=function(P,p){var l=P.s("chart.series");if(l){var _=E(l),m=JS(_);if(m[u]){var F=JS(m[u].values);F&&F[S]!==p&&(F[S]=p,P.s("chart.series",_))}}};P.setValue(F,_)}}},P}(yp),tp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.addBasicChartProperties=function(){S.prototype.addBasicChartProperties.call(this),this.addStyleComboBox(l("editor.type"),"chart.type",rP.consts.columnChartTypes,rP.consts.columnChartTypeLabels,null,"type")},P.prototype.$14$=function(){},P}(Up),wp=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this)},P}(Up),Sl=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.$27$(),S.prototype.initForm.call(this)},P.prototype.isTitleVisible=function(P){return!("TitleEditingPoint"===P.title&&!this.editor.pointsEditingMode)&&S.prototype.isTitleVisible.call(this,P)},P.prototype.$14$=function(){var S=[];this.addLabelInput(S,l("editor.type"),function(S){return S.compType}),this.addRow(S,[rP.config.indent,.1]).keys={name:"type"}},P.prototype.$37$=function(){S.prototype.$37$.call(this),this.addStyleComboBox(l("editor.fillrule"),"shape.fill.rule",rP.consts.fillRules,rP.consts.fillRuleLabels,null,"fillRule")},P.prototype.$38$=function(){S.prototype.$38$.call(this);var P=[];this.addLabelCheckBox(P,l("editor.closed"),function(S){return S.isClosePath()},function(S,P){S instanceof ht.Shape&&S.setClosePath(P)}),this.addFuncRow(P,"name")},P}(Cp),Pl=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addTitle("TitleText"),this.addStyleLabel(l("editor.text"),"text","text"),this.addStyleAlign(l("editor.align"),"text.align","align"),this.addStyleVAlign(l("editor.valign"),"text.vAlign","vAlign"),this.addStyleColor(l("editor.color"),"text.color","color"),this.addStyleFont(l("editor.font"),"text.font","font")},P.prototype.$20$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(l("editor.shadow"),"text.shadow","shadow"),this.addStyleColor(l("editor.shadowcolor"),"text.shadow.color","shadowColor"),this.addStyleInput(l("editor.shadowblur"),"text.shadow.blur","number",1,"shadowblur"),this.addStyleInput(l("editor.shadowoffsetx"),"text.shadow.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(l("editor.shadowoffsety"),"text.shadow.offset.y","number",1,"shadowOffsetYs")},P}(Zp),El=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.$14$=function(){var S=[];this.addLabelInput(S,l("editor.type"),function(S){return"function"}),this.addFuncRow(S,"type")},P}(Zp),pl=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){S.prototype.initForm.call(this),this.addComponent()},P.prototype.$14$=function(){},P.prototype.addComponent=function(){var S=this;this.addTitle("TitleComponent");var P=[];this.addLabelInput(P,l("editor.type"),function(P){var E=P.s("type");return S.$43$(P.properties),E},function(S,P){S.s("type",P)},null,null,!1);var E=new ht.widget.Image;E.vectorDataBindingDisabled=!0,this.updateHandlers.push(function(){if(!P.hidden){var p=S.data?S.data.s("type"):null;S.$43$(S.data.properties),E.setIcon(p?FS(p):null),E.compType=p}});var p=E.getView();p.style.cursor="pointer";var _=function(P){P.preventDefault(),Y(P)?S.editor.open(E.compType):S.editor.selectFileNode(E.compType)};p.addEventListener("mousedown",_,!1),p.addEventListener("touchstart",_,!1),P.push(E),this.addFuncRow(P,"type")},P.prototype.$43$=function(S){var P=this;this.properties!==S&&(this.pendingProperties=S,this._updateComponentLater||(this._updateComponentLater=!0,requestAnimationFrame(function(){P.$61$()})))},P.prototype.$61$=function(){if(this._updateComponentLater=!1,this.properties===this.pendingProperties)return void(this.pendingProperties=null);if(this._rows=this.$47$,this.removeRows(this.$36$),this.$36$=[],this.properties=this.pendingProperties,this.properties)for(var S in this.properties)this.addProperty(S,this.properties[S]);this.$47$=this._rows,this.filterProperties()},P.prototype.addProperty=function(S,P){var E=rP.config.valueTypes[P.valueType];if(!E)return this.editor.fireEvent("error",{message:"Wrong value type:"+P.valueType}),!1;var p=l(P.name)||S;if("int"===E.type||"number"===E.type){var _=(E.max,E.min,function(P){return P.s(S)}),m=function(P,E){P.s(S,E)},u=[];E.angle?this.addLabelRotation(u,p,_,m,E.min,E.max,E.step):this.addLabelRange(u,p,_,m,E.min,E.max,E.step,E.type),this.addFuncRow(u,S,S)}else"color"===E.type?this.addStyleColor(p,S,S):"boolean"===E.type?this.addStyleCheckBox(p,S,S):"enum"===E.type?this.addStyleComboBox(p,S,E.values,E.labels,E.icons,S):"multiline"===E.type?this.addStyleMultiline(p,S,S,E.rows):"font"===E.type?this.addStyleFont(p,S,S,E.rows):"image"===E.type?this.addStyleImage(p,S,S):"url"===E.type?this.addStyleURL(p,S,S):"colorArray"===E.type?this.addStyleArray(p,S,S,"color",E.rows):"numberArray"===E.type?this.addStyleArray(p,S,S,"number",E.rows):"stringArray"===E.type?this.addStyleArray(p,S,S,"string",E.rows):"objectArray"===E.type?this.addStyleArray(p,S,S,"object",E.rows):"function"===E.type?this.addStyleFunction(p,S,S):"object"===E.type?this.addStyleObject(p,S,S):this.addStyleInput(p,S,null,null,S);return this.$36$.push(this._rows[this._rows.length-1]),!0},P}(Zp),ll=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.$27$(),this.addTitle("TitleBasic"),this.$14$(),this.$15$()},P.prototype.isTitleVisible=function(P){return!("TitleEditingPoint"===P.title&&!this.editor.pointsEditingMode)&&S.prototype.isTitleVisible.call(this,P)},P}(Zp),_l=function(S){function P(E,p){return $P(this,P),KP(this,S.call(this,E,p))}return BP(P,S),P.prototype.initForm=function(){this.addTitle("TitleBasic"),this.$14$(),this.$15$()},P}(Zp),ml=function(S){function P(E){$P(this,P);var p=KP(this,S.call(this));return p.editor=E,p.getView().style.background=rP.config.color_pane,p}return BP(P,S),P.prototype.handleDataModelPropertyChange=function(S){var P=this.inspector;P&&P.global&&P.$35$()},P.prototype.handleDataModelChange=function(S){var P=this.inspector;P&&P.global&&P.$35$()},P.prototype.handleDataPropertyChange=function(S){var P=this.inspector;P&&!P.global&&P.data===S.data&&P.$35$(S)},P.prototype.handleSelectionChange=function(S){this.updateInspector(),this.inspector&&this.inspector.updateProperties()},P.prototype.$42$=function(S){var P=this.inspector;P&&("pointsEditingMode"===S.property?P.filterPropertiesLater():"shapePointStatus"===S.property&&P.editingPointButtons&&P.editingPointButtons.forEach(function(P){P.setSelected(P.statusValue===S.newValue),P.setBorderColor(P.isSelected()?rP.config.color_line:null)}))},P.prototype.$6$=function(S){this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ums(this.handleSelectionChange,this),this.currentView.graphView.getEditInteractor().ump(this.$42$,this)),S?(this.currentView=S.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ms(this.handleSelectionChange,this),this.currentView.graphView.getEditInteractor().mp(this.$42$,this)):(this.currentView=null,this.dataModel=null),this.$95$()},P.prototype.$95$=function(){var S=this;this._updateInspectorLater||(this._updateInspectorLater=!0,requestAnimationFrame(function(){S.updateInspector()}))},P.prototype.updateInspector=function(){if(this._updateInspectorLater=!1,this.dataModel){var S=this.dataModel.sm().ld();if(S)if(this.currentView instanceof _p)if(S instanceof HE)this.inspector=this.clipInspector;else if(S instanceof TE)this.inspector=this.restoreInspector;else if(S instanceof mE)this.inspector=this.basicInspector;else if(S instanceof dE)this.inspector=this.borderInspector;else if(S instanceof FE)this.inspector=this.imageInspector;else if(S instanceof AE)this.inspector=this.pieChartInspector;else if(S instanceof NE){var P=JS(S.s("chart.series"));P&&P.length<=1&&P[0].colors?this.inspector=this.oneDimensionalColumnChartInspector:this.inspector=this.columnChartInspector}else S instanceof ZE?this.inspector=this.lineChartInspector:S instanceof uE?this.inspector=this.shapeInspector:S instanceof fE?this.inspector=this.textInspector:S instanceof pp?this.inspector=this.funcTypeInspector:S instanceof OE&&(this.inspector=this.compTypeInspector);else S instanceof ht.Shape?this.inspector=this.htShapeInspector:S instanceof ht.Edge?this.inspector=this.htEdgeInspector:S instanceof ht.Group?this.inspector=this.htGroupInspector:S instanceof ht.Text?this.inspector=this.htTextInspector:S instanceof ht.RefGraph?this.inspector=this.htRefGraphInspector:S instanceof ht.Block?this.inspector=this.htBlockInspector:S instanceof ht.Node?this.inspector=this.htNodeInspector:this.inspector=this.htDataInspector;else this.currentView instanceof _p?this.inspector=this.symbolInspector:this.inspector=this.displayInspector}else this.inspector=null},vP(P,[{key:"basicInspector",get:function(){return this._basicInspector||(this._basicInspector=new Cp(this.editor,"basic")),this._basicInspector}},{key:"borderInspector",get:function(){return this._borderInspector||(this._borderInspector=new Dp(this.editor,"border")),this._borderInspector}},{key:"clipInspector",get:function(){return this._clipInspector||(this._clipInspector=new ll(this.editor,"clip")),this._clipInspector}},{key:"restoreInspector",get:function(){return this._restoreInspector||(this._restoreInspector=new _l(this.editor,"restore")),this._restoreInspector}},{key:"imageInspector",get:function(){return this._imageInspector||(this._imageInspector=new op(this.editor,"image")),this._imageInspector}},{key:"pieChartInspector",get:function(){return this._pieChartInspector||(this._pieChartInspector=new Ip(this.editor,"pieChart")),this._pieChartInspector}},{key:"oneDimensionalColumnChartInspector",get:function(){return this._oneDimensionalColumnChartInspector||(this._oneDimensionalColumnChartInspector=new np(this.editor,"oneDimensionalColumnChartInspector")),this._oneDimensionalColumnChartInspector}},{key:"columnChartInspector",get:function(){return this._columnChartInspector||(this._columnChartInspector=new tp(this.editor,"columnChart")),this._columnChartInspector}},{key:"lineChartInspector",get:function(){return this._lineChartInspector||(this._lineChartInspector=new wp(this.editor,"lineChart")),this._lineChartInspector}},{key:"shapeInspector",get:function(){return this._shapeInspector||(this._shapeInspector=new Sl(this.editor,"shape")),this._shapeInspector}},{key:"textInspector",get:function(){return this._textInspector||(this._textInspector=new Pl(this.editor,"text")),this._textInspector}},{key:"funcTypeInspector",get:function(){return this._funcTypeInspector||(this._funcTypeInspector=new El(this.editor,"func")),this._funcTypeInspector}},{key:"compTypeInspector",get:function(){return this._compTypeInspector||(this._compTypeInspector=new pl(this.editor,"comp")),this._compTypeInspector}},{key:"htShapeInspector",get:function(){return this._htShapeInspector||(this._htShapeInspector=new Op(this.editor,"Shape")),this._htShapeInspector}},{key:"htBlockInspector",get:function(){return this._htBlockInspector||(this._htBlockInspector=new dp(this.editor,"Block")),this._htBlockInspector}},{key:"htRefGraphInspector",get:function(){return this._htRefGraphInspector||(this._htRefGraphInspector=new Ap(this.editor,"RefGraph")),this._htRefGraphInspector}},{key:"htGroupInspector",get:function(){return this._htGroupInspector||(this._htGroupInspector=new qp(this.editor,"Group")),this._htGroupInspector}},{key:"htEdgeInspector",get:function(){return this._htEdgeInspector||(this._htEdgeInspector=new rp(this.editor,"Edge")),this._htEdgeInspector}},{key:"htNodeInspector",get:function(){return this._htNodeInspector||(this._htNodeInspector=new Kp(this.editor,"Node")),this._htNodeInspector}},{key:"htTextInspector",get:function(){return this._htTextInspector||(this._htTextInspector=new Np(this.editor,"Text")),this._htTextInspector}},{key:"htDataInspector",get:function(){return this._htDataInspector||(this._htDataInspector=new vp(this.editor,"Data")),this._htDataInspector}},{key:"displayInspector",get:function(){return this._displayInspector||(this._displayInspector=new Gp(this.editor,"display")),this._displayInspector}},{key:"symbolInspector",get:function(){return this._symbolInspector||(this._symbolInspector=new $p(this.editor,"symbol")),this._symbolInspector}},{key:"inspector",get:function(){return this.getCenterView()},set:function(S){var P=this.getCenterView();S?(S.dataModel=this.dataModel,this.dataModel&&(S.data=this.dataModel.sm().ld()),this.getCenterView()!==S&&this.setCenterView(S),S.filterPropertiesLater()):this.setCenterView(null),S===P||null==S&&null==P||this.editor.fireEvent("inspectorUpdated",{inspector:S,oldInspector:P})}}]),P}(XE),ul=function(){function S(P){$P(this,S),this.editor=P}return S.prototype.showTip=function(S,P){this.tip.innerHTML=S,this.tip.parentNode!==document.body&&ht.Default.appendToScreen(this.tip);var E=j(P);this.tip.style.left=E.x+15+"px",this.tip.style.top=E.y+"px"},S.prototype.hideTip=function(){e(this.tip)},S.prototype.clearDropView=function(S,P){this._dropView&&(this._dropView.handleCrossDrag(S,"exit",P),this._dropView=null)},S.prototype.crossDrag=function(S,P){var E=this._dropView,p=this.$96$(S,P);E!==p?(E&&E.handleCrossDrag(S,"exit",P),p&&p.handleCrossDrag(S,"enter",P)):p&&p.handleCrossDrag(S,"over",P),this._dropView=p},S.prototype.crossDrop=function(S,P){this._dropView&&(this._dropView.handleCrossDrag(S,"drop",P),this._dropView=null)},S.prototype.crossCancel=function(S,P){this._dropView&&(this._dropView.handleCrossDrag(S,"cancel",P),this._dropView=null)},S.prototype.$96$=function(S,P){for(var E=b(S);E&&!(E._ht&&E._ht.isDroppable&&E._ht.isDroppable(S,P));)E=E.parentNode;return E?E._ht:null},vP(S,[{key:"tip",get:function(){if(!this._tip){this._tip=N(),this._tip.className="ht-editor-dnd-tip";var S=this._tip.style;S.whiteSpace="nowrap",S.color=rP.config.color_light,S.background=rP.config.color_transparent,S.font=ht.Default.labelFont,S.padding="4px",S.borderRadius="4px",S.position="absolute",S.zIndex=1e4}return this._tip}}]),S}();rP.DND=ul;var Fl=function(){function S(P,E){$P(this,S),this.editor=P,this.dnd=P.dnd,this._dragInfo={view:this},E&&(E.addEventListener("dragenter",this.handle_dragenter.bind(this),!1),E.addEventListener("dragover",this.handle_dragover.bind(this),!1),E.addEventListener("dragleave",this.handle_dragleave.bind(this),!1),E.addEventListener("drop",this.handle_drop.bind(this),!1),E.addEventListener("dragexit",this.handle_dragexit.bind(this),!1),E.addEventListener("dragend",this.handle_dragend.bind(this),!1)),this.isDroppableToDisplayView=!0,this.isDroppableToSymbolView=!0}return S.prototype.handle_dragenter=function(S){U(S),S.stopPropagation(),this.dnd.crossDrag(S,this._dragInfo)},S.prototype.handle_dragover=function(S){U(S),S.stopPropagation(),this.dnd.crossDrag(S,this._dragInfo)},S.prototype.handle_dragleave=function(S){U(S),S.stopPropagation(),this.dnd.crossCancel(S,this._dragInfo)},S.prototype.handle_dragexit=function(S){U(S),S.stopPropagation(),this.dnd.crossCancel(S,this._dragInfo)},S.prototype.handle_dragend=function(S){U(S),S.stopPropagation(),this.dnd.crossCancel(S,this._dragInfo)},S.prototype.handle_drop=function(S){U(S),S.stopPropagation(),this.dnd.crossDrop(S,this._dragInfo)},S}();rP.DNDFromOutside=Fl;var fl=function(){function S(P){$P(this,S),this.params=P||{},this.$39$=this.params.$39$,this._eventNotifier=new ht.Notifier;var E=ht.Default.getClass(rP.config.serviceClass);this.$40$=new E(this.handleServiceEvent.bind(this),this),this.emptyFunc=function(){}}return S.prototype.addEventListener=function(S,P,E){this._eventNotifier.add(S,P,E)},S.prototype.removeEventListener=function(S,P){this._eventNotifier.remove(S,P)},S.prototype.fireEvent=function(S,P){P=P||{},rP.config.handleEvent&&rP.config.handleEvent(this,S,P);var E="on"+S.charAt(0).toUpperCase()+S.slice(1);rP.config[E]&&rP.config[E](this,P),this.params&&this.params[E]&&this.params[E](this,P),this._eventNotifier.fire({editor:this,type:S,params:P})},S.prototype.handleServiceEvent=function(S){if("connected"===S.type)this.init&&(this.init(),this.init=null);else if("fileChanged"===S.type){var P=S.path;g(P)&&this.$101$(),t(P)?this.requestDisplays():w(P)?this.requestSymbols():PS(P)?this.requestComponents():SS(P)&&this.requestAssets()}else"download"===S.type?this.downloadFile(S.path):"confirm"===S.type&&this.requestImport(S.path);this.fireEvent(S.type,S)},S.prototype.onPropertyChanged=function(S){"rulerEnabled"!==S.property&&"gridEnabled"!==S.property||this.rightToolbar.iv()},S.prototype.init=function(){this._inspectorCompact=!m(rP.config.compactFilter),this.menus=[],this.cloneInfo={type:null,funcArray:[],jsonArray:[]},this.initSID(),this.$7$(),this.requestDisplays(),this.requestSymbols(),this.requestComponents(),this.requestAssets(),this.$39$&&this.$39$.addEventListener("keydown",this.$105$.bind(this),!1),this.dnd=new ul(this),this.dndFromOutside=new Fl(this,this.$39$),this.fireEvent("editorCreated"),this.fireEvent("mainMenuCreated"),this.fireEvent("mainToolbarCreated"),this.fireEvent("rightToolbarCreated");var S=this.params.open||P("hteditor");S&&(pS(S)?this._pendingOpenJSON=S:"newdisplay"===S?this.newDisplayView():"newsymbol"===S?this.newSymbolView():"newcomponent"===S&&this.newComponent())},S.prototype.$7$=function(){this.mainTabView=new mp(this),this.funcView=new ap(this),this.eventView=new sp(this),this.functionView=new kp(this),this.objectView=new Yp(this),this.textView=new xp(this),this.fontView=new bp(this),this.iconsView=new cp(this),this.componentView=new hp(this),this.messageView=new Vp(this),this.$8$(),this.$9$(),this.$11$(),this.$10$(),this.leftSplitView=new aE(this.leftTopTabView,this.mainTabView,"h",rP.config.leftSplitViewPosition),this.rightSplitView=new aE(this.rightTopBorderPane,this.rightBottomTabView,"v",rP.config.rightSplitViewPosition),this.mainSplitView=new aE(this.leftSplitView,this.rightSplitView,"h",rP.config.mainSplitViewPosition),this.mainPane=new XE,this.mainPane.setTopView(this.topBorderPane),this.mainPane.setCenterView(this.mainSplitView),oS(this.mainPane,this.$39$),this.mainPane.validateImpl()},S.prototype.initSID=function(){var S=window.location.href.match("sid=([0-9a-z-]*)");S&&(this.sid=S[1])},S.prototype.$8$=function(){var S=this;this.mainToolbar=new Xp(this),this.rightToolbar=new Wp(this),this.topBorderPane=new XE,this.topBorderPane.setCenterView(this.mainToolbar),this.topBorderPane.setRightView(this.rightToolbar),this.topBorderPane.setHeight(28),this.rightToolbar.onSumWidthChanged=function(){S.topBorderPane.setRightWidth(S.rightToolbar.getSumWidth())}},S.prototype.$9$=function(){this.displays=new vE(this,rP.config.displaysModifiable),this.symbols=new BE(this,rP.config.symbolsModifiable),this.components=new KE(this,rP.config.componentsModifiable),this.assets=new LE(this,rP.config.assetsModifiable),this.leftTopTabView=new kE,this.displaysTab=this.leftTopTabView.addTab(l("editor.displays"),this.displays,!1,rP.config.displaysVisible),this.symbolsTab=this.leftTopTabView.addTab(l("editor.symbols"),this.symbols,!1,rP.config.symbolsVisible),this.componentsTab=this.leftTopTabView.addTab(l("editor.components"),this.components,!1,rP.config.componentsVisible),this.assetsTab=this.leftTopTabView.addTab(l("editor.assets"),this.assets,!1,rP.config.assetsVisible),this.leftTopTabView.selectByIndex(0)},S.prototype.$10$=function(){this.inspectorTool=new up(this),this.inspectorPane=new ml(this),this.rightTopBorderPane=new XE,this.rightTopBorderPane.setTopView(this.inspectorTool),this.rightTopBorderPane.setCenterView(this.inspectorPane),this.rightTopBorderPane.setTopHeight(ht.Default.widgetHeaderHeight+6)},S.prototype.$11$=function(){var S=this;this.listPane=new fp(this),this.layerPane=new Hp(this),this.overview=new eE(this),this.dataView=new Fp(this),this.rightBottomTabView=new kE,this.listPaneTab=this.rightBottomTabView.addTab(l("editor.list"),this.listPane,!0),this.layerTab=this.rightBottomTabView.addTab(l("editor.layer"),this.layerPane),this.overviewTab=this.rightBottomTabView.addTab(l("editor.overview"),this.overview),this.dataViewTab=this.rightBottomTabView.addTab(l("editor.data"),this.dataView);var P=this.rightBottomTabView.getTabModel().sm();P.ms(function(){var E=P.ld();S.dataView.visible=E.getView()===S.dataView,S.overview.setAutoUpdate(E.getView()===S.overview)})},S.prototype.newFolder=function(S){var P=this,E=this.explorer;if(E){var p=S.sm().ld();S!==S.explorer.list||p&&p.fileType===AP||(p=S.explorer.tree.sm().ld()),p&&!E.isAccordionMode()||(p=S.explorer.rootNode);qS(l("editor.inputnewfoldername"),"",{nullable:!1,trim:!0,maxLength:rP.config.maxFileNameLength},function(S,E){if("ok"===E){var _=p.url+"/"+S;if(P.getFileNode(_))return void OS(l("editor.filenameconflict"),_,function(){});P.request("mkdir",_,function(S){})}})}},S.prototype.getFileNode=function(S){for(var P=this.leftTopTabView.getTabModel().getDatas(),E=0;E<P.size();E++){var p=P.get(E);if(p.getView()instanceof $E){var l=p.getView().dataModel.getDataById(S);if(l)return l}}return null},S.prototype.selectFileNode=function(S){for(var P=this,E=this.leftTopTabView.getTabModel().getDatas(),p=0;p<E.size();p++){var l=E.get(p);if(l.getView()instanceof $E){var _=function(){var E=l.getView(),p=E.dataModel.getDataById(S);if(p)return P.leftTopTabView.getTabModel().sm().ss(l),E.isAccordionMode()?(p.fileType===AP?E.accordion.sm().ss(p):(p.getParent().expanded=!0,E.accordion.sm().ss(p)),E.accordion.ivm()):p.fileType===AP?(E.tree.sm().ss(p),setTimeout(function(){E.tree.makeVisible(p)},500)):(E.tree.sm().ss(p.getParent()),E.list.sm().ss(p),setTimeout(function(){E.tree.makeVisible(p.getParent()),E.list.makeVisible(p)},500)),delete P._pendingSelectURL,{v:void 0}}();if("object"==typeof _)return _.v}}this._pendingSelectURL=S},S.prototype.renameFile=function(S,P){if(!S||S.$34$||!P)return!1;if(P.length>rP.config.maxFileNameLength)return OS(l("editor.inputmax"),P,function(){}),!1;if(pS(S.getName())&&!pS(P)&&(P+=".json"),S.getName()===P)return!1;var E=S.path+"/"+P;if(this.getFileNode(E))return OS(l("editor.filenameconflict"),E,function(){}),!1;S.$34$=E;var p={old:S.url,new:S.$34$};return pS(p.old)&&this.request("rename",{old:FS(p.old),new:FS(p.new)},function(S){}),this.request("rename",p,function(S){}),this.mainTabView.getTabModel().each(function(E){E.getTag()===S.url&&(E.setTag(S.$34$),E.getView().url=S.$34$,E.setName(v(P)))}),!0},S.prototype.moveFile=function(S,P){if(S&&P&&!S.$34$&&!P.$34$){var E={data:S,url:S.url,parent:P};if(this.fireEvent("fileMoving",E),!E.preventDefault){var p=S.getParent();if(S.setParent(P),p!==S.getParent()){S.$34$=P.url+"/"+S.getName();var l={old:S.url,new:S.$34$};pS(l.old)&&this.request("rename",{old:FS(l.old),new:FS(l.new)},function(S){}),this.request("rename",l,function(S){})}}}},S.prototype.removeFiles=function(S){var P=this;S.forEach(function(S){if(!S.$34$){var E=S.url||S;pS(E)&&P.request("remove",FS(E),function(S){}),P.request("remove",E,function(S){})}})},S.prototype.requestBase64=function(S,P){this.request("source",{url:S,encoding:"base64",prefix:"data:;base64,"},P)},S.prototype.request=function(S,P,E,p){var l=this;E=E||this.emptyFunc,p?setTimeout(function(){l.$40$.request(S,P,E)},p):this.$40$.request(S,P,E)},S.prototype.requestDisplays=function(){var S=this;this._requestingDisplays||(this.request("explore","/displays",function(P){S._requestingDisplays=!1,S.displays.parse(P),S._pendingOpenJSON&&t(S._pendingOpenJSON)&&(S.displays.dataModel.getDataById(S._pendingOpenJSON)?(S.open(S._pendingOpenJSON),S.selectFileNode(S._pendingOpenJSON)):rP.config.newIfFailToOpen&&(S.newDisplayView(),S.save(null,S._pendingOpenJSON)),delete S._pendingOpenJSON),S._pendingSelectURL&&t(S._pendingSelectURL)&&S.selectFileNode(S._pendingSelectURL)},rP.config.requestDelay),this._requestingDisplays=!0)},S.prototype.requestSymbols=function(){var S=this;this._requestingSymbols||(this.request("explore","/symbols",function(P){S._requestingSymbols=!1,S.symbols.parse(P),S._pendingOpenJSON&&w(S._pendingOpenJSON)&&(S.symbols.dataModel.getDataById(S._pendingOpenJSON)?(S.open(S._pendingOpenJSON),S.selectFileNode(S._pendingOpenJSON)):rP.config.newIfFailToOpen&&(S.newSymbolView(),S.save(null,S._pendingOpenJSON)),delete S._pendingOpenJSON),S._pendingSelectURL&&w(S._pendingSelectURL)&&S.selectFileNode(S._pendingSelectURL)},rP.config.requestDelay),this._requestingSymbols=!0)},S.prototype.requestComponents=function(){var S=this;this._requestingComponents||(this.request("explore","/components",function(P){S._requestingComponents=!1,S.components.parse(P),S._pendingOpenJSON&&PS(S._pendingOpenJSON)&&(S.components.dataModel.getDataById(S._pendingOpenJSON)?S.open(S._pendingOpenJSON):rP.config.newIfFailToOpen&&S.newComponent(),delete S._pendingOpenJSON),S._pendingSelectURL&&PS(S._pendingSelectURL)&&S.selectFileNode(S._pendingSelectURL)},rP.config.requestDelay),this._requestingComponents=!0)},S.prototype.requestAssets=function(){var S=this;this._requestingAssets||(this.request("explore","/assets",function(P){S._requestingAssets=!1,S.assets.parse(P),
S._pendingOpenJSON&&SS(S._pendingOpenJSON)&&(S.open(S._pendingOpenJSON),delete S._pendingOpenJSON),S._pendingSelectURL&&SS(S._pendingSelectURL)&&S.selectFileNode(S._pendingSelectURL)},rP.config.requestDelay),this._requestingAssets=!0)},S.prototype.requestImport=function(S){var P=this;rP.config.importConfirm?OS("",l("editor.importconfirm"),function(){P.request("import",{path:S,move:!0})},function(){P.request("import",{path:S,move:!1})}):this.request("import",{path:S,move:!0})},S.prototype.downloadFile=function(S){try{var P=document.createElement("iframe");P.src=S,P.style.display="none",document.body.appendChild(P)}catch(S){}},S.prototype.$6$=function(S){var P=this._currentTab;this._currentTab=S,this.inspectorPane.$6$(S),this.listPane.$6$(S),this.overview.$6$(S),this.dataView.$6$(S),this.layerPane.$6$(S),this.mainToolbar.$6$(S),this.rightToolbar.$6$(S),this.inspectorTool.$6$(S),this.fireEvent("tabUpdated",{tab:S,oldTab:P})},S.prototype.beginTransaction=function(){this.dm&&this.dm.beginTransaction()},S.prototype.endTransaction=function(){this.dm&&this.dm.endTransaction()},S.prototype.$101$=function(){this.mainTabView.$101$()},S.prototype.dropLocalFileOnGraphView=function(S){var P={event:S};if(this.displayView?(P.displayView=this.displayView,this.fireEvent("displayViewOutsideDropping",P)):this.symbolView&&(P.symbolView=this.symbolView,this.fireEvent("symbolViewOutsideDropping",P)),!P.preventDefault)for(var E=S.dataTransfer.files,p=0;p<E.length;p++){var l=E[p],_=l.name;ES(_)&&!uS(_)?this.insertLocalImageFile(S,l):pS(_)&&this.insertLocalJSONFile(S,l)}},S.prototype.insertLocalImageFile=function(S,P){var E=this,p=this.gv.lp(S);CS(P,function(S){if(E.displayView){var l=new ht.Node;l.setImage(S),l.p(p),l.setDisplayName(B(P.name)),E.displayView.addData(l)}else if(E.symbolView){var _=new FE({type:"image",name:S,rect:[p.x,p.y,-1,-1]});_.setDisplayName(B(P.name)),E.symbolView.addData(_)}},!0)},S.prototype.insertLocalJSONFile=function(S,P){var E=this;CS(P,function(P){E.$99$(P,E.currentView.graphView.lp(S))})},S.prototype.dropLocalFileOnDir=function(S,P){for(var E=S.dataTransfer.files,p=0;p<E.length;p++)this.uploadLocalFile(E[p],P.url)},S.prototype.uploadLocalFile=function(S,P){var E=this,p=S.name;CS(S,function(S){var l={path:P+"/"+p,content:S};E.request("upload",l)},!0)},S.prototype.addTab=function(S,P){this.mainTabView.getTabModel().add(S),this.fireEvent("tabCreated",{tab:S}),P&&this.mainTabView.getTabModel().sm().ss(S),this.mainTabView.validate()},S.prototype.openByJSON=function(S,P,E,p,l){this.mainTabView.getTabModel();if(S===CP){var _=this.mainTabView.getTabModel().getDataByTag(P);_||(_=new ht.Tab,_.setTag(P),_.setIcon("editor.display"),_.setClosable(!0),_.setName(E),new tE(this,_,P,p),this.addTab(_)),this.mainTabView.getTabModel().sm().ss(_)}else if(S===ZP){var m=this.mainTabView.getTabModel().getDataByTag(P);m||(m=new ht.Tab,m.setTag(P),m.setIcon("editor.symbol"),m.setClosable(!0),m.setName(E),new _p(this,m,P,p),this.addTab(m)),this.mainTabView.getTabModel().sm().ss(m)}else S===oP&&this.componentView.update(P,l,E,p)},S.prototype.isOpenable=function(S){return!0},S.prototype.open=function(S,P){var E=this;fS(S)&&(S=this.getFileNode(S)),S&&!S.$34$&&this.isOpenable(S)&&(S.fileType===CP?this.mainTabView.open(S):S.fileType===ZP?this.mainTabView.open(S):S.fileType===oP?this.componentView.open(S):S.fileType===NP&&(mS(S.url)?r(S.url,function(p){var l=ht.Default.svgToShape(p,{segments:rP.config.svgSegments});setTimeout(function(){var p=v(S.getName());P?E.newSymbolView(p,!1):E.newDisplayView(p),l.output.comps.forEach(function(S){delete S.repeatImage}),E.beginTransaction(),rP.toDatas(l.output.comps,P).forEach(function(S){E.currentView.addData(S,!0)}),P&&(l.output.width&&E.dm.a("width",l.output.width),l.output.height&&E.dm.a("height",l.output.height)),E.zoomToFit(),E.endTransaction()},600)}):uS(S.url)&&r(S.url,function(p){var l=v(S.getName()),_=ht.Default.cadToShape(p),m={},u=Object.keys(_.blockDef).length,F=function(){P?E.newSymbolView(l,!1):E.newDisplayView(l),E.beginTransaction(),_.comps.forEach(function(S){"image"===S.type&&m[S.name]&&(S.name=m[S.name])}),rP.toDatas(_.comps,P).forEach(function(S){E.currentView.addData(S,!0)}),P&&(_.width&&E.dm.a("width",_.width),_.height&&E.dm.a("height",_.height)),E.zoomToFit(),E.endTransaction()};u?function(){var P=function(){0===--u&&F()},p="symbols/"+S.path.substr("assets/".length)+"/"+l+"/";for(var f in _.blockDef){_.blockDef[f].comps.forEach(function(S){"image"===S.type&&(S.name=p+S.name+".json")});var H={path:m[f]=p+f+".json",content:G(_.blockDef[f])};E.request("upload",H,P)}}():F()})))},S.prototype.$99$=function(S,P){var E=this;if(S){if(this.beginTransaction(),S=J(S),this.displayView&&XS(S.d)){var p=this.displayView.graphView,l=p.dm().deserialize(S,p.getCurrentSubGraph(),{justDatas:!0});if(p.sm().ss(l.toList(p.isSelectable,p)),l.each(function(S){E.displayView.addData(S,!0,!0)}),P){var _=p.getUnionNodeRect(l.toArray());p.moveSelection(P.x-_.x-_.width/2,P.y-_.y-_.height/2)}}else this.symbolView&&XS(S.comps)&&S.comps.forEach(function(S){aP(S,E.symbolView)});this.gv.setFocus(),this.endTransaction()}},S.prototype.$100$=function(S,P){var E=this;if(S){if(!this.tab)return void this.open(S);if(!uS(S.url))if(S.fileType!==CP){if(this.url!==S.url)if(S.fileType!==oP){if(S.fileType!==ZP&&S.fileType!==NP);else if(this.displayView){var p=new ht.Node;if(p.setImage(S.url),P)p.p(P.x,P.y);else{var l=this.gv.getViewRect();l&&p.p(l.x+l.width/2,l.y+l.height/2)}p.setDisplayName(B(S.url)),this.displayView.addData(p)}else if(this.symbolView){var _=ht.Default.getImage(S.url),m=_?_.width:-1,u=_?_.height:-1,F=P?P.x:(this.dm.a("width")||0)/2,f=P?P.y:(this.dm.a("height")||0)/2,H=new FE({type:"image",name:S.url,rect:[F-(m>0?m/2:0),f-(u>0?u/2:0),m,u]});H.setDisplayName(B(S.url)),this.symbolView.addData(H)}}else if(this.symbolView){var T=new OE({type:S.url,rect:[P?P.x:(this.dm.a("width")||0)/2,P?P.y:(this.dm.a("height")||0)/2,-1,-1]});T.setDisplayName(B(S.url)),this.symbolView.addData(T)}}else if(this.displayView)if(rP.config.insertDisplayViewAsRefGraph){var X=new ht.RefGraph;X.setRef(S.url),X.onPendingUpdated=function(){X.onPendingUpdated=null,X.p(P)},X.setDisplayName(B(S.url)),this.displayView.addData(X)}else r(S.url,function(S){E.$99$(S,P)})}},S.prototype.newDisplayView=function(S){return this.mainTabView.newDisplayView(S)},S.prototype.newSymbolView=function(S,P){return this.mainTabView.newSymbolView(S,P)},S.prototype.newComponent=function(){this.componentView.open()},S.prototype.save=function(S,P){this.mainTabView.save(S,P)},S.prototype.reload=function(){this.mainTabView.reload()},S.prototype.preview=function(){this.mainTabView.preview()},S.prototype.closeTab=function(){this.mainTabView.closeTab()},S.prototype.closeOtherTabs=function(){this.mainTabView.closeOtherTabs()},S.prototype.closeTabsToTheRight=function(){this.mainTabView.closeTabsToTheRight()},S.prototype.filterProperties=function(){this.inspector&&this.inspector.filterPropertiesLater()},S.prototype.isRulerEnabled=function(){return this._rulerEnabled},S.prototype.setRulerEnabled=function(S){var P=this._rulerEnabled;P!==S&&(this._rulerEnabled=S,this.tabs.forEach(function(P){P.getView().setRulerEnabled(S)}),this.fp("rulerEnabled",P,S))},S.prototype.toggleRulerEnabled=function(){this.setRulerEnabled(!this.isRulerEnabled())},S.prototype.isGridEnabled=function(){return this._gridEnabled},S.prototype.setGridEnabled=function(S){var P=this._gridEnabled;P!==S&&(this._gridEnabled=S,this.tabs.forEach(function(P){P.getView().graphView.getEditInteractor().gridEnabled=S}),this.fp("gridEnabled",P,S))},S.prototype.toggleGridEnabled=function(){this.setGridEnabled(!this.isGridEnabled())},S.prototype.toggleLeft=function(){"normal"===this.leftSplitView.getStatus()?this.leftSplitView.setStatus("cl"):this.leftSplitView.setStatus("normal")},S.prototype.toggleRight=function(){"normal"===this.mainSplitView.getStatus()?this.mainSplitView.setStatus("cr"):this.mainSplitView.setStatus("normal")},S.prototype.toggleBoth=function(){"normal"===this.mainSplitView.getStatus()||"normal"===this.leftSplitView.getStatus()?(this.mainSplitView.setStatus("cr"),this.leftSplitView.setStatus("cl")):(this.mainSplitView.setStatus("normal"),this.leftSplitView.setStatus("normal"))},S.prototype.zoomIn=function(){this.gv&&this.gv.zoomIn(rP.config.animate)},S.prototype.zoomOut=function(){this.gv&&this.gv.zoomOut(rP.config.animate)},S.prototype.zoomReset=function(){this.gv&&this.gv.zoomReset(rP.config.animate)},S.prototype.zoomToFit=function(){this.gv&&this.gv.fitContent(rP.config.animate,rP.config.fitPadding)},S.prototype.delete=function(){this.gv&&this.gv.removeSelection()},S.prototype.copyFiles=function(){this.explorer.copyFiles()},S.prototype.pasteFiles=function(){this.explorer.pasteFiles()},S.prototype.copy=function(){var S=this;if(this.ld){var P=this.cloneInfo;if(P.funcArray.length=0,P.jsonArray.length=0,P.offset={x:0,y:0},P.lastCheck=null,P.lastView=this.gv,this.displayView)P.type="display";else{if(!this.symbolView)return void(P.type=null);P.type="symbol"}var E={};this.selection.forEach(function(S){S._refGraph||(E[S._id]=S,S instanceof ht.Block&&!(S instanceof ht.RefGraph)&&n(S,E))});var p=[];this.gv.each(function(S){E[S._id]&&p.push(S)}),this.gv.copyMap=E,p.forEach(function(E){var p=S.gv.isSelected(E),l=E.$51$(S.gv);if(0!==l.length){P.funcArray.push([E._id,p].concat(l));var _=QP(E);_&&P.jsonArray.push([p,_])}}),this.fireEvent("copy",{datas:p,info:P}),this.gv.copyMap=null}},S.prototype.hasCopyInfo=function(){return this.cloneInfo.funcArray.length>0},S.prototype.paste=function(S){var P=this,E=this.gv,p=this.cloneInfo;if(p.funcArray.length&&E){var l=[],_=[];if(this.beginTransaction(),ht.Default.setIsolating(!0),"display"===p.type&&this.displayView||"symbol"===p.type&&this.symbolView){var m={},u=[];p.funcArray.forEach(function(S){var p=S[0],F=S[1],f=S[2],H=S[3],T=H(f,E);P.currentView.addData(T,!0),m[p]=T,l.push(T),u.push(f),F&&_.push(T)});for(var F=0;F<l.length;F++)l[F].$50$(u[F],E,m)}else p.jsonArray.length&&p.jsonArray.forEach(function(S){var p=S[0],m=S[1],u=iP(m,!!P.symbolView);u&&(u.setParent(E.getCurrentSubGraph()),P.currentView.addData(u,!0),l.push(u),p&&_.push(u))});if(ht.Default.setIsolating(!1),_.length&&this.sm.ss(_),p.lastView!==E&&(p.offset.x=-rP.config.pasteOffset,p.offset.y=-rP.config.pasteOffset),!S&&l.length){p.offset.x+=rP.config.pasteOffset,p.offset.y+=rP.config.pasteOffset,E.moveDatas(l,p.offset.x,p.offset.y);var f=E.$64$(l);f&&(p.offset.x+=f.x,p.offset.y+=f.y,p.lastCheck||(E.moveDatas(l,-rP.config.pasteOffset,-rP.config.pasteOffset),p.offset.x-=rP.config.pasteOffset,p.offset.y-=rP.config.pasteOffset)),p.lastCheck=f}p.lastView=E,this.fireEvent("paste",{datas:l,info:p}),E.setFocus(),this.endTransaction()}},S.prototype.block=function(){if(this.displayView){var S=this.selection;if(S.length){this.beginTransaction();var P=new ht.Block;S.forEach(function(S){S.setParent(P)}),this.displayView.addData(P),this.endTransaction()}}},S.prototype.unblock=function(){var S=this;if(this.displayView){this.beginTransaction();var P=[];this.selection.forEach(function(E){if(E instanceof ht.Block&&!(E instanceof ht.RefGraph)){var p=E.getParent();E.getChildren().toArray().forEach(function(S){S.setParent(p),P.push(S)}),S.dm.remove(E)}}),P.length&&(this.sm.ss(P),this.gv.setFocus()),this.endTransaction()}},S.prototype.bringForward=function(){this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionDown():this.dm.bringSelectionForward())},S.prototype.bringToFront=function(){this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToBottom():this.dm.bringSelectionToFront())},S.prototype.sendBackward=function(){this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionUp():this.dm.sendSelectionBackward())},S.prototype.sendToBack=function(){this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToTop():this.dm.sendSelectionToBack())},S.prototype.undo=function(){this.dm&&this.dm.undo()},S.prototype.redo=function(){this.dm&&this.dm.redo()},S.prototype.distributeHorizontal=function(){this.inspectorTool.distributeHorizontal()},S.prototype.distributeVertical=function(){this.inspectorTool.distributeVertical()},S.prototype.alignLeft=function(){this.inspectorTool.alignLeft()},S.prototype.alignHorizontal=function(){this.inspectorTool.alignHorizontal()},S.prototype.alignRight=function(){this.inspectorTool.alignRight()},S.prototype.alignTop=function(){this.inspectorTool.alignTop()},S.prototype.alignVertical=function(){this.inspectorTool.alignVertical()},S.prototype.alignBottom=function(){this.inspectorTool.alignBottom()},S.prototype.folder=function(){if(this.displayView){this.beginTransaction();var S=new ht.Data;S.s("editor.folder",!0),this.dm.add(S);this.list.getTopRowOrderSelection().each(function(P){S.addChild(P)}),this.sm.ss(S),this.endTransaction()}},S.prototype.unfolder=function(){var S=this;if(this.displayView){this.beginTransaction();var P=this.sm.toSelection(function(S){return S.s("editor.folder")});P.forEach(function(S){S.toChildren().forEach(function(P){P.setParent(S.getParent())})}),P.forEach(function(P){S.dm.remove(P)}),this.endTransaction()}},S.prototype.locate=function(S){S&&this.request("locate",S.url||S)},S.prototype.saveImage=function(S,P,E){var p={path:P,content:nS(S)};this.request("upload",p,E)},S.prototype.$105$=function(S){var P=S.keyCode;if(O(S)&&83===P&&S.preventDefault(),SE.length){if((S.target._ignore||!rS(S.target))&&!ht.Default.popup){var E=SE[SE.length-1];a(S)&&E.$49$?E.$49$():i(S)&&E.$48$&&E.$48$()}}else{if(O(S)&&83===P)return void this.save();if(!rS(S.target)){if(S.preventDefault(),a(S)){for(var p=0;p<this.menus.length;p++)if(this.menus[p].isShowing())return void this.menus[p].hide();if(this.funcView.getView().parentNode)return void this.funcView.hide();if(this.iconsView.getView().parentNode)return void this.iconsView.hide();if(this.tab){var l=this.tab.getView().graphView.getInteractors();l&&l.each(function(P){P.$49$&&P.$49$(S)})}}80===P?this.preview():187===P?this.zoomIn():189===P?this.zoomOut():48===P?this.zoomToFit():57===P?this.zoomReset():O(S)&&67===P?this.copy():O(S)&&86===P?this.paste():O(S)&&q(S)&&90===P?this.redo():O(S)&&90===P?this.undo():S.altKey&&O(S)&&221===P?this.bringToFront():S.altKey&&O(S)&&219===P?this.sendToBack():O(S)&&221===P?this.bringForward():O(S)&&219===P&&this.sendBackward()}}},S.prototype.createDisplayItem=function(S,P,E,p,l){var _=this,m=function(){return _.displayView&&_.displayView.$4$()===S},u=dS(S,P,E,m);return u.visible=function(){return!!_.displayView},u.action=function(){_.displayView&&_.displayView.$5$(S,p,l)},u},S.prototype.createSymbolItem=function(S,P,E,p,l){var _=this,m=function(){return _.symbolView&&_.symbolView.$4$()===S},u=dS(S,P,E,m);return u.visible=function(){return!!_.symbolView},u.action=function(){_.symbolView&&_.symbolView.$5$(S,p,l)},u},S.prototype.showMessage=function(S,P,E){this.messageView.show(S,P,E)},vP(S,[{key:"dm",get:function(){return this.gv?this.gv.dm():null}},{key:"gv",get:function(){var S=this.mainTabView.getTabModel().sm().ld();return S?S.getView().graphView:null}},{key:"editInteractor",get:function(){return this.gv?this.gv.getEditInteractor():null}},{key:"pointsEditingMode",get:function(){return!!this.editInteractor&&this.editInteractor.pointsEditingMode},set:function(S){this.editInteractor&&(this.editInteractor.pointsEditingMode=S)}},{key:"anchorVisible",get:function(){return!!this.editInteractor&&this.editInteractor.getStyle("anchorVisible")},set:function(S){this.editInteractor&&this.editInteractor.setStyle("anchorVisible",S)}},{key:"sm",get:function(){return this.gv?this.gv.sm():null}},{key:"ld",get:function(){return this.sm?this.sm.ld():null}},{key:"selection",get:function(){var S=this,P=[];return this.gv&&this.gv.each(function(E){S.gv.isSelected(E)&&P.push(E)}),P}},{key:"tabs",get:function(){return this.mainTabView.tabs}},{key:"inspector",get:function(){return this.inspectorPane.inspector}},{key:"list",get:function(){return this.listPane.list}},{key:"tab",get:function(){return this.mainTabView.currentTab}},{key:"url",get:function(){return this.tab?this.tab.getTag():null}},{key:"explorer",get:function(){return this.leftTopTabView.getCurrentTab().getView()}},{key:"dir",get:function(){return this.explorer?this.explorer.tree.getSelectionModel().getLastData():null}},{key:"file",get:function(){return this.explorer?this.explorer.getFileListView().getSelectionModel().getLastData():null}},{key:"currentLayer",get:function(){return this.layerPane.currentLayer}},{key:"currentView",get:function(){var S=this.tab;return S?S.getView():null}},{key:"displayTree",get:function(){return this.displayView?this.displayView.displayTree:null}},{key:"displayView",get:function(){var S=this.currentView;return S instanceof tE?S:null}},{key:"symbolList",get:function(){return this.symbolView?this.symbolView.symbolList:null}},{key:"symbolView",get:function(){var S=this.currentView;return S instanceof _p?S:null}},{key:"inspectorCompact",get:function(){return this._inspectorCompact},set:function(S){this._inspectorCompact=S,this.filterProperties(),this.inspectorTool.iv()}},{key:"inspectorInputFilter",get:function(){return this.inspectorTool.searchField.getValue()},set:function(S){this.inspectorTool.searchField.setValue(S),this.filterProperties()}}]),S}();I(fl,{ms_fire:1,_rulerEnabled:rP.config.rulerEnabled,_gridEnabled:rP.config.gridEnabled}),rP.Editor=fl;var Hl=function(){function S(P){$P(this,S);var E=this._view=document.createElement("div"),p=this._editableLayer=document.createElement("div"),l=p.style;this.config=P,this._editable=!0,l.backgroundColor="rgba( 255, 255, 255, 0.3)",l.position="absolute",l.top=0,l.right=0,l.bottom=0,l.left=0,l.zIndex=1e3,rP.config.useCodeEditor||(this._monacoEditor=new ht.widget.TextArea,this._view=this._monacoEditor.getView(),P&&P.value&&this._monacoEditor.setValue(P.value)),E.style.position="absolute"}return S.prototype.getView=function(){return this._view},S.prototype.setValue=function(S){void 0!==S&&null!==S||(S=""),this.monacoEditor&&this.monacoEditor.setValue(S)},S.prototype.getValue=function(){return this.monacoEditor&&this.monacoEditor.getValue()},S.prototype.layout=function(){this.monacoEditor&&this.monacoEditor.layout()},S.prototype.invalidate=function(){this.layoutLater()},S.prototype.iv=function(){this.invalidate()},S.prototype.layoutLater=function(S){var P=this;setTimeout(function(){P.layout()},S||300)},S.prototype.setEditable=function(S){if(this._monacoEditor instanceof ht.widget.TextArea)return void this._monacoEditor.setEditable(S);if(this._editable!==S){var P=this._editableLayer;S?P.parentNode&&P.parentNode.removeChild(P):this.getView().appendChild(P),this._editable=S}},S.prototype.isEditable=function(){return this._monacoEditor instanceof ht.widget.TextArea?this._monacoEditor.isEditable():this._editable},vP(S,[{key:"monacoEditor",get:function(){return!this._monacoEditor&&window.monaco&&(this._monacoEditor=monaco.editor.create(this._view,this.config||{value:"",language:"javascript",minimap:{enabled:!1}})),this._monacoEditor}}]),S}(),Tl=function(){function S(P,E){var p=this;$P(this,S),this.editor=E,this.handler=P,this.cookie=0,this.callbacks={},this.cmds={};var l=rP.config.host||window.location.hostname,_=rP.config.port||window.location.port,m=window.location.protocol+"//"+l+":"+_;this.socket=io.connect(m),this.socket.on("connect",function(){p.handler({type:"connected",message:m})}),this.socket.on("disconnect",function(){p.handler({type:"disconnected",message:m})}),this.socket.on("fileChanged",function(S){p.handler({type:"fileChanged",path:S.path,event:S.event})}),this.socket.on("operationDone",function(S,P){p.handleRespone(S,P)}),this.socket.on("download",function(S){p.handler({type:"download",path:S})}),this.socket.on("confirm",function(S,P){p.handler({type:"confirm",path:S,datas:P})})}return S.prototype.request=function(S,P,E){var p=++this.cookie;this.callbacks[p]=E,this.cmds[p]=S;var l=this.editor.sid;this.socket.emit(S,p,P,l?{sid:l}:null);var _=S;P&&(fS(P)?_=S+": "+P:P.path&&(_=S+": "+P.path)),this.handler({type:"request",message:_,cmd:S,data:P})},S.prototype.handleRespone=function(S,P){var E=this.callbacks[S],p=this.cmds[S];delete this.callbacks[S],delete this.cmds[S],E&&E(P),this.handler({type:"response",message:p,cmd:p,data:P})},S}(),Xl=function(){function S(P,E){var p=this;$P(this,S),this.editor=E,this.handler=P,this.cookie=0,this.callbacks={},this.cmds={},this.fileChangeVersion=String((new Date).getTime());var l=rP.config.host||window.location.hostname,_=rP.config.port||window.location.port,m=this.url=window.location.protocol+"//"+l+":"+_;setTimeout(function(){p.handler({type:"connected",message:m})},1),rP.config.checkForFileChanges&&rP.config.checkForFileChangesInterval&&this.fileChangedEvent()}return S.prototype.request=function(S,P,E){var p=++this.cookie;this.callbacks[p]=E,this.cmds[p]=S;var l=this.editor.sid;this[S](p,P,l||null,E);var _=S;P&&(fS(P)?_=S+": "+P:P.path&&(_=S+": "+P.path)),this.handler({type:"request",message:_,cmd:S,data:P})},S.prototype.fileChangedEvent=function(){var S=this,P=this.url+"/fileVersion";P+="/"+S.fileChangeVersion,P+="?sid="+this.editor.sid,S.send("GET",P,null,function(P){S.fileChangeVersion=String((new Date).getTime());var E=P.target.response;if(E){E=JSON.parse(E);Object.keys(E).forEach(function(P){S.handler({type:"fileChanged",path:P})})}}),setTimeout(function(){S.fileChangedEvent()},rP.config.checkForFileChangesInterval)},S.prototype.export=function(S,P,E){var p=this,l=new ht.Request,_={},m=new FormData,u=this.url+"/export";u+="?sid="+E,m.append("dir",P),_.url=encodeURI(u),_.method="POST",_.data=m,l.setResponseType("blob"),l.onload=function(P){var E=P.target;if(200==E.status||0===E.status){var l=E.response,_=E.getResponseHeader("Content-Disposition").split(";"),m=_[1].split("=")[1],u=new Blob([l],{type:"application/zip"}),F=document.createElement("a");F.href=window.URL.createObjectURL(u),F.download=decodeURI(m),F.click(),p.handleRespone(S,!0)}},l.send(_)},S.prototype.mkdir=function(S,P,E){var p=this,l=new ht.Request,_={},m=new FormData,u=this.url+"/mkdir";u+="?sid="+E,m.append("path",P),_.url=encodeURI(u),_.method="POST",_.data=m,l.onload=function(E){var l=E.target;if(200==l.status||0===l.status){var _=l.response||l.responseText;p.handleRespone(S,"true"===_),p.handler({type:"fileChanged",path:P})}},l.send(_)},S.prototype.explore=function(S,P,E){var p=this,l=new ht.Request,_={},m=this.url+"/explore";m+=P,m+="?sid="+E,_.url=encodeURI(m),l.onload=function(P){var E=P.target;if(200==E.status||0===E.status){var l=E.response||E.responseText;p.handleRespone(S,JSON.parse(l))}},l.send(_)},S.prototype.upload=function(S,P,E){var p=this,l=new FormData,_=this.url+"/upload",m=P.path;_+="?sid="+E,l.append("path",P.path),l.append("content",P.content),p.send("POST",_,l,function(P){var E=P.target;if(200==E.status||0===E.status){var l=E.response;if(p.handleRespone(S,!0),l){var _=JSON.parse(l);p.handler({type:"confirm",path:_.tempName,datas:_.paths})}else p.handler({type:"fileChanged",path:m})}})},S.prototype.rename=function(S,P,E){var p=this,l=new FormData,_=P.new,m=P.old,u=this.url+"/rename";u+="?sid="+E,l.append("newPath",_),l.append("oldPath",m),p.send("POST",u,l,function(P){var E=P.target;if(200==E.status||0===E.status){var l=E.response||E.responseText;p.handleRespone(S,"true"===l),"true"===l&&(p.handler({type:"fileChanged",path:_}),p.handler({type:"fileChanged",path:m}))}})},S.prototype.remove=function(S,P,E){var p=this,l=new FormData,_=this.url+"/remove";_+="?sid="+E,l.append("path",P),p.send("POST",_,l,function(E){var l=E.target;if(200==l.status||0===l.status){var _=l.response||l.responseText;p.handleRespone(S,"true"===_),"true"===_&&p.handler({type:"fileChanged",path:P})}})},S.prototype.locate=function(S,P,E){var p=this,l=this.url+"/locate";l+="?dir="+P,l+="&sid="+E,p.send("GET",l,null,function(P){var E=P.target;200!=E.status&&0!=E.status||p.handleRespone(S,!0)})},S.prototype.open=function(S,P,E){var p=this,l=this.url+"/open";l+="?url="+P,l+="&sid="+E,p.send("GET",l,null,function(P){var E=P.target;200!=E.status&&0!=E.status||p.handleRespone(S,!0)})},S.prototype.source=function(S,P,E){var p=this,l=new FormData,_=this.url+"/source";_+="?sid="+E,l.append("url",P.url),l.append("encoding",P.encoding),l.append("prefix",P.prefix),p.send("POST",_,l,function(P){var E=P.target;if(200==E.status||0===E.status){var l=E.response||E.responseText;p.handleRespone(S,l)}})},S.prototype.import=function(S,P,E){var p=this,l=new FormData,_=this.url+"/import";_+="?sid="+E,l.append("path",P.path),l.append("move",P.move),p.send("POST",_,l,function(P){var E=P.target;200!=E.status&&0!==E.status||p.handleRespone(S,!0)})},S.prototype.send=function(S,P,E,p){var l=new ht.Request,_={};_.url=encodeURI(P),_.method=S,_.data=E,p&&(l.onload=p),l.send(_)},S.prototype.handleRespone=function(S,P){var E=this.callbacks[S],p=this.cmds[S];delete this.callbacks[S],delete this.cmds[S],E&&E(P),this.handler({type:"response",message:p,cmd:p,data:P})},S}();return console.log("HT Editor v0.3.0 powered by HT for Web v"+ht.Default.getVersion()+" from www.hightopo.com"),!window.onbeforeunload&&rP.config.promptBeforeClosing&&(window.onbeforeunload=function(S){return S.returnValue=l("editor.closetip"),S.returnValue}),rP.version="0.3.0",rP.getString=l,rP.stringifyFunction=u,rP.parseFunction=f,rP.createButton=NS,rP.createItem=dS,rP.layoutMainView=oS,rP.msClass=I,rP.initContext=y,rP.getInput=qS,rP.trimExtension=v,rP.fileNameToDisplayName=B,rP.isJSON=pS,rP.getter=H,rP.setter=T,rP.snapshot=nS,rP.CodeEditor=Hl,rP.WebSocketService=Tl,rP.HTTPService=Xl,rP.createEditor=function(S){if(window.location.host.indexOf("hightopo")>=0){var P="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cdiv style='display:none'%3E%3Cspan id='cnzz_stat_icon_1000279011'%3E%3C/span%3E%3Cscript src='"+P+"s23.cnzz.com/z_stat.php%3Fid%3D1000279011%26show%3Dpic' type='text/javascript'%3E%3C/script%3E%3C/div%3E")),document.body.style.margin="0px",document.body.style.padding="0px"}S&&(ht.Default.isString(S)?S={container:S}:S.tagName&&S.appendChild&&(S={container:S})),S=S||{};var E=void 0,p=void 0===S.container?rP.config.container:S.container;return null===p?E=null:p?ht.Default.isString(p)?E=document.getElementById(p):p.length?(E=ht.Default.createDiv(),E.style.left=p[0]+"px",E.style.top=p[1]+"px",E.style.width=p[2]+"px",E.style.height=p[3]+"px",document.body.appendChild(E)):E=p:E=document.body,S.$39$=E,new fl(S)},rP.init=function(){rP.consts||(bP(),MP(),xP())},rP});
!function(S,W){"use strict";var y="position",e="absolute",v="relative",i="px",s="left",b="right",p="top",G="bottom",k="display",c="none",U="block",g=ht.Default,V=g.getInternal(),R=Math.floor,L=Math.ceil,Y=Math.PI,w=null,o=S.parseInt,A=function(e){return e.getContext("2d")},E=function(){return document},f=function(e){return E().createElement(e)},O=function(){return f("canvas")},J=function(d,t,A){d.style.setProperty(t,A,w)},$=function(J,l,$){g.def(ht.widget[J],l,$)},h=function(O,$){O.appendChild($)},z=function(Q,S){Q.removeChild(S)},V=g.getInternal(),P=V.addEventListener,T=V.removeEventListener;ht.widget.RulerFrame=function(o){var N=this,d=N._view=V.createView(null,N),M=N.$1k=O(),K=N.$2k=O(),S=N.$3k=O(),I=N.$4k=O();N._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},N._topRulerConfig={visible:!0},N._rightRulerConfig={visible:!1},N._bottomRulerConfig={visible:!1},N._leftRulerConfig={visible:!0},h(d,M),h(d,S),h(d,K),h(d,I),J(d,y,v),J(d,"box-sizing","border-box"),J(d,"-moz-box-sizing","border-box"),J(M,y,e),J(K,y,e),J(S,y,e),J(I,y,e),N.$14k=function(){N.$13k=1,N.iv()},N.$15k=function(v){if(N._topRulerConfig.guideVisible||N._rightRulerConfig.guideVisible||N._bottomRulerConfig.guideVisible||N._leftRulerConfig.guideVisible||N._defaultRulerConfig.guideVisible||(N._topRulerConfig.guideTipVisible||N._rightRulerConfig.guideTipVisible||N._bottomRulerConfig.guideTipVisible||N._leftRulerConfig.guideTipVisible||N._defaultRulerConfig.guideTipVisible)&&N._component){var T=d.getBoundingClientRect();N.$16k={x:v.clientX-T.left,y:v.clientY-T.top},N.$5k()}},N.setComponent(o)},$("RulerFrame",W,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(n){var D=this,V=D._component,c=D.getView();if(c){if(D._component=n,D.fp("component",V,n),V){var u=D.getComponentView(V);z(c,u),T(c,"mousemove",D.$15k),D.removeComponentPropertyChangeListener(V,D.$14k)}if(n){var F=D.getComponentView(n);h(c,F),J(F,y,e),P(c,"mousemove",D.$15k),D.addComponentPropertyChangeListener(n,D.$14k)}}},addComponentPropertyChangeListener:function(M,k){M&&M.mp&&M.mp(k)},removeComponentPropertyChangeListener:function(F,y){F&&F.ump&&F.ump(y)},getComponentHZoom:function(w){return w&&w.getZoom?w.getZoom():1},getComponentVZoom:function(t){return t&&t.getZoom?t.getZoom():1},getComponentViewRect:function(c){return c&&c.getViewRect?c.getViewRect():void 0},getComponentView:function(D){return D&&D.getView?D.getView():D},invalidateComponent:function(V){V&&V.iv&&V.iv()},validateComponent:function(P){P&&P.validate&&P.validate()},$7k:function(O,E,$,P,p,S,Z,r,q,G,l,L){if(E.visible){var y=this._defaultRulerConfig,f="borderStyle",T="borderColor",s="borderWidth",j="background",i=E[f]||y[f],B=E[T]||y[T],A=E[s]||y[s],Y=E.size!=w?E.size:y.size,D=E[j]||y[j],C=Y+A,g=this.$6k(A,i,B,O,$,p,C,Z,r,q,G,l,L);J(O,p,"0px"),S?V.setCanvas(O,P-g,Y):V.setCanvas(O,Y,P-g),J(O,"background",D),J(O,k,U)}else J(O,k,c),J(this.getComponentView(this._component),p,"0px")},$6k:function(R,Y,h,Z,x,_,F,k,P,e,t,w,s){var A=0;return J(Z,x,R+"px "+Y+" "+h),J(this.getComponentView(this._component),_,F+i),k?(J(Z,P,e+i),A+=e):J(Z,P,"0px"),t?(J(Z,w,s+i),A+=s):J(Z,w,"0px"),A},validateImpl:function(){var Z=this,y=Z._component,v=Z.$1k,h=Z.$2k,r=Z.$3k,K=Z.$4k,P=Z._view,g=Z._defaultRulerConfig,U=Z._topRulerConfig,F=Z._rightRulerConfig,k=Z._bottomRulerConfig,L=Z._leftRulerConfig,N=g.size;if(P&&y){var u=U.size!=w?U.size:N,m=F.size!=w?F.size:N,o=k.size!=w?k.size:N,z=L.size!=w?L.size:N;Z.$7k(v,U,"border-bottom",P.offsetWidth,p,!0,L.visible,s,z,F.visible,b,m),Z.$7k(h,F,"border-left",P.offsetHeight,b,!1,U.visible,p,u,k.visible,G,o),Z.$7k(r,k,"border-top",P.offsetWidth,G,!0,L.visible,s,z,F.visible,b,m),Z.$7k(K,L,"border-right",P.offsetHeight,s,!1,U.visible,p,u,k.visible,G,o),Z.$13k?delete Z.$13k:Z.invalidateComponent(y),Z.validateComponent(y),Z.$5k()}},$5k:function(){function f(q,W,o,I,f,s){if(W.visible){var P=A(q),H=W[T]||M,c=W[h]!=w?W[h]:S,m=W[r]||$,G=W[O]||e,i=W.size!=w?W.size:J,ye=W[b]||K,Bc=W[y]||n,vm=W[C]||R,Pi=W[x]!=w?W[x]:F,Ar=W[a]!=w?W[a]:N,co=W[L]!=w?W[L]:E,hd=W[t]!=w?W[t]:k,yc=W[D]!=w?W[D]:Y,Yn=W[V]!=w?W[V]:_,vf=W[z]||El,Vq=W[Q]||Bs;c&&(H=X[s]=X.$8k(X[s]||H,W[l]||u,W[p]||U,I?B:d,Bc)),o.call(X,P,v,Z,j,g,i,I?B:d,H,m,G,f,ye,vm);var wb=X.$16k;(Pi||Ar)&&wb&&(I?X.$9k(P,wb.x,i,vf,Vq,Pi,Ar,co,hd,yc,Yn):X.$10k(P,wb.y,i,vf,Vq,Pi,Ar,co,hd,yc,Yn,f))}}var X=this,c=X.$1k,G=X.$2k,W=X.$3k,i=X.$4k,m=X._topRulerConfig,I=X._rightRulerConfig,s=X._bottomRulerConfig,P=X._leftRulerConfig,q=X._defaultRulerConfig,H=X._component,o=X.getComponentViewRect(H),B=X.getComponentHZoom(H),d=X.getComponentVZoom(H),v=o.x*B,j=v+o.width*B,Z=o.y*d,g=Z+o.height*d,J=X._defaultRulerConfig.size,T="defaultMajorTickSpacing",l="maxPhysicalMajorTickSpacing",p="minPhysicalMajorTickSpacing",h="tickSpacingAdaptable",r="majorTickTextFont",O="majorTickTextColor",b="majorTickColor",C="minorTickColor",x="guideVisible",a="guideTipVisible",L="guideTipBorderColor",t="guideTipTextColor",D="guideTipTextFont",V="guideTipBackground",z="guideColor",Q="guideWidth",y="minMajorTickSpacing",M=q[T],u=q[l],U=q[p],S=q[h],$=q[r],e=q[O],K=q[b],n=q[y],R=q[C],F=q[x],N=q[a],E=q[L],k=q[t],Y=q[D],_=q[V],El=q[z],Bs=q[Q];X._view&&H&&(f(c,m,X.$11k,!0,!1,"_currentTopMajorTickSpacing"),f(G,I,X.$12k,!1,!0,"_currentRightMajorTickSpacing"),f(W,s,X.$11k,!0,!0,"_currentBottomMajorTickSpacing"),f(i,P,X.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(W,r,d,M,c){return d>W*M?W=R(r/M/c)*c:W*M>r&&(W=L(d/M/c)*c),W},getHTipText:function(E){var f=this,S=f._component,a=0,B=f._view.getBoundingClientRect();return S.lp?a=o(S.lp({x:E.x+B.left,y:E.y}).x):a-=o(this.getComponentView(S).style.left)||0,a},$9k:function(e,f,a,C,x,E,i,r,t,G,w){var A=this,p=A._component;e.save(),V.translateAndScale(e,0,0,1);var W=f-(o(this.getComponentView(p).style.left)||0),K=0;if(f=A.getHTipText(A.$16k),E&&(e.beginPath(),e.fillStyle=C,e.rect(W,K,x,a),e.fill()),i){e.beginPath(),e.textAlign="center",e.textBaseline="middle",e.font=G;var I=e.measureText(f).width+6;e.fillStyle=w,e.rect(W-I/2,K,I,a),e.fill(),e.strokeStyle=r,e.stroke(),e.beginPath(),e.fillStyle=t,e.fillText(f,W,K+a/2)}e.restore()},getVTipText:function(B){var T=this,J=T._component,R=0,Q=T._view.getBoundingClientRect();return J.lp?R=o(J.lp({x:B.x,y:B.y+Q.top}).y):R-=o(this.getComponentView(J).style.top)||0,R},formatScaleText:function(W){return Math.round(W)},$10k:function(X,j,g,L,d,C,R,T,s,Z,M,I){var P=this,q=P._component;X.save(),V.translateAndScale(X,0,0,1);var H=g/2,i=j-(o(this.getComponentView(q).style.top)||0);if(j=P.getVTipText(P.$16k),C&&(X.beginPath(),X.fillStyle=L,X.rect(H-g/2,i,g,d),X.fill()),R){X.translate(H,i),X.rotate((I?90:-90)*Y/180),X.translate(-H,-i),X.beginPath(),X.textAlign="center",X.textBaseline="middle",X.font=Z;var l=X.measureText(j).width+6;X.fillStyle=M,X.rect(H-l/2,i-g/2,l,g),X.fill(),X.strokeStyle=T,X.stroke(),X.fillStyle=s,X.fillText(j,H,i)}X.restore()},$11k:function(x,u,i,d,H,v,B,Z,T,y,s,r,l){x.save(),i=0;var P=u,F=d,J=(P+F)/2;u=0,d=F-P,V.translateAndScale(x,0,0,1);var f=0,K=0,X=o(v/2),C=v-X,A=s?0:X,h=Z*B,g=h/10;u-=h,d+=h,x.clearRect(u,0,d-u,v),x.beginPath(),x.fillStyle=l;var j=R(J/g)*g-P;for(f=j;d>f;f+=g)x.rect(f,i+A,1,C);for(f=j;f>u;f-=g)x.rect(f,i+A,1,C);for(x.fill(),A=s?0:1,x.beginPath(),x.fillStyle=r,j=R(J/h)*h-P,f=j;d>f;f+=h)x.rect(f,i+A,1,v-1);for(f=j;f>u;f-=h)x.rect(f,i+A,1,v-1);x.fill();var E=o(/\d+px/.exec(T)[0]),G=(E||10)/2;x.textBaseline="middle",A=s?v-G-2:G+2,x.beginPath(),x.fillStyle=y,x.font=T;var $=R(J/h)*h/B;for(f=j,K=$;d>f;f+=h,K+=Z){var p=this.getHScaleText?this.getHScaleText(f):K;x.fillText(this.formatScaleText(p),f+2,i+A)}for(f=j,K=$;f>u;f-=h,K-=Z){var p=this.getHScaleText?this.getHScaleText(f):K;x.fillText(this.formatScaleText(p),f+2,i+A)}x.restore()},$12k:function(J,W,g,$,s,K,h,j,r,E,P,l,F){function O(Q,t,j,q,h,T){h=L.getVScaleText?L.getVScaleText(j):h,h=L.formatScaleText(h),J.translate(Q+t,j),J.rotate(-q),J.translate(-Q-t,-j),J.fillText(h,Q+t+(T?2:1),j),J.translate(Q+t,j),J.rotate(q),J.translate(-Q-t,-j)}J.save(),W=0;var D=g,_=s,x=(D+_)/2;g=0,s=_-D,V.translateAndScale(J,0,0,1);var n=0,L=this,q=0,m=o(K/2),S=K-m,k=P?0:m,A=j*h,N=A/10;g-=A,s+=A,J.clearRect(W,0,K,s-g),J.beginPath(),J.fillStyle=F;var H=R(x/N)*N-D;for(n=H;s>n;n+=N)J.rect(W+k,n,S,1);for(n=H;n>g;n-=N)J.rect(W+k,n,S,1);for(J.fill(),k=P?0:1,J.beginPath(),J.fillStyle=l,H=R(x/A)*A-D,n=H;s>n;n+=A)J.rect(W+k,n,K-1,1);for(n=H;n>g;n-=A)J.rect(W+k,n,K-1,1);J.fill();var a=o(/\d+px/.exec(r)[0]),T=(a||10)/2,U=90*Y/180;J.textBaseline="middle",k=P?K-T:T+2,U=P?-U:U,J.beginPath(),J.fillStyle=E,J.font=r;var c=R(x/A)*A/h;for(n=H,q=c;s>n;n+=A,q+=j)O(W,k,n,U,q,P);for(n=H,q=c;n>g;n-=A,q-=j)O(W,k,n,U,q,P);J.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var U=this,Q=U._component,u=U._view;Q&&U.removeComponentPropertyChangeListener(Q,U.$14k),u&&(T(u,"mousemove",U.$15k),z(u.parentNode,u),U._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
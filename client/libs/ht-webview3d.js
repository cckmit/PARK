!function(g){"use strict";function F(z){var P,c,$,J,U,I,v,M=[],D=0;P=w.createDiv(),P.style.overflow="hidden";var y=z.getView();y.insertBefore(P,z.getCanvas()),c=Y.Default.createDiv(),c.style.WebkitTransformStyle="preserve-3d",c.style.MozTransformStyle="preserve-3d",c.style.transformStyle="preserve-3d",P.appendChild(c),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(M){var b=M.style;i.addEventListener(y,M.event,function(){P.style.pointerEvents=b})}),this.updateWebView=function(){if(z.getWidth()&&z.getHeight()){var A=z.getCanvas(),x=1*A.style.width.slice(0,-2),n=1*A.style.height.slice(0,-2);(M[0]!==x||M[1]!==n)&&(M[0]=x,M[1]=n,P.style.width=x+"px",P.style.height=n+"px",c.style.width=x+"px",c.style.height=n+"px");var W=z._projectMatrix[5]*M[1]/2;W!==$&&($=W,P.style.WebkitPerspective=$+"px",P.style.MozPerspective=$+"px",P.style.perspective=$+"px"),I="translateZ("+$+"px)"+O(z._viewMatrix);var S=I+"translate("+M[0]/2+"px,"+M[1]/2+"px)";J===S||U||(c.style.WebkitTransform=S,c.style.MozTransform=S,c.style.transform=S,J=S),D++,v=!1,z.dm().each(function($){$.isWebView&&p($)});for(var e,F=c.children,m=[],k=0,H=F.length;H>k;k++)e=F[k],e._isHtWebView&&e._renderCookie!==D&&m.push(e);m.length&&m.forEach(function(X){c.removeChild(X)})}};var s=new Array(16),p=function(Y){var k=Y.getAttach();if(k){k.parentElement!==c&&c.appendChild(k),k._renderCookie=D,v=!0;var P=Y.getFinalScale3d(),e=Y._prefrenceSize;e&&e[0]?e[1]||(e[1]=e[0]/P[0]*P[1]):e=[P[0],P[1]],k.style.width=e[0]+"px",k.style.height=e[1]+"px";var A=1/e[0],g=1/e[1],b=1,i=Y.mat;s[0]=i[0]*A,s[1]=i[1]*A,s[2]=i[2]*A,s[3]=i[3]*A,s[4]=i[4]*g,s[5]=i[5]*g,s[6]=i[6]*g,s[7]=i[7]*g,s[8]=i[8]*b,s[9]=i[9]*b,s[10]=i[10]*b,s[11]=i[11]*b,s[12]=i[12],s[13]=i[13],s[14]=i[14],s[15]=i[15];var p=d(s,U?"translate("+M[0]/2+"px,"+M[1]/2+"px)"+I:""),f=k.$a2;f!==p&&(k.$a2=p,k.style.WebkitTransform=p,k.style.MozTransform=p,k.style.transform=p)}}}function h(v){return Math.abs(v)<1e-10?0:v}function O(o){var t=o;return"matrix3d("+h(t[0])+","+h(-t[1])+","+h(t[2])+","+h(t[3])+","+h(t[4])+","+h(-t[5])+","+h(t[6])+","+h(t[7])+","+h(t[8])+","+h(-t[9])+","+h(t[10])+","+h(t[11])+","+h(t[12])+","+h(-t[13])+","+h(t[14])+","+h(t[15])+")"}function d(C,M){var l=C,R="matrix3d("+h(l[0])+","+h(l[1])+","+h(l[2])+","+h(l[3])+","+h(-l[4])+","+h(-l[5])+","+h(-l[6])+","+h(-l[7])+","+h(l[8])+","+h(l[9])+","+h(l[10])+","+h(l[11])+","+h(l[12])+","+h(l[13])+","+h(l[14])+","+h(l[15])+")";return"translate(-50%,-50%)"+(M||"")+R}var k="ht",Y=g[k],w=Y.Default,i=w.getInternal(),J=i.superCall,M=Y.graph3d.Graph3dView,G=M.prototype.validateImpl;M.prototype.validateImpl=function(){G.call(this);var y=this._webViewRenderer;y||(y=this._webViewRenderer=new F(this)),y.updateWebView()};var T=Y.WebView3d=function(){var B=this;J(T,B),B.s({shape3d:"billboard","shape3d.reverse.flip":!0})},m=[1,1,1,1],B=[0,0,0,0];w.def(k+"."+"WebView3d",Y.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(p,x,t){if(!p)return this.detachDOM();if("string"==typeof p){var I=document.createElement("iframe");I.src=p,p=I}var c=p.style;c.position="absolute",c.border=0,c.outline=0,c.padding=0,c.margin=0,p._isHtWebView=!0,this.setAttach(p),this._prefrenceSize=[x,t],this.s("shape3d.blend",B)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(f){this.a("defaultBgColor",f),this.getAttach()||this.s("shape3d.blend",f)},getBgColor:function(){return this.a("defaultBgColor")||m}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
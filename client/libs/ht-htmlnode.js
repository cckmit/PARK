!function(c){"use strict";var q="ht",Z=c[q],s=function(){return document},t=function(){return s().body},d=function(n,H,l){n.style.setProperty(H,l,null)},k=function(h){return s().createElement(h)},i=function(){return k("div")},G=function(){var r=k("canvas");return r},$=function(P,F){d(P,"-webkit-transform",F),d(P,"-ms-transform",F),d(P,"transform",F)},v=function(u,n){d(u,"-webkit-transform-origin",n),d(u,"-ms-transform-origin",n),d(u,"transform-origin",n)},P=function(G,m){G.appendChild(m)},C=function(T,R){T.removeChild(R)},T=c.parseInt,j=Z.Default,h=j.getInternal(),_=h.addEventListener,x=(h.removeEventListener,Math.PI),u="white-space",r="visibility",n="left",z="top",R="width",f="height",F="position",U="display",J="z-index",p="px",g="0 0",e="absolute",Q="visible",L="hidden",O="none",I="block",l="nowrap",N="rgba(0, 0, 0, 0.005)";j.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var a=Z.graph.GraphView.prototype,Y=a._42;a.adjustHtmlNodeIndex=!0,a._42=function(b,L){if(Y.call(this,b,L),this.adjustHtmlNodeIndex)for(var i=this.getDataModel()._datas._as,q=i.length,y=1,$=0;q>$;$++){var B=i[$];if(B instanceof K){var M=this.getDataUI(B);d(M.$2f,J,y+""),d(M.$3f,J,y+1+""),y+=2}}};var B=Z.HtmlNodeUI=function(X,P){var J=this;B.superClass.constructor.call(J,X,P);var y=J.$2f=i(),s=J.$3f=G();d(y,F,e),d(y,r,L),d(y,u,l),s.draggable=!1,d(s,F,e),d(s,U,O),v(s,g),_(y,"change",function(C){var I=C.target,B=I.bind||I.getAttribute("bind"),$=I.type&&"checkbox"===I.type?I.checked:I.value,f=P.getContext();B&&f&&(f[B]=$,J.$4f=JSON.stringify(f))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(X){_(y,X,this.$9f.bind(this))},J)};j.def(B,h.ui().NodeUI,{_visible:!0,$11f:function(){var F=this,H=F.$3f,c=F._data,S=c.getDraggerImageWidth(),I=c.getDraggerImageHeight(),q=c.getDraggerImage(),T=h.initContext(H);T.beginPath(),h.setCanvas(H,S,I),h.translateAndScale(T,0,0,1),T.clearRect(0,0,S,I),j.drawImage(T,j.getImage(q),0,0,S,I),T.restore()},_80o:function(g){B.superClass._80o.call(this,g);var b=this,m=b._data,l=m._padding,X=2*l,y=b.$2f,v=b.$3f,C=b.gv,u=C.getZoom(),S=C.getTranslateX(),G=C.getTranslateY(),q=C.getView(),h=b._83o,k=m._width,j=m._height,Y=h.position,D=h.rotation,c=(k-X)/m.$5f*u,V=(j-X)/m.$6f*u,w=b._html,Z=m._html,W=m.getHtmlType();if("html"===W){var K=m.getContext()||{},t=b.$4f,E=m.$10f,_=JSON.stringify(K);w&&t&&w===Z&&t===_||(b.$4f=_,b._html=Z,y.innerHTML=E?E(K):Z)}else if(null!=W){var A=m.getHtml();"ht"===W&&(A=A.getView()),w&&w===A&&y.contains(w)||(b._html=A,y.innerHTML="",P(y,A))}if(!y.parentNode){var M=C.$1f;if(!M){var o=i();d(o,F,e),d(o,J,"0"),M=C.$1f=o;var s=C._canvas.nextSibling;s?q.insertBefore(o,s):P(q,o)}P(M,y),P(M,v),m.onContentInitialized&&m.onContentInitialized(y)}if(m._scalable){var a=m.$5f,H=m.$6f;$(y,"rotate("+180*(D/x)+"deg) scale("+c+","+V+")"),d(y,R,""),d(y,f,""),d(y,n,(Y.x-a/u/2)*u+S+p),d(y,z,(Y.y-H/u/2)*u+G+p)}else{var Vf=T(y.style.width),Te=T(y.style.height),ng=T((k-X)*u),vg=T((j-X)*u),Lh="100%",Cd=y.children[0];d(Cd,R,Lh),d(Cd,f,Lh),(Vf!==ng||Te!==vg)&&(d(y,R,ng+p),d(y,f,vg+p),"ht"===W&&Z.invalidate()),$(y,"rotate("+180*(D/x)+"deg)"),d(y,n,(Y.x-ng/u/2)*u+S+p),d(y,z,(Y.y-vg/u/2)*u+G+p)}var pl=b.dragRect;C.isMovable(m)&&C.isSelected(m)&&pl?(g.save(),g.fillStyle=N,g.fillRect(pl.x,pl.y,pl.width,pl.height),g.restore(),d(v,n,pl.x*u+S+p),d(v,z,pl.y*u+G+p),$(v,"scale("+u+","+u+")"),d(v,U,I),b.$11f()):d(v,U,O),d(y,r,this._visible?Q:L)},dispose:function(){var E=this.gv.$1f;this.$2f.parentNode===E&&E.removeChild(this.$2f),this.$3f.parentNode===E&&E.removeChild(this.$3f)},_84o:function(l){this._visible=l,d(this.$2f,r,l?Q:L),d(this.$3f,U,l?I:O)},_3O:function(){var X=this,h=X.gv,y=X._data;B.superClass._3O.call(X);var k=y.getRect();h.isEditable(y)&&(X.dragRect={x:k.x+k.width+y._padding,y:k.y+10,width:y.getDraggerImageWidth(),height:y.getDraggerImageHeight()},X._68o(X.dragRect))},rectIntersects:function(s){var J=this._79o();return Z.Default.intersection(J,s)?!0:void 0},$9f:function(q){var v=this.gv,n=this._data;v.sm().contains(n)&&q.stopPropagation()}});var K=Z.HtmlNode=function(){K.superClass.constructor.call(this)};Z.Default.def(K,Z.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:Z.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(q){var V=this,P=V._html;V._html=q,"html"===V.getHtmlType()&&"Handlebars"in c&&(V.$10f=Handlebars.compile(q)),V.$13f(),V.fp("html",P,q)},setContext:function(S){var k=this,v=k._context;k._context=S,k.fp("context",v,S),k.$13f()},setScalable:function(S){var f=this,I=f._scalable;f._scalable=S,f.fp("scalable",I,S),f.$13f()},getHtmlType:function(){var O=this._html;return O?"string"==typeof O?"html":O.getView?"ht":"dom":null},$13f:function(){var j=this,S=j._html,W=j.$10f;if(S){var X=i(),I=!1,E=j.getHtmlType();if(d(X,F,e),d(X,u,l),d(X,r,L),"html"===E?(X.innerHTML=W?W(j.getContext()||{}):S,I=!0):"ht"===E?(P(X,S.getView()),I=!0):"dom"===E&&(P(X,S),I=!0),I){var w=2*j._padding;P(t(),X),j.$5f=X.scrollWidth,j.$6f=X.scrollHeight,j._width=j.$5f+w,j._height=j.$6f+w,j._originWidth=j._width,j._originHeight=j._height,C(t(),X)}}},getUIClass:function(){return Z.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);